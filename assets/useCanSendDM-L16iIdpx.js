import{a as _,o as f,q as w}from"./index-cVJRNoKt.js";const h=async({myProfileId:i,otherProfile:e,findConversation:d,createConversation:o,addParticipant:r,navigate:l,setLoading:c=()=>{}})=>{try{c(!0);const n=await d({myProfileId:i,otherProfileId:e.id,all:!0});let t=null,a=null;if(Array.isArray(n)?(t=n.find(u=>!u.is_group),a=n.find(u=>u.is_group)):n&&typeof n=="object"&&(n.is_group?a=n:t=n),t){l(`/chat/${t.id}`);return}if(a){l(`/chat/${a.id}`);return}const s=await o({created_by:i,avatar_url:e.avatar_url,title:e.username});await r({conversation_id:s.id,profile_id:i}),await r({conversation_id:s.id,profile_id:e.id}),l(`/chat/${s.id}`)}catch(n){console.error("Error iniciando conversaci√≥n:",n)}finally{c(!1)}};function y(i){const{user:e}=_(),{privacyOthers:d}=f(),{data:o,isLoading:r}=d(i),{connectionBetweenProfiles:l}=w(),{data:c,isLoading:n}=l(e==null?void 0:e.id,i,{enabled:(o==null?void 0:o.allow_messages)==="connections_only"}),t=r||n;let a=!1,s="blocked";if(!t)switch(o==null?void 0:o.allow_messages){case"all":a=!0,s="ok";break;case"connections_only":a=(c==null?void 0:c.status)==="accepted",s=a?"ok":"not-connected";break;case"none":default:a=!1,s="blocked"}return{canSend:a,loading:t,reason:s}}export{h,y as u};
