import{n as Fe,g as le,b as Pe,c as ge,m as ie,d as oe,o as ce,p as Y,q as Ae,t as de,s as he,j as e}from"./mui-DntPDMdt.js";import{u as v,a as R,b as Q,H as Oe,a8 as De,j as X,w as pe,_ as Ee,D as Te,G as Ue,a9 as je,A as be,L as we,P as ye,aa as Be,J as Ge,K as ze,W as Ze,B as $,O as Ye,v as We,o as He,p as qe,t as Je,r as Ve,q as Ke,E as I,h as Qe,k as W,M as Ne,g as Xe,Q as es,ab as ss,s as ts,N as me,R as ve,i as S}from"./index-HpvwY6ca.js";import{r as u}from"./calendar-DXWKnWXk.js";import{u as ns,h as rs}from"./useCanSendDM-mUS5Xffp.js";import{c as as,g as ls,a as is,e as os,b as cs}from"./ConnectionCard-DcSqDKES.js";import{n as ue,o as ds,p as ms,q as xe,r as us}from"./icons-B8MnwRHo.js";import{F as xs}from"./EllipsisVerticalIcon-C3aSX2lf.js";import{F as J}from"./UserMinusIcon-kiJSbPsH.js";import{S as ee}from"./ShinyText-CNYmsWG2.js";import{R as fs}from"./reactPlayer-CBmCIXQE.js";import{P as H}from"./PlusButton-VbcxIGAf.js";import{S as E}from"./index-BXOMkYts.js";/* empty css                 */import{P as gs}from"./PostsList-DrhtGhe-.js";import hs from"./PostForm-Y10Yf2c1.js";import{a as ps,A as js}from"./AdsListSkeleton-BVb3zA38.js";import"./lottie-FCmafNqs.js";import"./gsap-CH_iu5NA.js";import"./filepond-DvarZm2e.js";import"./proxy-Dy5uTOz-.js";import"./swiper-Bk_-ZTox.js";import"./PencilIcon-D1yNP24j.js";import"./TrashIcon-CUrawVMm.js";function bs({title:n,titleId:s,...t},r){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},t),n?u.createElement("title",{id:s},n):null,u.createElement("path",{fillRule:"evenodd",d:"M5.25 9a6.75 6.75 0 0 1 13.5 0v.75c0 2.123.8 4.057 2.118 5.52a.75.75 0 0 1-.297 1.206c-1.544.57-3.16.99-4.831 1.243a3.75 3.75 0 1 1-7.48 0 24.585 24.585 0 0 1-4.831-1.244.75.75 0 0 1-.298-1.205A8.217 8.217 0 0 0 5.25 9.75V9Zm4.502 8.9a2.25 2.25 0 1 0 4.496 0 25.057 25.057 0 0 1-4.496 0Z",clipRule:"evenodd"}))}const ws=u.forwardRef(bs);function ys({title:n,titleId:s,...t},r){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},t),n?u.createElement("title",{id:s},n):null,u.createElement("path",{fillRule:"evenodd",d:"M12 2.25c-2.429 0-4.817.178-7.152.521C2.87 3.061 1.5 4.795 1.5 6.741v6.018c0 1.946 1.37 3.68 3.348 3.97.877.129 1.761.234 2.652.316V21a.75.75 0 0 0 1.28.53l4.184-4.183a.39.39 0 0 1 .266-.112c2.006-.05 3.982-.22 5.922-.506 1.978-.29 3.348-2.023 3.348-3.97V6.741c0-1.947-1.37-3.68-3.348-3.97A49.145 49.145 0 0 0 12 2.25ZM8.25 8.625a1.125 1.125 0 1 0 0 2.25 1.125 1.125 0 0 0 0-2.25Zm2.625 1.125a1.125 1.125 0 1 1 2.25 0 1.125 1.125 0 0 1-2.25 0Zm4.875-1.125a1.125 1.125 0 1 0 0 2.25 1.125 1.125 0 0 0 0-2.25Z",clipRule:"evenodd"}))}const Ns=u.forwardRef(ys);function vs({title:n,titleId:s,...t},r){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},t),n?u.createElement("title",{id:s},n):null,u.createElement("path",{d:"M4.913 2.658c2.075-.27 4.19-.408 6.337-.408 2.147 0 4.262.139 6.337.408 1.922.25 3.291 1.861 3.405 3.727a4.403 4.403 0 0 0-1.032-.211 50.89 50.89 0 0 0-8.42 0c-2.358.196-4.04 2.19-4.04 4.434v4.286a4.47 4.47 0 0 0 2.433 3.984L7.28 21.53A.75.75 0 0 1 6 21v-4.03a48.527 48.527 0 0 1-1.087-.128C2.905 16.58 1.5 14.833 1.5 12.862V6.638c0-1.97 1.405-3.718 3.413-3.979Z"}),u.createElement("path",{d:"M15.75 7.5c-1.376 0-2.739.057-4.086.169C10.124 7.797 9 9.103 9 10.609v4.285c0 1.507 1.128 2.814 2.67 2.94 1.243.102 2.5.157 3.768.165l2.782 2.781a.75.75 0 0 0 1.28-.53v-2.39l.33-.026c1.542-.125 2.67-1.433 2.67-2.94v-4.286c0-1.505-1.125-2.811-2.664-2.94A49.392 49.392 0 0 0 15.75 7.5Z"}))}const ks=u.forwardRef(vs);function Cs({title:n,titleId:s,...t},r){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},t),n?u.createElement("title",{id:s},n):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m19.5 8.25-7.5 7.5-7.5-7.5"}))}const ke=u.forwardRef(Cs);function _s({title:n,titleId:s,...t},r){return u.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},t),n?u.createElement("title",{id:s},n):null,u.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 15.75 7.5-7.5 7.5 7.5"}))}const Ss=u.forwardRef(_s);function Rs(n,s,t){const r=Pe(),l=(t==null?void 0:t.locale)??r.locale??ge,i=as(n,s);if(isNaN(i))throw new RangeError("Invalid time value");const o=Object.assign({},t,{addSuffix:t==null?void 0:t.addSuffix,comparison:i}),[c,m]=Fe(t==null?void 0:t.in,...i>0?[s,n]:[n,s]),d=ls((t==null?void 0:t.roundingMethod)??"round"),x=m.getTime()-c.getTime(),g=x/Y,w=le(m)-le(c),f=(x-w)/Y,k=t==null?void 0:t.unit;let h;if(k?h=k:g<1?h="second":g<60?h="minute":g<ie?h="hour":f<oe?h="day":f<ce?h="month":h="year",h==="second"){const p=d(x/1e3);return l.formatDistance("xSeconds",p,o)}else if(h==="minute"){const p=d(g);return l.formatDistance("xMinutes",p,o)}else if(h==="hour"){const p=d(g/60);return l.formatDistance("xHours",p,o)}else if(h==="day"){const p=d(f/ie);return l.formatDistance("xDays",p,o)}else if(h==="month"){const p=d(f/oe);return p===12&&k!=="month"?l.formatDistance("xYears",1,o):l.formatDistance("xMonths",p,o)}else{const p=d(f/ce);return l.formatDistance("xYears",p,o)}}function $s(n,s){return Rs(n,is(n),s)}function Ls(n,s){const t=()=>Ae(s==null?void 0:s.in,NaN),l=Ps(n);let i;if(l.date){const d=As(l.date,2);i=Os(d.restDateString,d.year)}if(!i||isNaN(+i))return t();const o=+i;let c=0,m;if(l.time&&(c=Ds(l.time),isNaN(c)))return t();if(l.timezone){if(m=Es(l.timezone),isNaN(m))return t()}else{const d=new Date(o+c),x=de(0,s==null?void 0:s.in);return x.setFullYear(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()),x.setHours(d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds()),x}return de(o+c+m,s==null?void 0:s.in)}const Z={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Ms=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,Is=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Fs=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Ps(n){const s={},t=n.split(Z.dateTimeDelimiter);let r;if(t.length>2)return s;if(/:/.test(t[0])?r=t[0]:(s.date=t[0],r=t[1],Z.timeZoneDelimiter.test(s.date)&&(s.date=n.split(Z.timeZoneDelimiter)[0],r=n.substr(s.date.length,n.length))),r){const l=Z.timezone.exec(r);l?(s.time=r.replace(l[1],""),s.timezone=l[1]):s.time=r}return s}function As(n,s){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+s)+"})|(\\d{2}|[+-]\\d{"+(2+s)+"})$)"),r=n.match(t);if(!r)return{year:NaN,restDateString:""};const l=r[1]?parseInt(r[1]):null,i=r[2]?parseInt(r[2]):null;return{year:i===null?l:i*100,restDateString:n.slice((r[1]||r[2]).length)}}function Os(n,s){if(s===null)return new Date(NaN);const t=n.match(Ms);if(!t)return new Date(NaN);const r=!!t[4],l=D(t[1]),i=D(t[2])-1,o=D(t[3]),c=D(t[4]),m=D(t[5])-1;if(r)return zs(s,c,m)?Ts(s,c,m):new Date(NaN);{const d=new Date(0);return!Bs(s,i,o)||!Gs(s,l)?new Date(NaN):(d.setUTCFullYear(s,i,Math.max(l,o)),d)}}function D(n){return n?parseInt(n):1}function Ds(n){const s=n.match(Is);if(!s)return NaN;const t=V(s[1]),r=V(s[2]),l=V(s[3]);return Zs(t,r,l)?t*he+r*Y+l*1e3:NaN}function V(n){return n&&parseFloat(n.replace(",","."))||0}function Es(n){if(n==="Z")return 0;const s=n.match(Fs);if(!s)return 0;const t=s[1]==="+"?-1:1,r=parseInt(s[2]),l=s[3]&&parseInt(s[3])||0;return Ys(r,l)?t*(r*he+l*Y):NaN}function Ts(n,s,t){const r=new Date(0);r.setUTCFullYear(n,0,4);const l=r.getUTCDay()||7,i=(s-1)*7+t+1-l;return r.setUTCDate(r.getUTCDate()+i),r}const Us=[31,null,31,30,31,30,31,31,30,31,30,31];function Ce(n){return n%400===0||n%4===0&&n%100!==0}function Bs(n,s,t){return s>=0&&s<=11&&t>=1&&t<=(Us[s]||(Ce(n)?29:28))}function Gs(n,s){return s>=1&&s<=(Ce(n)?366:365)}function zs(n,s,t){return s>=1&&s<=53&&t>=0&&t<=6}function Zs(n,s,t){return n===24?s===0&&t===0:t>=0&&t<60&&s>=0&&s<60&&n>=0&&n<25}function Ys(n,s){return s>=0&&s<=59}const Ws=({color:n="sky"})=>{const{t:s}=v("common"),t={pink:"bg-pink-100",sky:"bg-sky-100",amber:"bg-amber-100",green:"bg-green-100"}[n]||"bg-sky-100",r={pink:"bg-pink-600",sky:"bg-sky-600",amber:"bg-amber-600",green:"bg-green-600"}[n]||"bg-sky-600",l={pink:"text-pink-700",sky:"text-sky-700",amber:"text-amber-700",green:"text-green-700"}[n]||"text-pink-700";return e.jsxs("div",{className:"inline-flex items-center gap-3 select-none",children:[e.jsx("div",{className:`relative w-24 h-3 ${t} rounded overflow-hidden`,children:e.jsx("div",{className:`${r} absolute top-0 left-0 w-full h-full animate-[loading_1.5s_linear_infinite]`})}),e.jsx("span",{className:`text-xs font-semibold ${l}`,children:s("calculating")}),e.jsx("style",{children:`
        @keyframes loading {
          0% {
            transform: translateX(-100%);
          }
          100% {
            transform: translateX(100%);
          }
        }
      `})]})},Hs=({otherProfile:n,className:s=""})=>{const{t}=v("profile"),{user:r}=R(),{matchScore:l}=Q(),[i,o]=u.useState(null);if(u.useEffect(()=>{r!=null&&r.id&&(n!=null&&n.id)&&l({profileAId:r.id,profileBId:n.id}).then(m=>{o(m)}).catch(m=>{console.error("matchScore error",m)})},[r==null?void 0:r.id,n==null?void 0:n.id,l]),i===null)return e.jsx(Ws,{color:"amber"});const c=Math.round(i*100);return e.jsxs("div",{className:`w-full md:w-auto flex items-center justify-center gap-1 cursor-help whitespace-nowrap select-none ${s}`,title:t("matchScore.title"),children:[e.jsx(Oe,{className:"text-amber-700 w-6 h-6"}),e.jsxs("span",{className:`inline-block w-full text-center px-3 py-1.5 rounded-full text-sm font-semibold whitespace-nowrap ${c>=70?"bg-amber-800 text-white":c>=40?"bg-sky-700 text-white":c>=10?"bg-gray-300 text-gray-900":"bg-gray-800 text-gray-100"}`,children:["Match: ",c,"%"]})]})};function qs(n){if(!n)return null;const s=Ls(n),t=De.language.startsWith("es")?os:ge;return $s(s,{locale:t,addSuffix:!0})}const Js=({isOwnProfile:n,profileData:s})=>{const{t}=v("profile"),{user:r}=R(),l=X(),{privacyOthers:i}=pe(),{data:o}=i(s.id),{totalUnreadMessages:c}=Ee(),{data:m,isLoading:d}=c((r==null?void 0:r.id)??""),{findConversation:x,createConversation:g}=Te(),{addParticipant:w}=Ue(),{userNotifications:f,notificationsRealtime:k}=je();k(r.id);const{data:h,isLoading:p}=f((r==null?void 0:r.id)??""),{connectionBetweenProfiles:F,addConnection:L,updateConnection:_,deleteConnection:P}=be(),{data:a,isLoading:y}=F((r==null?void 0:r.id)??"",s.id),{canSend:M,loading:A,reason:T}=ns(s.id),[q,U]=u.useState(!1),[O,j]=u.useState(!1),[C,B]=u.useState(null),se=(h==null?void 0:h.filter(b=>!b.is_read).length)||0,_e=!!(o!=null&&o.show_last_seen&&s.last_seen),Se=()=>{q||!r||rs({myProfileId:r.id,otherProfile:s,findConversation:x,createConversation:g,addParticipant:w,navigate:l,setLoading:()=>U(!0)})},te=async()=>{r&&await L({follower_profile_id:r.id,following_profile_id:s.id,status:"pending"})},G=async()=>{a&&await P(a)},Re=async()=>{r&&(a?await _({connection:a,updatedConnection:{status:"blocked"}}):await L({follower_profile_id:r.id,following_profile_id:s.id,status:"blocked"}))},ne=async()=>{a&&await _({connection:a,updatedConnection:{status:"accepted"}})},$e=b=>{const z="text-white text-lg mr-1 drop-shadow-[0_0_2px_rgba(255,255,255,0.5)]",Ie="text-gray-300 text-lg mr-1 drop-shadow-[0_0_2px_rgba(255,255,255,0.2)]";return b==="accepted"?e.jsx(ds,{className:z}):b==="pending"?e.jsx(ms,{className:z}):b==="blocked"&&(a==null?void 0:a.follower_profile_id)===(r==null?void 0:r.id)?e.jsx(xe,{className:z}):b==="blocked"&&(a==null?void 0:a.follower_profile_id)===s.id?e.jsx(xe,{className:Ie}):e.jsx(us,{className:z})},Le=(a==null?void 0:a.status)==="accepted",Me=(a==null?void 0:a.status)==="pending",re=(a==null?void 0:a.status)==="blocked"&&(a==null?void 0:a.follower_profile_id)===(r==null?void 0:r.id),ae=(a==null?void 0:a.status)==="blocked"&&(a==null?void 0:a.follower_profile_id)===s.id;return e.jsxs("div",{className:"bg-gradient-to-l md:min-w-2xl lg:min-w-4xl from-gray-900 to-gray-950 mb-4 p-4 rounded-b-lg",children:[e.jsxs("div",{className:"flex flex-col gap-6 sm:flex-row sm:items-center",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-grow",children:[e.jsx(we,{to:`/profile/${s.id}`,children:e.jsx(ye,{avatar_url:s.avatar_url,className:"flex-shrink-0 !w-24 !h-24",gender:s.gender})}),e.jsxs("div",{className:"flex flex-col gap-2 flex-grow",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-100 break-words",children:s.username}),e.jsx("p",{className:"text-gray-400 break-words",children:s.bio})]})]}),e.jsxs("div",{className:"flex gap-4 ml-auto sm:mb-auto items-center relative",children:[!n&&e.jsxs(e.Fragment,{children:[M&&e.jsx(ks,{className:"w-8 h-8 text-white cursor-pointer",onClick:Se,title:t("profile.titles.startChat")}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{className:"w-6 h-6 cursor-pointer text-white hover:text-sky-400 p-2 rounded-full focus:outline-none",onClick:()=>j(b=>!b),"aria-label":"Connection options",children:[e.jsx("span",{className:`absolute inset-0 flex items-center justify-center transition ${O?"opacity-0 scale-90":"opacity-100 scale-100"}`,children:e.jsx(xs,{})}),e.jsx("span",{className:`absolute inset-0 flex items-center justify-center transition ${O?"opacity-100 scale-100":"opacity-0 scale-90"}`,children:e.jsx(Be,{})})]}),O&&e.jsxs("div",{className:"absolute right-0 top-10 z-20 bg-gray-900 border border-sky-700 rounded shadow-lg py-1 w-44 flex flex-col min-w-[150px] profile-connection-menu",children:[y?e.jsx("span",{className:"px-4 py-2 text-gray-400 text-xs flex items-center gap-2",children:t("connection.loading")}):re?e.jsxs("button",{onClick:()=>{ne(),j(b=>!b)},className:"px-4 py-2 cursor-pointer text-left hover:bg-gray-800 text-sm text-yellow-600 flex items-center gap-2",children:[e.jsx(J,{className:"w-4 h-4"}),t("connection.unblock")]}):ae?e.jsxs("span",{className:"px-4 py-2 cursor-pointer text-red-400 text-xs flex items-center gap-2",children:[e.jsx(ue,{}),t("connection.blockedByOther")]}):Le?e.jsxs("button",{onClick:()=>{G(),j(b=>!b)},className:"px-4 py-2 cursor-pointer text-left hover:bg-gray-800 text-sm text-gray-300 flex items-center gap-2",children:[e.jsx(J,{className:"w-4 h-4"}),t("connection.disconnect")]}):Me?e.jsxs("button",{onClick:()=>{G(),j(b=>!b)},className:"px-4 py-2 cursor-pointer text-left hover:bg-gray-800 text-sm text-yellow-400 flex items-center gap-2 group",onMouseEnter:()=>B("disconnect"),onMouseLeave:()=>B(null),children:[C==="disconnect"?e.jsx(J,{className:"w-4 h-4"}):e.jsx(Ge,{className:"w-4 h-4"}),t(C==="disconnect"?"connection.disconnect":"connection.pending")]}):e.jsxs("button",{onClick:()=>{te(),j(b=>!b)},className:"px-4 py-2 cursor-pointer text-left hover:bg-gray-800 text-sm text-green-600 flex items-center gap-2",children:[e.jsx(ze,{className:"w-4 h-4"}),t("connection.connect")]}),!ae&&!re&&e.jsxs("button",{onClick:()=>{Re(),j(b=>!b)},className:"px-4 py-2 cursor-pointer text-left hover:bg-gray-800 text-sm text-red-400 border-t border-sky-800 flex items-center gap-2",children:[e.jsx(ue,{}),t("connection.block")]})]})]})]}),n&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ns,{className:"w-8 h-8 text-white cursor-pointer",onClick:()=>l("/chat"),title:t("profile.titles.chat")}),!d&&((m==null?void 0:m.total)??0)>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full px-1.5",children:m==null?void 0:m.total})]}),e.jsx(Ze,{className:"w-8 h-8 text-white cursor-pointer",onClick:()=>{l("/settings")},title:t("profile.titles.settings")}),e.jsxs("div",{className:"relative",children:[e.jsx(ws,{className:"w-7 h-7 text-white cursor-pointer",onClick:()=>l(`/profile/${s.id}/notifications`),title:t("profile.titles.notifications")}),!p&&se>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full px-1.5",children:se})]})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center sm:justify-end mt-6",children:[!n&&e.jsxs("div",{className:"w-full mx-auto md:mx-0 md:!mr-auto mb-3 flex flex-col items-start gap-6 mt-3",children:[e.jsxs("div",{className:"flex flex-col items-stretch w-full md:flex-row gap-3 md:gap-6",children:[!y&&e.jsxs("button",{title:a?a.status==="accepted"?t("connection.disconnect"):a.status==="pending"?t("connection.cancelRequest"):a.status==="blocked"?a.follower_profile_id===(r==null?void 0:r.id)?t("connection.unblock"):t("connection.blockedByOther"):"":t("connection.connect"),onClick:()=>{if(!a)return te();if(a.status==="pending"||a.status==="accepted")return G();if(a.status==="blocked"&&a.follower_profile_id===(r==null?void 0:r.id))return ne()},className:`w-full sm:w-auto inline-flex items-center justify-center gap-1 px-3.5 py-1.5 rounded-full text-sm font-semibold whitespace-nowrap transition
                    ${a?a.status==="accepted"?"bg-emerald-700 text-white hover:bg-emerald-800":a.status==="pending"?"bg-yellow-600 text-white hover:bg-yellow-700":a.status==="blocked"&&a.follower_profile_id===(r==null?void 0:r.id)?"bg-red-700 text-white hover:bg-red-800":a.status==="blocked"&&a.follower_profile_id===s.id?"bg-gray-600 text-gray-200 cursor-not-allowed":"bg-gray-700 text-white":"bg-sky-700 text-white hover:bg-sky-800"}
                    ${(a==null?void 0:a.status)==="blocked"&&a.follower_profile_id===s.id?"pointer-events-none":"cursor-pointer"}
                  `,disabled:(a==null?void 0:a.status)==="blocked"&&a.follower_profile_id===s.id,children:[$e(a==null?void 0:a.status),a?a.status==="accepted"?t("connection.accepted"):a.status==="pending"?t("connection.pending"):a.status==="blocked"&&a.follower_profile_id===(r==null?void 0:r.id)?t("connection.blocked"):a.status==="blocked"&&a.follower_profile_id===s.id?t("connection.blockedByOther"):"":t("connection.connect")]}),e.jsx("div",{children:e.jsx(Hs,{otherProfile:s})})]}),_e&&e.jsx("p",{className:"text-xs mx-auto sm:mx-0 sm:mr-auto text-gray-400",children:t("profile.lastSeen",{time:qs(s.last_seen)})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-4",children:e.jsx($,{onClick:()=>l(`/profile/${s.id}`),children:t("profile.navigation.about")})}),e.jsx("div",{className:"sm:mb-4",children:e.jsx($,{onClick:()=>l(`/profile/${s.id}/ads`),children:t("profile.navigation.ads")})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-4",children:e.jsx($,{onClick:()=>l(`/profile/${s.id}/posts`),children:t("profile.navigation.posts")})}),e.jsx("div",{className:"sm:mb-4",children:e.jsx($,{starBorder:!0,onClick:()=>l(`/profile/${s.id}/groups`),className:"!bg-amber-800 hover:!bg-amber-900",children:t("profile.navigation.groups")})})]})]})]})},Vs=({profileData:n})=>{const{t:s}=v("profile"),{privacyOthers:t}=pe(),{data:r={}}=t(n.id);function l(i){if(!i)return 0;const o=new Date(i),c=new Date;let m=c.getFullYear()-o.getFullYear();const d=c.getMonth()-o.getMonth();return(d<0||d===0&&c.getDate()<o.getDate())&&m--,m}return e.jsx("div",{className:"flex flex-col items-center",children:e.jsxs("ul",{className:"grid grid-cols-1 sm:grid-cols-2 gap-x-12 gap-y-4 text-lg text-gray-300",children:[n.firstname&&e.jsxs("li",{className:"flex items-center",children:[e.jsxs("span",{className:"font-semibold w-28 text-gray-500",children:[s("profile.data.firstname"),":"]}),e.jsx("span",{children:n.firstname})]}),n.lastname&&e.jsxs("li",{className:"flex items-center",children:[e.jsxs("span",{className:"font-semibold w-28 text-gray-500",children:[s("profile.data.lastname"),":"]}),e.jsx("span",{children:n.lastname})]}),n.country&&e.jsxs("li",{className:"flex items-center",children:[e.jsxs("span",{className:"font-semibold w-28 text-gray-500",children:[s("profile.data.country"),":"]}),e.jsx("span",{children:n.country})]}),n.state&&e.jsxs("li",{className:"flex items-center",children:[e.jsxs("span",{className:"font-semibold w-28 text-gray-500",children:[s("profile.data.state"),":"]}),e.jsx("span",{children:n.state})]}),n.neighborhood&&e.jsxs("li",{className:"flex items-center",children:[e.jsxs("span",{className:"font-semibold w-28 text-gray-500",children:[s("profile.data.neighborhood"),":"]}),e.jsx("span",{children:n.neighborhood})]}),n.gender&&e.jsxs("li",{className:"flex items-center",children:[e.jsxs("span",{className:"font-semibold w-28 text-gray-500",children:[s("profile.data.gender"),":"]}),e.jsx("span",{children:s(`edit.placeholders.genderOptions.${n.gender.toLowerCase()}`)})]}),n.birthdate&&e.jsxs("li",{className:"flex items-center",children:[e.jsxs("span",{className:"font-semibold w-28 text-gray-500",children:[s("profile.data.age"),":"]}),e.jsxs("span",{children:[l(n.birthdate)," ",s("profile.data.years")]})]}),r.show_email&&n.email&&e.jsxs("li",{className:"flex items-center",children:[e.jsxs("span",{className:"font-semibold w-28 text-gray-500",children:[s("profile.data.email"),":"]}),e.jsx("span",{children:n.email})]})]})})},Ks=({role:n,data:s})=>{const{t}=v("music");return!s||s.length===0?e.jsx("p",{className:"text-gray-400 mt-4 italic text-center",children:t("roles.noData")}):e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"text-xl font-bold mb-4 text-sky-200 text-center",children:t("roles.detailsTitle",{role:t(`roles.${n.role.toLowerCase()}`)})}),e.jsx("ul",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.map(r=>e.jsxs("li",{className:"bg-gray-800 border border-gray-700 rounded-xl p-4 shadow-sm",children:[n.role==="Instrumentalist"&&e.jsxs(e.Fragment,{children:[e.jsx(N,{label:t("fields.instrument"),value:r.instrument}),e.jsx(N,{label:t("fields.yearsOfExperience"),value:r.years_of_experience}),e.jsx(N,{label:t("fields.level"),value:t(`levels.${r.level.toLowerCase()}`)})]}),n.role==="Singer"&&e.jsxs(e.Fragment,{children:[e.jsx(N,{label:t("fields.voiceType"),value:r.voice_type}),e.jsx(N,{label:t("fields.musicGenre"),value:r.music_genre}),e.jsx(N,{label:t("fields.level"),value:t(`levels.${r.level.toLowerCase()}`)})]}),n.role==="DJ"&&e.jsxs(e.Fragment,{children:[e.jsx(N,{label:t("fields.eventsPlayed"),value:r.events_played}),e.jsx(N,{label:t("fields.preferredGenres"),value:r.preferred_genres}),e.jsx(N,{label:t("fields.level"),value:t(`levels.${r.level.toLowerCase()}`)})]}),n.role==="Producer"&&e.jsxs(e.Fragment,{children:[e.jsx(N,{label:t("fields.productionType"),value:r.production_type}),e.jsx(N,{label:t("fields.yearsOfExperience"),value:r.years_of_experience}),e.jsx(N,{label:t("fields.level"),value:t(`levels.${r.level.toLowerCase()}`)})]}),n.role==="Composer"&&e.jsxs(e.Fragment,{children:[e.jsx(N,{label:t("fields.compositionStyle"),value:r.composition_style}),e.jsx(N,{label:t("fields.yearsOfExperience"),value:r.years_of_experience}),e.jsx(N,{label:t("fields.level"),value:t(`levels.${r.level.toLowerCase()}`)})]})]},r.id))})]})},N=({label:n,value:s})=>e.jsxs("p",{className:"text-sm text-gray-300 mb-1",children:[e.jsxs("span",{className:"font-semibold text-gray-200",children:[n,": "]}),"  ",s||"N/A"]}),Qs=({role:n,expandedRole:s,handleRoleClick:t})=>{const{t:r}=v("music"),l=s===n.id;return e.jsxs("div",{className:`p-5 rounded-xl shadow-md border transition-all duration-300 cursor-pointer text-white text-center select-none
        ${l?"border-sky-500 bg-sky-800/30":"border-gray-700 bg-gray-800 hover:border-sky-500 hover:bg-gray-700/60"}
      `,onClick:()=>t(n),children:[e.jsx("span",{className:"text-lg font-semibold tracking-wide",children:r(`roles.${n.role.toLowerCase()}`)}),e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(ke,{className:`text-gray-400 w-5 transition-transform duration-200 ${l?"rotate-180":""}`})})]})},Xs=()=>{const n="#a1a1aa",s="#e4e4e7";return e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx(E,{height:50,className:"rounded-lg",baseColor:n,highlightColor:s}),e.jsx(E,{height:300,className:"rounded-lg",baseColor:n,highlightColor:s})]})},et=({profileId:n})=>{const{user:s}=R(),{t}=v("music"),{userMediaLinks:r}=Ye(),{data:l=[],isLoading:i}=r(n),o=X(),c=s&&s.id===n;if(i)return e.jsx(Xs,{});const m=x=>{const g=x.match(/spotify\.com\/(track|playlist|album)\/([a-zA-Z0-9]+)/);if(!g)return null;const[w,f,k]=g;return`https://open.spotify.com/embed/${f}/${k}`},d=l.slice(0,2);return e.jsxs("section",{className:"mb-10",children:[c&&e.jsx(H,{label:t("media.actions.add"),to:"/media/create"}),e.jsx("ul",{className:"space-y-4 text-center",children:d.map(x=>e.jsxs("li",{className:"shadow-sm p-4 rounded-lg bg-gradient-to-l to-gray-800",children:[e.jsx("p",{className:"font-medium mb-2 text-center",children:x.title}),x.media_type==="spotify"&&x.url?e.jsx("iframe",{src:m(x.url)||void 0,width:"100%",height:"80",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",className:"rounded w-full max-w-full"}):x.url?e.jsx("div",{className:"aspect-video bg-black rounded overflow-hidden",children:e.jsx(fs,{url:x.url,controls:!0,width:"100%",height:"100%",style:{maxWidth:"100%"}})}):null]},x.id))}),l.length>2&&e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx($,{onClick:()=>o(`/media/${n}`),className:"!text-emerald-600 !text-2xl hover:!text-emerald-700 !bg-transparent",children:t("media.actions.seeMore")})})]})},st=()=>e.jsxs("div",{className:"bg-gray-800 p-5 rounded-xl shadow-md flex flex-col gap-4 items-center",children:[e.jsx(E,{height:24,width:120,baseColor:"#a1a1aa",highlightColor:"#e4e4e7"}),e.jsx(ke,{className:"text-gray-400 mt-2 w-5"})]}),tt=()=>{const n="#a1a1aa",s="#e4e4e7";return e.jsxs("div",{className:"mt-6",children:[e.jsx("div",{className:"text-center mb-4",children:e.jsx(E,{width:220,height:28,baseColor:n,highlightColor:s})}),e.jsx("ul",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[...Array(2)].map((t,r)=>e.jsx("li",{className:"bg-gray-800 border border-gray-700 rounded-xl p-4 shadow-sm",children:[...Array(3)].map((l,i)=>e.jsx("div",{className:"mb-2",children:e.jsx(E,{height:14,baseColor:n,highlightColor:s,width:`${80+Math.random()*20}%`})},i))},r))})]})},nt=({profileId:n})=>{const{t:s}=v("music"),{user:t}=R(),[r,l]=u.useState(),{fetchRoles:i}=We(),{data:o,isLoading:c,error:m}=i(n),{fetchInstruments:d}=He(),{data:x,isLoading:g}=d(r??""),{fetchSinger:w}=qe(),{data:f,isLoading:k}=w(r??""),{fetchComposer:h}=Je(),{data:p,isLoading:F}=h(r??""),{fetchProducers:L}=Ve(),{data:_,isLoading:P}=L(r??""),{fetchDj:a}=Ke(),{data:y,isLoading:M}=a(r??""),[A,T]=u.useState(void 0),q=t&&t.id===n,U=c||g||k||F||P||M,O=j=>{A===j.id?T(void 0):(T(j.id),l(j.id))};return m?e.jsx(I,{error:m.message||s("errors.fetch")}):e.jsxs("div",{className:"bg-gray-900 p-6 rounded-lg shadow-md w-full",children:[e.jsx("div",{className:"flex items-center justify-center font-semibold gap-3 mb-6",children:e.jsx(ee,{text:s("roles.title"),speed:3,className:"text-3xl tracking-wide"})}),e.jsx(et,{profileId:n}),q&&e.jsx(H,{label:s("roles.addRole"),to:"/settings/music"}),o&&o.length===0?e.jsx("p",{className:"text-gray-400 text-center",children:s("roles.none")}):o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:U&&!o.length?[...Array(3)].map((j,C)=>e.jsx(st,{},C)):o.map(j=>e.jsx(Qs,{role:j,expandedRole:A,handleRoleClick:O},j.id))}),A&&e.jsxs("div",{className:"mt-6",children:[U?e.jsx(tt,{}):(()=>{const j=o.find(B=>B.id===A);let C=[];if(j){switch(j.role){case"Instrumentalist":C=x??[];break;case"Singer":C=f??[];break;case"DJ":C=y??[];break;case"Producer":C=Array.isArray(_)?_:_?[_]:[];break;case"Composer":C=p??[];break;default:C=[]}return e.jsx(Ks,{role:j,data:C})}return null})(),e.jsx("div",{className:"flex justify-center mt-4 cursor-pointer",onClick:()=>T(void 0),children:e.jsx(Ss,{className:"text-gray-500"})})]})]}):null]})},K=({checkStatus:n,profileId:s,maxVisible:t})=>{const{user:r}=R(),{t:l}=v("ui",{keyPrefix:"connections"}),{userConnections:i}=be(),{data:o}=i(s),c=s===(r==null?void 0:r.id);if(!["accepted","pending","blocked"].includes(n)||!o)return null;const m=o.filter(f=>n==="accepted"?f.status==="accepted":n==="blocked"?f.status==="blocked":n==="pending"?f.status==="pending"&&f.following_profile_id===s:!1),d=f=>f.following_profile_id===s?f.follower_profile_id:f.following_profile_id,x=n==="accepted"?l("title"):null,g=n==="accepted",w=t?m.slice(0,t):m;return e.jsxs("div",{className:"max-w-4xl mx-auto w-full bg-gradient-to-l from-gray-900 py-4 flex flex-wrap justify-center rounded-lg gap-4",children:[e.jsx("div",{className:"w-full flex items-center justify-between px-4 mb-2",children:e.jsxs("h2",{className:"text-xl font-bold text-white",children:[x,g&&e.jsxs("span",{className:"ml-2 text-sky-400 text-lg font-semibold",children:["(",m.length,")"]})]})}),w.length>0?w.map(f=>e.jsx(cs,{connection:f,profileId:d(f),ownProfile:c},f.id)):e.jsx("div",{className:"text-gray-400",children:l(n==="pending"?"noPendingConnections":"noConnections")}),t&&m.length>t&&e.jsx(we,{to:`/profile/${s}/connections`,className:"w-full text-center text-sky-400 hover:underline mt-2 block",children:l("viewAll")})]})},rt=({groupId:n})=>{const{t:s}=v("profileGroup"),{fetchProfileGroup:t}=Qe(),r=X(),{data:l,isLoading:i,error:o}=t(n),c=()=>{l&&r(`/group/${l.id}`)};return i?e.jsx(W,{}):o?e.jsx(I,{error:o.message}):l?e.jsxs("div",{className:"bg-gradient-to-r from-gray-800 p-4 rounded-lg shadow-md flex gap-4 items-center",children:[e.jsx(ye,{avatar_url:l.avatar_url||"/default-avatar.png",alt:l.name,className:"!w-20 !h-20",group:!0}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-100",children:l.name}),e.jsx("p",{className:"text-sm text-gray-400",children:l.bio})]}),e.jsx($,{className:"ml-auto !bg-amber-800 hover:!bg-amber-900",onClick:c,children:s("groupItem.viewGroup","View Group")})]}):null},at=({profileId:n,isOwnProfile:s})=>{const{t}=v("profileGroup"),{groupId:r}=Ne(),{user:l}=R(),{fetchUserGroups:i}=Xe(),{data:o,isLoading:c,error:m}=i(n);return c?e.jsx(W,{}):m?e.jsx(I,{error:m.message}):e.jsxs("div",{className:"bg-gradient-to-l to-gray-900 p-6 rounded-b-lg shadow-lg max-w-4xl mx-auto",children:[e.jsx("h2",{className:"text-3xl font-semibold text-center mb-4 tracking-wide",children:e.jsx(ee,{text:t("userGroups.groups"),style:{"--shiny-primary":"#d97706cc"},className:"!text-amber-600",speed:3})}),!o||o.length===0?e.jsx("p",{className:"text-gray-400 text-center",children:t(s?"userGroups.notInAnyGroups":"userGroups.userNotInAnyGroups")}):e.jsx("div",{className:"grid grid-cols-1 gap-4",children:o.map(d=>e.jsx(rt,{groupId:d.id},d.id))}),s&&e.jsx("div",{className:"mt-6 flex justify-start",children:e.jsx(H,{label:t("userGroups.createNewGroup"),to:"/create-profile-group",color:"amber",slide:"right"})})]})},lt=({profileId:n})=>{const{t:s}=v("ads"),{user:t}=R(),{fetchInfiniteByUser:r}=es(),{data:l,fetchNextPage:i,hasNextPage:o,isFetchingNextPage:c,isLoading:m,error:d}=r(n),x=(t==null?void 0:t.id)===n;if(m)return e.jsx(ps,{isProfileView:!0});if(d)return e.jsx(I,{error:d.message});const g=l?l.pages.flat():[];return e.jsxs("div",{className:"mx-auto text-center w-full",children:[e.jsx("h2",{className:"text-center font-semibold mb-4",children:e.jsx(ee,{text:s("profileAds.title"),speed:3,className:"text-3xl tracking-wide"})}),x&&e.jsx(H,{label:s("adsPage.buttons.createAd"),to:"/ads/new",showLabelOnMobile:!0}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:g.length>0?g.map(w=>e.jsx(js,{ad:w,publisherId:n},w.id)):e.jsx("p",{className:"col-span-full text-center text-gray-400",children:s("profileAds.empty")})}),o&&e.jsx($,{className:"!w-1/2 md:!w-1/3 !font-bold mt-4 !mx-auto hover:!text-sky-600",onClick:()=>i(),disabled:c,children:s(c?"profileAds.buttons.loading":"profileAds.buttons.loadMore")})]})},fe=n=>typeof n=="string"?JSON.parse(n):n||{},it=({profileId:n})=>{const{t:s}=v("profile",{keyPrefix:"notifications"}),[t,r]=u.useState(!1),{userNotifications:l,notificationsRealtime:i,updateNotification:o}=je(),{data:c=[],isLoading:m,error:d}=l(n);i(n);const x=u.useMemo(()=>c.map(a=>a.from_user_id).filter(Boolean).sort(),[c]),g=u.useMemo(()=>c.map(a=>fe(a.payload).group_id).filter(Boolean).sort(),[c]),{profilesMap:w}=Q(),{data:f={}}=w(x),k=a=>{var y,M;return((y=f[a])==null?void 0:y.username)||((M=f[a])==null?void 0:M.firstname)||s("someone")},{data:h=[]}=ss({queryKey:["notifGroups",g],enabled:g.length>0,queryFn:async()=>{const{data:a,error:y}=await ts.schema("users").from("profile_groups").select("id, name").in("id",g);if(y)throw new Error(y.message);return a??[]}}),p=u.useMemo(()=>{const a={};return h.forEach(y=>{a[y.id]=y.name}),a},[h]),F=a=>p[a]||s("aGroup"),L=async a=>{a.is_read||await o({...a,is_read:!0})};if(m)return e.jsx(W,{});if(d)return e.jsx(I,{error:d.message});if(c.length===0)return e.jsx("div",{className:"p-4 max-w-4xl mx-auto",children:s("noNotifications")});const _=a=>{const y=fe(a.payload);switch(a.type){case"group_follow":return s("group_follow",{user:k(y.follower_id),group:F(y.group_id)});default:return s(a.type,{user:k(a.from_user_id)})}},P=t?c:c.slice(0,10);return e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("ul",{className:`divide-y divide-gray-700
                   p-4 bg-gradient-to-l to-gray-900 rounded-lg shadow-md`,children:P.map(a=>e.jsxs("li",{onClick:()=>L(a),className:`py-2 cursor-pointer hover:bg-gray-800 transition ${a.is_read?"text-gray-400":"text-white font-semibold"}`,children:["• ",_(a)]},a.id))}),c.length>10&&e.jsx("button",{onClick:()=>r(a=>!a),className:"mt-4 mx-auto block text-sky-400 hover:underline",children:s(t?"seeLess":"seeAll")})]})},ot=({profileId:n})=>{const{t:s}=v("profile"),t="cursor-pointer px-4 py-2 text-sm sm:text-base font-semibold rounded-lg transition-all",r=`${t} border-b-2 border-sky-600 text-white shadow-lg`,l=`${t} text-gray-300 hover:text-sky-600`;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-gradient-to-b from-gray-800 to-gray-950 rounded-t-lg",children:e.jsxs("nav",{className:"flex justify-center space-x-8 py-3",children:[e.jsx(me,{end:!0,to:`/profile/${n}/notifications`,className:({isActive:i})=>i?r:l,children:s("profile.internNav.notifications")}),e.jsx(me,{to:`/profile/${n}/notifications/pending`,className:({isActive:i})=>i?r:l,children:s("profile.internNav.pending")})]})}),e.jsxs(ve,{children:[e.jsx(S,{index:!0,element:e.jsx(it,{profileId:n})}),e.jsx(S,{path:"pending",element:e.jsx(K,{profileId:n,checkStatus:"pending"})})]})]})};function It(){const{t:n}=v("profileGroup",{keyPrefix:"userGroups"}),{identifier:s}=Ne(),{user:t,loading:r}=R(),{fetchProfile:l}=Q(),{data:i,isLoading:o,error:c}=l(s);if(r||o)return e.jsx(W,{});if(c)return e.jsx(I,{error:c.message});if(!i)return null;const d=(t==null?void 0:t.id)===s,x=()=>e.jsxs(e.Fragment,{children:[e.jsx(Vs,{profileData:i}),e.jsx(nt,{profileId:i.id}),e.jsx(K,{profileId:i.id,checkStatus:"accepted",maxVisible:4})]}),g=()=>e.jsx(gs,{profileId:i.id,disableSearch:!1,isOwnProfile:d}),w=()=>e.jsx(hs,{}),f=()=>e.jsx(at,{profileId:i.id,isOwnProfile:d}),k=()=>e.jsx(lt,{profileId:i.id});return e.jsx("div",{className:"flex flex-col min-h-screen text-white",children:e.jsxs("div",{className:"max-w-4xl mx-auto p-6 space-y-6",children:[e.jsx(Js,{profileData:i,isOwnProfile:d}),e.jsxs(ve,{children:[e.jsx(S,{index:!0,element:e.jsx(x,{})}),e.jsx(S,{path:"posts",element:e.jsx(g,{})}),e.jsx(S,{path:"connections",element:e.jsx(K,{profileId:i.id,checkStatus:"accepted"})}),d&&e.jsx(S,{path:"create",element:e.jsx(w,{})}),e.jsx(S,{path:"groups",element:e.jsx(f,{})}),e.jsx(S,{path:"ads",element:e.jsx(k,{})}),d&&e.jsx(S,{path:"notifications/*",element:e.jsx(ot,{profileId:i.id})})]})]})})}export{It as default};
