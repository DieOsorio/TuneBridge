import{j as t}from"./mui-DntPDMdt.js";import{r as s}from"./calendar-DXWKnWXk.js";import{u as Z,a as v,A as T,D as B,G as O,j as D,L as H,P as I,H as U,J as p,K as q,b as G,k as J}from"./index-CXxZbzPL.js";import{u as K,h as V}from"./useCanSendDM-B2eMgjGS.js";import{S as d}from"./index-BXOMkYts.js";/* empty css                 */import{F as w}from"./UserMinusIcon-kiJSbPsH.js";import"./reactPlayer-CBmCIXQE.js";import"./icons-Cf_ygVw3.js";import"./lottie-FCmafNqs.js";import"./gsap-CH_iu5NA.js";import"./filepond-DvarZm2e.js";function z({title:e,titleId:a,...r},n){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":a},r),e?s.createElement("title",{id:a},e):null,s.createElement("path",{fillRule:"evenodd",d:"M5.337 21.718a6.707 6.707 0 0 1-.533-.074.75.75 0 0 1-.44-1.223 3.73 3.73 0 0 0 .814-1.686c.023-.115-.022-.317-.254-.543C3.274 16.587 2.25 14.41 2.25 12c0-5.03 4.428-9 9.75-9s9.75 3.97 9.75 9c0 5.03-4.428 9-9.75 9-.833 0-1.643-.097-2.417-.279a6.721 6.721 0 0 1-4.246.997Z",clipRule:"evenodd"}))}const Q=s.forwardRef(z);function W({title:e,titleId:a,...r},n){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":a},r),e?s.createElement("title",{id:a},e):null,s.createElement("path",{fillRule:"evenodd",d:"m6.72 5.66 11.62 11.62A8.25 8.25 0 0 0 6.72 5.66Zm10.56 12.68L5.66 6.72a8.25 8.25 0 0 0 11.62 11.62ZM5.105 5.106c3.807-3.808 9.98-3.808 13.788 0 3.808 3.807 3.808 9.98 0 13.788-3.807 3.808-9.98 3.808-13.788 0-3.808-3.807-3.808-9.98 0-13.788Z",clipRule:"evenodd"}))}const X=s.forwardRef(W);function Y({title:e,titleId:a,...r},n){return s.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":a},r),e?s.createElement("title",{id:a},e):null,s.createElement("path",{fillRule:"evenodd",d:"M18.685 19.097A9.723 9.723 0 0 0 21.75 12c0-5.385-4.365-9.75-9.75-9.75S2.25 6.615 2.25 12a9.723 9.723 0 0 0 3.065 7.097A9.716 9.716 0 0 0 12 21.75a9.716 9.716 0 0 0 6.685-2.653Zm-12.54-1.285A7.486 7.486 0 0 1 12 15a7.486 7.486 0 0 1 5.855 2.812A8.224 8.224 0 0 1 12 20.25a8.224 8.224 0 0 1-5.855-2.438ZM15.75 9a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z",clipRule:"evenodd"}))}const ee=s.forwardRef(Y),te=()=>{const e="#a1a1aa",a="#e4e4e7";return t.jsxs("div",{className:`
        max-w-100 w-full mx-auto border border-gray-400 rounded-xl p-4 
        shadow-sm bg-gray-950 
        hover:shadow-md 
        transition-all duration-150 ease-in-out 
        will-change-transform
        relative
      `,children:[t.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[t.jsx(d,{circle:!0,height:52,width:52,baseColor:e,highlightColor:a}),t.jsxs("div",{className:"flex flex-col gap-1",children:[t.jsx(d,{height:18,width:120,baseColor:e,highlightColor:a}),t.jsx(d,{height:14,width:80,baseColor:e,highlightColor:a})]})]}),t.jsx("div",{className:"absolute top-4 right-4",children:t.jsx(d,{circle:!0,height:35,width:35,baseColor:e,highlightColor:a})}),t.jsxs("div",{className:"flex justify-between items-center ",children:[t.jsx("div",{children:t.jsx(d,{height:30,width:100,baseColor:e,highlightColor:a,borderRadius:15})}),t.jsx("div",{children:t.jsx(d,{height:25,width:120,baseColor:e,highlightColor:a,borderRadius:6})})]})]})},ae=s.memo(({profile:e,loading:a})=>{const{t:r}=Z("profile"),{user:n}=v(),{addConnection:u,deleteConnection:m,updateConnection:h,userConnections:b}=T(),{findConversation:j,createConversation:C}=B(),{addParticipant:_}=O(),[l,se]=s.useState(null),[N,y]=s.useState(!1),{canSend:R,loading:S}=K(e.profile_id),k=D(),{data:f}=b(e.profile_id),o=f==null?void 0:f.find(c=>n&&c.follower_profile_id===n.id&&c.following_profile_id===e.profile_id||n&&c.follower_profile_id===e.profile_id&&c.following_profile_id===n.id),E=["connect","pending","accepted","blocked"];function M(c){return E.includes(c)}const x=o==null?void 0:o.status,i=M(x)?x:"connect",A=async()=>{n&&(i==="connect"?await u({follower_profile_id:n.id,following_profile_id:e.profile_id,status:"pending"}):(i==="pending"||i==="accepted")&&o?await m(o):i==="blocked"&&o&&await h({connection:o,updatedConnection:{status:"accepted"}}))},$=()=>{N||!n||V({myProfileId:n.id,otherProfile:{id:e.profile_id,username:e.username,avatar_url:e.avatar_url,last_seen:e.last_seen},findConversation:j,createConversation:C,addParticipant:_,navigate:k,setLoading:()=>y(!0)})},g=Math.round(e.match_score*100);if(a||!e||S)return t.jsx(te,{});const F=g>=70?"bg-amber-800 text-white":g>=40?"bg-sky-700 text-white":g>=10?"bg-gray-300 text-gray-900":"bg-gray-800 text-gray-100",L=()=>i==="pending"?r("connection.cancelRequest"):i==="accepted"?r("connection.disconnect"):i==="blocked"?r("connection.unblock"):null,P={connect:t.jsx(q,{className:"w-4 h-4"}),pending:t.jsx(ee,{className:"w-4 h-4"}),accepted:t.jsx(p,{className:"w-4 h-4"}),blocked:t.jsx(X,{className:"w-4 h-4"})}[i];return t.jsxs("div",{className:`
      max-w-100 w-full mx-auto border border-gray-400 rounded-xl p-4 
      shadow-sm bg-gray-950 
      hover:shadow-md 
      transition-all duration-150 ease-in-out 
      will-change-transform
    `,children:[t.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[t.jsx(H,{to:`/profile/${e.profile_id}`,children:t.jsx(I,{avatar_url:e.avatar_url,alt:e.username,className:"!w-13 !h-13",loading:!1,list:!1,gender:e.gender??"",group:!1})}),t.jsxs("div",{children:[t.jsx("div",{className:"font-semibold text-gray-100",children:e.name||e.display_name||e.username}),t.jsxs("div",{className:"text-sm text-gray-400",children:["@",e.username]})]})]}),t.jsxs("div",{className:`absolute inline-flex items-center gap-2 cursor-help select-none px-3 py-1 rounded-full text-sm font-semibold ${F}`,title:r("matchScore.cardTitle"),children:[t.jsx(U,{className:"text-amber-500 w-4 h-4"}),t.jsxs("span",{children:["Match: ",g,"%"]})]}),t.jsxs("div",{className:"flex flex-col items-end gap-2 text-sm",children:[R&&t.jsx("button",{onClick:$,className:"absolute top-4 right-4 text-amber-700 cursor-pointer hover:text-amber-800 transition",children:t.jsx(Q,{className:"w-8 h-8"})}),t.jsx("button",{onClick:A,title:L()||"",className:"flex cursor-pointer items-center min-w-35 justify-center gap-1 px-3 py-1 rounded bg-gray-700 text-white hover:bg-gray-800 transition text-sm",children:t.jsxs("span",{className:"truncate flex items-center gap-1",children:[l&&i==="accepted"&&t.jsx(w,{className:"w-4 h-4"}),l&&i==="pending"&&t.jsx(w,{className:"w-4 h-4"}),l&&i==="blocked"&&t.jsx(p,{className:"w-4 h-4"}),!l&&P,t.jsx("span",{children:l||r(`connection.${i}`)})]})})]})]})});function pe(){const{user:e}=v(),{matchAll:a}=G(),[r,n]=s.useState([]),[u,m]=s.useState(!0);return s.useEffect(()=>{e&&(m(!0),a({profileId:e.id,limit:9}).then(n).catch(console.error).finally(()=>m(!1)))},[e==null?void 0:e.id]),!r.length||u?t.jsx(J,{}):t.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:r.map(h=>t.jsx(ae,{profile:h,loading:u},h.profile_id))})}export{pe as default};
