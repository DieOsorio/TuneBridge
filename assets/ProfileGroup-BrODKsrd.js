import{j as e,n as X,t as V,e as de,a as me,g as Q,b as ue,c as T,m as K,d as $,f as F,h as xe,i as Y,L as he,k as ge,D as Z}from"./mui-DM0ppf3M.js";import{u as N,a as E,j as ne,M as le,P as q,L as pe,B as M,O as B,c as fe,I as ee,S as ie,T as je,Q as oe,b as be,k as U,E as W,G as ye,h as ve,g as we,z as te,R as _e,i as D,U as Ne}from"./index-BXNurRLk.js";import{P as Me,Q as Se,S as ke}from"./icons-A8qOaPVA.js";import{c as O,g as De,a as Le,e as J,C as Ce,b as Pe}from"./ConnectionCard-DIMeTEOz.js";import{P as Te}from"./PlusButton-TDForXBH.js";import{r as v,F as Fe,i as Ee,j as Ge,k as Ae,l as Ie}from"./calendar-BpW-aEGs.js";import{S as _}from"./index-CpFbDMuT.js";/* empty css                 */import{m as $e}from"./proxy-B8wBTftU.js";import"./reactPlayer-CjHFj7G4.js";import"./lottie-DTlWc_fK.js";import"./gsap-Brfk6Bdo.js";import"./filepond-DcLflJls.js";const Ye=({groupData:t,CanManageGroup:a,isMember:s})=>{const{t:r}=N("profileGroup",{keyPrefix:"groupHeader"}),{user:l}=E(),i=ne(),n=`/group/${t.id}`,o="!bg-amber-950 hover:!bg-gray-900/60 hover:!text-white",{followGroup:d,unfollowGroup:c,checkFollowStatus:x,countFollowers:h}=le(),{data:m,isLoading:p}=x(t.id,l.id),{data:g}=h(t.id),f=!!m,j=async()=>{p||!l||(f?await c({profile_group_id:t.id,follower_profile_id:l.id}):await d({profile_group_id:t.id,follower_profile_id:l.id}))},w=f?"bg-neutral-900 hover:bg-amber-950":"bg-amber-950 hover:bg-gray-900/60",b=r(f?"badges.status.following":"badges.status.follow"),L=f?e.jsx(Se,{className:"text-amber-600"}):e.jsx(ke,{className:"text-amber-600"});return e.jsxs("div",{className:"relative bg-gradient-to-r md:min-w-2xl lg:min-w-4xl from-amber-950 to-amber-800 mb-4 p-4 rounded-b-lg",children:[e.jsxs("div",{className:"flex flex-col gap-6 sm:flex-row sm:items-center",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-grow",children:[e.jsx(q,{avatar_url:t.avatar_url,className:"flex-shrink-0 !w-24 !h-24"}),e.jsxs("div",{className:"flex flex-col gap-2 flex-grow",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-white break-words",children:t.name}),e.jsx("p",{className:"text-gray-200 break-words",children:t.bio})]})]}),e.jsx("div",{className:"flex gap-4 ml-auto items-center mb-auto",children:a&&e.jsx(Me,{className:"w-8 h-8 text-white cursor-pointer",onClick:()=>i(`${n}/settings`),title:r("btnTitles.settings")})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-center md:justify-end mt-6 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-3 sm:mr-auto mt-auto",children:[!a&&l&&e.jsxs("button",{onClick:j,disabled:p,title:r(f?"btnTitles.unfollow":"btnTitles.follow"),className:`${w} cursor-pointer inline-flex items-center gap-1 px-3.5 py-1.5 rounded-full text-sm font-semibold whitespace-nowrap transition`,children:[L,b]}),typeof g=="number"&&e.jsx(pe,{to:`${n}/followers`,className:"text-sm font-medium text-gray-300 hover:underline",title:r("followersCount",{count:g}),children:r("followersCount",{count:g})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-4",children:e.jsx(M,{className:o,onClick:()=>i(n),children:r("nav.about")})}),e.jsx("div",{className:"sm:mb-4",children:e.jsx(M,{className:o,onClick:()=>i(`${n}/posts`),children:r("nav.posts")})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-4",children:e.jsx(M,{className:o,onClick:()=>i(n),children:r("nav.media")})}),s&&e.jsx("div",{className:"sm:mb-4",children:e.jsx(M,{className:o,onClick:()=>i(`${n}/calendar`),children:r("nav.calendar")})})]})]})]})};function Oe(t,a,s){const[r,l]=X(s==null?void 0:s.in,t,a),i=r.getFullYear()-l.getFullYear(),n=r.getMonth()-l.getMonth();return i*12+n}function Re(t,a){return+V(t)-+V(a)}function He(t,a){const s=V(t,a==null?void 0:a.in);return+de(s,a)==+me(s,a)}function We(t,a,s){const[r,l,i]=X(s==null?void 0:s.in,t,t,a),n=O(l,i),o=Math.abs(Oe(l,i));if(o<1)return 0;l.getMonth()===1&&l.getDate()>27&&l.setDate(30),l.setMonth(l.getMonth()-n*o);let d=O(l,i)===-n;He(r)&&o===1&&O(r,i)===1&&(d=!1);const c=n*(o-+d);return c===0?0:c}function ze(t,a,s){const r=Re(t,a)/1e3;return De(s==null?void 0:s.roundingMethod)(r)}function Ve(t,a,s){const r=ue(),l=(s==null?void 0:s.locale)??r.locale??T,i=2520,n=O(t,a);if(isNaN(n))throw new RangeError("Invalid time value");const o=Object.assign({},s,{addSuffix:s==null?void 0:s.addSuffix,comparison:n}),[d,c]=X(s==null?void 0:s.in,...n>0?[a,t]:[t,a]),x=ze(c,d),h=(Q(c)-Q(d))/1e3,m=Math.round((x-h)/60);let p;if(m<2)return s!=null&&s.includeSeconds?x<5?l.formatDistance("lessThanXSeconds",5,o):x<10?l.formatDistance("lessThanXSeconds",10,o):x<20?l.formatDistance("lessThanXSeconds",20,o):x<40?l.formatDistance("halfAMinute",0,o):x<60?l.formatDistance("lessThanXMinutes",1,o):l.formatDistance("xMinutes",1,o):m===0?l.formatDistance("lessThanXMinutes",1,o):l.formatDistance("xMinutes",m,o);if(m<45)return l.formatDistance("xMinutes",m,o);if(m<90)return l.formatDistance("aboutXHours",1,o);if(m<K){const g=Math.round(m/60);return l.formatDistance("aboutXHours",g,o)}else{if(m<i)return l.formatDistance("xDays",1,o);if(m<$){const g=Math.round(m/K);return l.formatDistance("xDays",g,o)}else if(m<$*2)return p=Math.round(m/$),l.formatDistance("aboutXMonths",p,o)}if(p=We(c,d),p<12){const g=Math.round(m/$);return l.formatDistance("xMonths",g,o)}else{const g=p%12,f=Math.trunc(p/12);return g<3?l.formatDistance("aboutXYears",f,o):g<9?l.formatDistance("overXYears",f,o):l.formatDistance("almostXYears",f+1,o)}}function Xe(t,a){return Ve(t,Le(t),a)}const qe=({group:t,members:a})=>{const{t:s,i18n:r}=N("profileGroup"),l=r.language==="es"?J:T;return e.jsxs("div",{className:"space-y-6",children:[t.genres&&t.genres.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:t.genres.map((i,n)=>e.jsx("span",{className:"px-3 py-1 rounded bg-amber-950 text-sm",children:i},n))}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-3xl font-bold",children:a.length}),e.jsx("p",{className:"text-gray-400 text-sm",children:s("groupAbout.stats.members")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-3xl font-bold",children:"—"}),e.jsx("p",{className:"text-gray-400 text-sm",children:s("groupAbout.stats.posts")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-3xl font-bold",children:"—"}),e.jsx("p",{className:"text-gray-400 text-sm",children:s("groupAbout.stats.events")})]})]}),e.jsx("div",{className:"max-h-64 overflow-y-auto border border-amber-700 rounded p-3 bg-amber-900 scrollbar-custom",children:a.length===0?e.jsx("p",{className:"text-gray-400 text-center",children:s("groupAbout.noMembers")}):e.jsx("ul",{className:"space-y-3",children:a.map(i=>{var n,o;return e.jsxs("li",{className:"flex items-center justify-between bg-gradient-to-r from-amber-950 rounded-2xl p-2 min-h-22 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-grow min-w-0",children:[e.jsx(q,{avatar_url:((n=i.profiles)==null?void 0:n.avatar_url)||"",className:"!w-15 !h-15 rounded-full flex-shrink-0"}),e.jsxs("div",{className:"flex flex-col text-gray-300 truncate",children:[e.jsx("span",{className:"font-semibold truncate",children:((o=i.profiles)==null?void 0:o.username)||"Unknown"}),e.jsx("p",{className:"text-sm truncate",children:i.role?s(`groupMembersList.role.${i.role.toLowerCase()}`,{defaultValue:i.role}):i.role}),i.roles_in_group&&i.roles_in_group.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:i.roles_in_group.map((d,c)=>e.jsx("span",{className:"bg-emerald-800 text-white text-xs px-2 py-0.5 rounded-full",children:d},c))})]})]}),e.jsx("div",{className:"hidden md:flex flex-col items-end text-gray-300 text-xs min-w-[100px]",children:e.jsx("span",{children:i.joined_at?s("groupAbout.joined",{days:Xe(new Date(i.joined_at),{addSuffix:!0,locale:l})}):s("groupAbout.joinedNA")})})]},i.profile_id)})})})]})},Be=({groupId:t,CanManageGroup:a})=>(ne(),e.jsx("div",{children:a&&e.jsx(Te,{to:{pathname:"/create-post",state:{groupId:t}},label:"create post",color:"amber"})})),Ue=(t,a)=>{if(t.el.classList.contains("fc-day-other"))return;const s=t.date.toISOString().split("T")[0],r=a.filter(l=>l.start.startsWith(s));if(t.el.classList.remove("event-gig","event-rehearsal","event-meeting","event-other"),r.length>0){const l=new Set(r.map(i=>i.extendedProps.type));l.has("gig")?t.el.classList.add("event-gig"):l.has("rehearsal")?t.el.classList.add("event-rehearsal"):l.has("meeting")?t.el.classList.add("event-meeting"):t.el.classList.add("event-other")}},Je=t=>{const a=t.el;if(!a||!t.view.type.startsWith("list"))return;a.classList.remove("event-gig","event-rehearsal","event-meeting","event-other");const s=t.event.extendedProps.type;s==="gig"?a.classList.add("event-gig"):s==="rehearsal"?a.classList.add("event-rehearsal"):s==="meeting"?a.classList.add("event-meeting"):a.classList.add("event-other")},Qe=({event:t,onClick:a})=>{const{t:s,i18n:r}=N("groupEvents"),i={en:T,es:J}[r.language]||T,n=typeof t.start_time=="string"?new Date(t.start_time):t.start_time,o=F(n,"PPPPp",{locale:i}),d=F(n,"Pp",{locale:i}),x={gig:"text-sky-600",rehearsal:"text-amber-600",meeting:"text-emerald-600"}[t.type]||"text-gray-400";return e.jsxs("div",{onClick:()=>a==null?void 0:a(t),className:"bg-gray-800 hover:bg-gray-700 transition-colors duration-150 rounded-xl p-4 mb-3 shadow-md cursor-pointer",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:`text-sm ${x} font-semibold uppercase`,children:s(`types.${t.type}`)}),e.jsx("span",{className:"hidden sm:inline text-xs text-gray-400",children:o}),e.jsx("span",{className:"inline sm:hidden text-xs text-gray-400",children:d})]}),e.jsx("h3",{className:"text-lg font-bold text-white mb-1",children:t.title}),t.location&&e.jsx("p",{className:"text-sm text-gray-300",children:t.location})]})};var R={exports:{}},Ke=R.exports,se;function Ze(){return se||(se=1,function(t,a){(function(s,r){t.exports=r(xe())})(Ke,function(s){function r(n){return n&&typeof n=="object"&&"default"in n?n:{default:n}}var l=r(s),i={name:"es",monthsShort:"ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),weekdays:"domingo_lunes_martes_miércoles_jueves_viernes_sábado".split("_"),weekdaysShort:"dom._lun._mar._mié._jue._vie._sáb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_sá".split("_"),months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),weekStart:1,formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un día",dd:"%d días",M:"un mes",MM:"%d meses",y:"un año",yy:"%d años"},ordinal:function(n){return n+"º"}};return l.default.locale(i,null,!0),i})}(R)),R.exports}Ze();var H={exports:{}},et=H.exports,ae;function tt(){return ae||(ae=1,function(t,a){(function(s,r){t.exports=r()})(et,function(){return{name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(s){var r=["th","st","nd","rd"],l=s%100;return"["+s+(r[(l-20)%10]||r[l]||r[0])+"]"}}})}(H)),H.exports}tt();const re={title:"",type:"rehearsal",start_time:null,end_time:null,location:"",description:""},ce=({groupId:t,onClose:a,initialEvent:s=null,mode:r="create"})=>{var C,P,G,A,I;const{user:l}=E(),i=r==="edit",{t:n,i18n:o}=N("groupEvents",{keyPrefix:"form"}),d=o.language==="es"?"es":"en",{createEvent:c,updateEvent:x}=B(),{register:h,handleSubmit:m,setValue:p,watch:g,reset:f,formState:{errors:j,isSubmitting:w}}=fe({defaultValues:re}),b=g("start_time"),L=g("end_time");v.useEffect(()=>{f(s?{title:s.title||"",type:s.type||"rehearsal",start_time:Y(s.start_time),end_time:Y(s.end_time),location:s.location||"",description:s.description||""}:re)},[s,f]);const z=async y=>{var S,u;try{const k={...y,start_time:(S=y.start_time)==null?void 0:S.toISOString(),end_time:(u=y.end_time)==null?void 0:u.toISOString(),created_by:l.id};i&&(s!=null&&s.id)?await x({eventId:s.id,updates:k}):await c({profile_group_id:t,...k}),a()}catch{alert(n("error_saving_event"))}};return e.jsx("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-40 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md max-h-full overflow-y-auto p-8 text-gray-900 relative",style:{minHeight:"400px"},children:[e.jsx("button",{onClick:a,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700 transition","aria-label":n("close"),type:"button",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 cursor-pointer",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h2",{className:"text-3xl text-yellow-600 font-semibold mb-6 text-center",children:n(i?"titles.edit_event":"titles.create_event")}),e.jsxs("form",{onSubmit:m(z),className:"space-y-6",children:[e.jsx(ee,{id:"title",label:n("labels.title"),maxLength:12,placeholder:n("placeholders.title"),register:h,validation:{required:n("validations.title")},error:(C=j.title)==null?void 0:C.message,className:"text-gray-900",classForLabel:"!text-gray-700"}),e.jsx(ie,{id:"type",label:n("labels.type"),defaultOption:n("placeholders.type"),options:[{value:"rehearsal",label:n("types.rehearsal")},{value:"gig",label:n("types.gig")},{value:"meeting",label:n("types.meeting")}],register:h,error:(P=j.type)==null?void 0:P.message,className:"bg-white text-gray-900 placeholder-gray-400 focus:bg-white focus:text-gray-900",classForLabel:"!text-gray-700"}),e.jsx(he,{dateAdapter:ge,adapterLocale:d,children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"custom-datetime",children:[e.jsx("label",{htmlFor:"start_time",className:"block text-sm font-bold mb-2 text-gray-700",children:n("labels.start_time")}),e.jsx(Z,{className:"MuiCustomDateTimePicker",value:b,onChange:(y,S)=>{(y===null||Y.isDayjs(y))&&p("start_time",y)},slotProps:{textField:{id:"start_time",fullWidth:!0,error:!!j.start_time,helperText:(G=j.start_time)==null?void 0:G.message,size:"small",variant:"outlined"}}})]}),e.jsxs("div",{className:"custom-datetime",children:[e.jsx("label",{htmlFor:"end_time",className:"block text-sm font-bold mb-2 text-gray-700",children:n("labels.end_time")}),e.jsx(Z,{className:"MuiCustomDateTimePicker",value:L,onChange:(y,S)=>{(y===null||Y.isDayjs(y))&&p("end_time",y)},slotProps:{textField:{id:"end_time",fullWidth:!0,error:!!j.end_time,helperText:(A=j.end_time)==null?void 0:A.message,size:"small",variant:"outlined"}}})]})]})}),e.jsx(ee,{id:"location",label:n("labels.location"),placeholder:n("placeholders.location"),register:h,error:(I=j.location)==null?void 0:I.message,className:"text-gray-900",classForLabel:"!text-gray-700"}),e.jsx(je,{id:"description",label:n("labels.description"),placeholder:n("placeholders.description"),maxLength:200,register:h,error:j.description,watchValue:"",className:"text-gray-900",classForLabel:"!text-gray-700"}),e.jsxs("div",{className:"pt-4 flex justify-end space-x-4",children:[e.jsx(M,{className:"!bg-gray-600 hover:!bg-gray-700 text-white",type:"button",onClick:a,children:n("buttons.cancel")}),e.jsx(M,{type:"submit",disabled:w,className:"!bg-emerald-600 hover:!bg-emerald-700 text-white",children:n(w?"buttons.saving":i?"buttons.save":"buttons.create")})]})]})]})})},st=({eventId:t,userId:a,currentStatus:s})=>{const{t:r}=N("groupEvents"),[l,i]=v.useState(s||"pending"),{upsertRsvp:n}=oe(),o=async x=>{const h=x.target.value;i(h);try{await n({event_id:t,profile_id:a,status:h})}catch{alert(r("error_updating_rsvp")),i(s||"pending")}},d=x=>{typeof x!="string"&&o(x)},c=[{value:"attending",label:r("rsvp.attending")},{value:"not_attending",label:r("rsvp.not_attending")},{value:"pending",label:r("rsvp.pending")}];return e.jsx("div",{className:"mb-4",children:e.jsx(ie,{id:"rsvp",label:r("your_rsvp"),onChange:d,options:c,classForLabel:"uppercase",className:"sm:!w-1/3"})})},at=()=>{const t="#a1a1aa",a="#e4e4e7";return e.jsxs($e.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2},className:"absolute z-50 p-4 rounded-lg shadow-md bg-neutral-100 dark:bg-neutral-900 w-64 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(_,{circle:!0,width:40,height:40,baseColor:t,highlightColor:a}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx(_,{width:80,height:10,baseColor:t,highlightColor:a}),e.jsx(_,{width:100,height:8,baseColor:t,highlightColor:a})]})]}),e.jsxs("div",{className:"space-y-1 mb-3",children:[e.jsx(_,{height:8,width:"100%",baseColor:t,highlightColor:a}),e.jsx(_,{height:8,width:"90%",baseColor:t,highlightColor:a}),e.jsx(_,{height:8,width:"80%",baseColor:t,highlightColor:a}),e.jsx(_,{height:8,width:"70%",baseColor:t,highlightColor:a})]}),e.jsxs("div",{className:"flex justify-end items-center gap-5 pt-2",children:[e.jsx(_,{width:30,height:30,baseColor:t,highlightColor:a}),e.jsx(_,{width:30,height:30,baseColor:t,highlightColor:a}),e.jsx(_,{width:30,height:30,baseColor:t,highlightColor:a})]})]})},rt=({rsvps:t})=>{const{t:a}=N("groupEvents"),{profilesMap:s}=be(),r=t.map(d=>d.profile_id),{data:l,isLoading:i}=s(r),n={attending:[],not_attending:[],pending:[]};t.forEach(d=>{n[d.status].push(d)});const o=d=>{const c=l==null?void 0:l[d.profile_id];return e.jsx("div",{className:"flex items-center justify-center space-x-3",children:i||!c?e.jsx(at,{}):e.jsxs(e.Fragment,{children:[e.jsx(q,{avatar_url:c.avatar_url,alt:c.username,gender:c.gender,className:"!w-11 !h-11"}),e.jsx("span",{className:"text-sm text-gray-200",children:c.username})]})},d.profile_id)};return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mt-6",children:[{label:a("attending"),key:"attending",color:"text-emerald-400"},{label:a("not_attending"),key:"not_attending",color:"text-rose-400"},{label:a("pending"),key:"pending",color:"text-yellow-400"}].map(({label:d,key:c,color:x})=>e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 shadow-sm space-y-3",children:[e.jsx("h4",{className:`text-sm text-center font-semibold uppercase ${x}`,children:d}),e.jsx("div",{className:"space-y-2",children:n[c].length>0?n[c].map(o):e.jsx("p",{className:"text-xs text-center text-gray-400 italic",children:a("none")})})]},c))})},nt=({event:t,onClose:a,isAdminOrManager:s})=>{var w;const{t:r,i18n:l}=N("groupEvents"),{user:i}=E(),{fetchEventRsvps:n}=oe(),{data:o,isLoading:d,error:c}=n(t.id),{deleteEvent:x}=B(),[h,m]=v.useState(!1);if(!t)return null;const p=async()=>{try{await x(t),a()}catch(b){alert(r("error_deleting_event")),console.error(b)}},g=l.language==="es"?J:T,f=F(new Date(t.start_time),"PPPPp",{locale:g}),j=F(new Date(t.end_time),"PPPPp",{locale:g});return e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-50",children:[e.jsxs("div",{className:"bg-gray-900 text-white rounded-lg shadow-xl w-full max-w-3xl max-h-[90vh] overflow-y-auto p-6 relative",children:[e.jsx("button",{onClick:a,className:"absolute top-4 right-4 text-rose-600 cursor-pointer font-bold text-2xl","aria-label":r("close"),children:"×"}),e.jsx("h3",{className:"text-3xl font-bold text-white mb-3 text-center",children:t.title}),e.jsx("div",{className:"text-center text-sm mb-6",children:e.jsx("span",{className:`inline-block px-3 py-1 rounded-full font-medium ${t.type==="gig"?"bg-sky-700 text-sky-200":t.type==="rehearsal"?"bg-amber-700 text-amber-200":t.type==="meeting"?"bg-emerald-700 text-emerald-200":"bg-gray-700 text-gray-200"}`,children:r(`types.${t.type}`)})}),e.jsxs("div",{className:"grid text-center grid-cols-1 md:grid-cols-3 gap-4 text-sm mb-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 underline",children:r("location")}),e.jsx("p",{className:"text-white",children:t.location||r("no_location")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 underline",children:r("start")}),e.jsx("p",{className:"text-white",children:f})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 underline",children:r("end")}),e.jsx("p",{className:"text-white",children:j})]})]}),t.description&&e.jsxs("div",{className:"mt-4 pt-4 border-t text-center border-gray-700",children:[e.jsx("h4",{className:"text-sm font-semibold underline text-gray-400 mb-1",children:r("description")}),e.jsx("p",{className:"text-gray-300 whitespace-pre-wrap",children:t.description})]}),d&&e.jsx(U,{}),c&&e.jsx(W,{error:c.message}),o&&e.jsxs("div",{className:"space-y-6 mt-10",children:[e.jsx(st,{eventId:t.id,userId:i.id,currentStatus:(w=o.find(b=>b.profile_id===i.id))==null?void 0:w.status}),e.jsx(rt,{rsvps:o})]}),s&&e.jsxs("div",{className:"mt-6 flex gap-4 justify-center flex-wrap",children:[e.jsx(M,{className:"bg-yellow-600 hover:bg-yellow-700",onClick:()=>m(!0),children:r("edit")}),e.jsx(M,{className:"!bg-red-600 hover:!bg-red-700",onClick:p,children:r("delete")})]})]}),h&&e.jsx(ce,{groupId:t.profile_group_id,initialEvent:t,mode:"edit",onClose:()=>m(!1)})]})},lt=({calendarApi:t,title:a})=>t?e.jsxs("div",{className:"mb-4 select-none",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("button",{onClick:()=>t.prev(),className:"px-3 py-1 cursor-pointer text-slate-400 rounded hover:text-slate-300",type:"button","aria-label":"Previous",children:"Prev"}),e.jsx("div",{className:"font-semibold text-sm sm:text-lg text-white",children:a}),e.jsx("button",{onClick:()=>t.next(),className:"px-3 py-1 cursor-pointer text-slate-400 rounded hover:text-slate-300",type:"button","aria-label":"Next",children:"Next"})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{onClick:()=>t.today(),className:"px-4 py-1 cursor-pointer w-full text-slate-400 rounded hover:text-slate-300",type:"button","aria-label":"Today",children:"Today"})})]}):null,it=({calendarApi:t,currentView:a,setCurrentView:s})=>{if(!t)return null;const r=l=>{t.changeView(l),s(l)};return e.jsxs("div",{className:"flex gap-2 justify-center sm:justify-end mt-2",children:[e.jsx("button",{onClick:()=>r("dayGridMonth"),className:`px-3 py-1 rounded cursor-pointer hidden sm:inline-block ${a==="dayGridMonth"?"bg-slate-600 text-white":"!bg-transparent text-gray-300"}`,children:"Month"}),e.jsx("button",{onClick:()=>r("listWeek"),className:`px-3 py-1 rounded cursor-pointer ${a==="listWeek"?"bg-slate-600 text-white":"bg-transparent text-gray-300"}`,children:"List"})]})},ot=({event:t,view:a})=>{const s=t.start,r=t.end,l=n=>F(n,"HH:mm"),i=r?`${l(s)} - ${l(r)}`:l(s);return a.type.startsWith("list")?e.jsxs("div",{className:"text-white hover:!bg-transparent !flex !flex-col",children:[e.jsx("strong",{className:"truncate",children:t.title}),e.jsx("span",{className:"text-xs mt-0.5",children:i})]}):e.jsxs("div",{className:"m-auto text-center hover:!bg-transparent",children:[e.jsx("strong",{children:t.title}),e.jsx("div",{className:"text-xs text-gray-300 mt-0.5",children:i})]})},ct=({groupId:t,isAdminOrManager:a=!1,isMember:s})=>{var y,S;const{t:r,i18n:l}=N("groupEvents"),{fetchGroupEvents:i}=B(),{data:n,isLoading:o,error:d,refetch:c}=i(t),[x,h]=v.useState(!1),[m,p]=v.useState(null),[g,f]=v.useState(null),[j,w]=v.useState("dayGridMonth"),b=v.useRef(null),[L,z]=v.useState(""),C=v.useMemo(()=>n?n.map(u=>({id:u.id,title:u.title,start:u.start_time,end:u.end_time,extendedProps:{description:u.description,location:u.location,type:u.type,fullEvent:u}})):[],[n]),P=v.useMemo(()=>n?[...n].sort((u,k)=>new Date(u.start_time).getTime()-new Date(k.start_time).getTime()):[],[n]),G=u=>{a&&(p(u.dateStr),f(null),h(!0))},A=u=>{f(u.event.extendedProps.fullEvent),p(null),h(!1)},I=()=>{if(!b.current)return;const u=b.current.getApi();z(u.view.title)};return o?e.jsx(U,{}):d?e.jsx(W,{error:d.message}):e.jsxs("div",{className:"bg-gray-900 text-white p-4 rounded-lg shadow-md w-full space-y-6",children:[e.jsx("h2",{className:"text-2xl rounded-t-md bg-gradient-to-r from-gray-800 py-4 font-bold text-amber-600 text-center",children:r("calendar.title")}),e.jsx(lt,{calendarApi:(y=b.current)==null?void 0:y.getApi(),title:L}),e.jsx(it,{calendarApi:(S=b.current)==null?void 0:S.getApi(),currentView:j,setCurrentView:w}),e.jsx(Fe,{ref:b,plugins:[Ee,Ge,Ae,Ie],initialView:"dayGridMonth",headerToolbar:!1,views:{dayGridMonth:{buttonText:"Month"},listWeek:{buttonText:"List"}},height:"auto",events:C,eventClick:A,dateClick:G,eventTimeFormat:{hour:"2-digit",minute:"2-digit",hour12:!1},locale:l.language,windowResize:()=>{const u=b.current.getApi();window.innerWidth<640?(u.changeView("listWeek"),w("listWeek")):(u.changeView("dayGridMonth"),w("dayGridMonth"))},datesSet:I,eventContent:({event:u,view:k})=>e.jsx(ot,{event:u,view:k}),dayCellDidMount:u=>Ue(u,C),eventDidMount:u=>{Je(u)}}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-white mt-8 mb-4",children:r("calendar.event_list")}),P.length===0?e.jsx("p",{className:"text-gray-400",children:r("calendar.no_events")}):e.jsx("div",{className:"space-y-3",children:P.map(u=>e.jsx(Qe,{event:u,onClick:()=>f(u)},u.id))})]}),x&&e.jsx(ce,{groupId:t,onClose:()=>{h(!1),f(null),p(null),c()},mode:"create",initialEvent:g??(m?{start_time:`${m}T12:00`,end_time:`${m}T14:00`,type:"rehearsal"}:void 0)}),g&&e.jsx(nt,{event:g,isAdminOrManager:a,onClose:()=>{f(null),c()}})]})},dt=({groupId:t})=>{const{user:a}=E(),{t:s}=N("profileGroup",{keyPrefix:"followersList"}),{followersInfiniteQuery:r}=le(),{data:l,fetchNextPage:i,hasNextPage:n,isFetchingNextPage:o,isLoading:d,isError:c,error:x}=r(t,10),h=v.useMemo(()=>(l==null?void 0:l.pages.flatMap(m=>m))??[],[l]);return d?e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:Array.from({length:8}).map((m,p)=>e.jsx(Ce,{},p))}):c?e.jsx(W,{error:(x==null?void 0:x.message)??"Unknown error"}):h.length===0?e.jsx("p",{className:"text-gray-400",children:s("connection.messages.noFollowers")}):e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 md:grid-cols-4 mx-auto sm:mx-0 sm:mr-auto gap-4",children:h.map(m=>e.jsx(Pe,{profileId:m.follower_profile_id,ownProfile:!1},m.follow_id))}),n&&e.jsx("button",{onClick:()=>i(),disabled:o,className:"self-center cursor-pointer mt-4 px-4 py-2 rounded bg-amber-950 text-white hover:bg-amber-800",children:s(o?"connection.loadingMore":"connection.loadMore")})]})};function Nt(){const t=ye().groupId,{user:a}=E(),{fetchProfileGroup:s}=ve(),{data:r,isLoading:l,error:i}=s(t??""),{fetchGroupMembers:n}=we(),{data:o,isLoading:d,error:c}=n(t);if(l||d||!Array.isArray(o))return e.jsx(U,{});if(i||c)return e.jsx(W,{error:(i==null?void 0:i.message)||(c==null?void 0:c.message)});if(!r)return e.jsx(te,{to:"/",replace:!0});const h=a&&(o==null?void 0:o.find(f=>f.profile_id===a.id)),m=(h==null?void 0:h.role)==="admin",p=m||(h==null?void 0:h.role)==="manager",g=!!h;return e.jsx("div",{className:"flex flex-col min-h-screen text-white",children:e.jsxs("div",{className:"max-w-5xl mx-auto p-6 space-y-6",children:[e.jsx(Ye,{groupData:r,CanManageGroup:p,isMember:g}),e.jsxs(_e,{children:[e.jsx(D,{index:!0,element:e.jsx(qe,{group:r,members:o})}),e.jsx(D,{path:"posts/*",element:e.jsx(Be,{groupId:t,CanManageGroup:p})}),e.jsx(D,{path:"followers",element:e.jsx(dt,{groupId:t})}),g&&e.jsx(D,{path:"calendar",element:e.jsx(ct,{groupId:t,isAdminOrManager:p,isMember:g})}),m&&e.jsx(D,{path:"edit",element:e.jsx(Ne,{group:r,onSave:()=>window.history.back(),onCancel:()=>window.history.back()})}),e.jsx(D,{path:"*",element:e.jsx(te,{to:"",replace:!0})})]})]})})}export{Nt as default};
