import{j as e,n as v,t as N,f as C,g as L,h as M,i as P,k as _,m as y,l as p}from"./mui-COfzhOQm.js";import{u as k,a as G,h as T,J as O,P as S,B as w,A as X,K as F,M as A,i as H,E as R,w as D,R as Y,g as j,O as $}from"./index-BpP4ZOjQ.js";import{K as B,L as E,N as z}from"./icons-Cu9gFVBg.js";import{c as b,g as K,a as U,e as J}from"./es-DV_BEdDN.js";import"./filepond-C4Y8_Bzv.js";import"./reactPlayer-DGEX9vCu.js";import"./lottie-Qij33HW6.js";import"./gsap-Brfk6Bdo.js";const q=({groupData:n,isAdmin:l})=>{const{t:s}=k("profileGroup",{keyPrefix:"groupHeader"}),{user:i}=G(),t=T(),o=`/group/${n.id}`,r="!bg-amber-950 hover:!bg-gray-900/60 hover:!text-white",{followGroup:a,unfollowGroup:u,checkFollowStatus:d}=O(),{data:f,isLoading:h}=d(n.id,i==null?void 0:i.id),c=!!f,x=async()=>{h||!i||(c?await u({profile_group_id:n.id,follower_profile_id:i.id}):await a({profile_group_id:n.id,follower_profile_id:i.id}))},m=c?"bg-neutral-900 hover:bg-amber-950":"bg-amber-950 hover:bg-gray-900/60",g=s(c?"badges.status.following":"badges.status.follow"),I=c?e.jsx(E,{className:"text-amber-600"}):e.jsx(z,{className:"text-amber-600"});return e.jsxs("div",{className:"relative bg-gradient-to-r md:min-w-2xl lg:min-w-4xl from-amber-950 to-amber-800 mb-4 p-4 rounded-b-lg",children:[e.jsxs("div",{className:"flex flex-col gap-6 sm:flex-row sm:items-center",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-grow",children:[e.jsx(S,{avatar_url:n.avatar_url,className:"flex-shrink-0 !w-24 !h-24"}),e.jsxs("div",{className:"flex flex-col gap-2 flex-grow",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-white break-words",children:n.name}),e.jsx("p",{className:"text-gray-200 break-words",children:n.bio})]})]}),e.jsx("div",{className:"flex gap-4 ml-auto items-center mb-auto",children:l&&e.jsx(B,{className:"w-8 h-8 text-white cursor-pointer",onClick:()=>t(`${o}/settings`),title:s("btnTitles.settings")})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-center md:justify-end mt-6 flex-wrap",children:[!l&&i&&e.jsxs("button",{onClick:x,disabled:h,title:s(c?"btnTitles.unfollow":"btnTitles.follow"),className:`${m} cursor-pointer mr-auto mt-auto w-full justify-center md:w-auto inline-flex items-center gap-1 px-3.5 py-1.5 rounded-full text-sm font-semibold whitespace-nowrap transition`,children:[I,g]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-4",children:e.jsx(w,{className:r,onClick:()=>t(o),children:s("nav.about")})}),e.jsx("div",{className:"sm:mb-4",children:e.jsx(w,{className:r,onClick:()=>t(`${o}/posts`),children:s("nav.posts")})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-4",children:e.jsx(w,{className:r,onClick:()=>t(o),children:s("nav.media")})}),l&&e.jsx("div",{className:"sm:mb-4",children:e.jsx(w,{className:r,onClick:()=>t(`${o}/calendar`),children:s("nav.calendar")})})]})]})]})};function Q(n,l,s){const[i,t]=v(s==null?void 0:s.in,n,l),o=i.getFullYear()-t.getFullYear(),r=i.getMonth()-t.getMonth();return o*12+r}function V(n,l){return+N(n)-+N(l)}function W(n,l){const s=N(n,l==null?void 0:l.in);return+C(s,l)==+L(s,l)}function Z(n,l,s){const[i,t,o]=v(s==null?void 0:s.in,n,n,l),r=b(t,o),a=Math.abs(Q(t,o));if(a<1)return 0;t.getMonth()===1&&t.getDate()>27&&t.setDate(30),t.setMonth(t.getMonth()-r*a);let u=b(t,o)===-r;W(i)&&a===1&&b(i,o)===1&&(u=!1);const d=r*(a-+u);return d===0?0:d}function ee(n,l,s){const i=V(n,l)/1e3;return K(s==null?void 0:s.roundingMethod)(i)}function se(n,l,s){const i=P(),t=(s==null?void 0:s.locale)??i.locale??_,o=2520,r=b(n,l);if(isNaN(r))throw new RangeError("Invalid time value");const a=Object.assign({},s,{addSuffix:s==null?void 0:s.addSuffix,comparison:r}),[u,d]=v(s==null?void 0:s.in,...r>0?[l,n]:[n,l]),f=ee(d,u),h=(M(d)-M(u))/1e3,c=Math.round((f-h)/60);let x;if(c<2)return s!=null&&s.includeSeconds?f<5?t.formatDistance("lessThanXSeconds",5,a):f<10?t.formatDistance("lessThanXSeconds",10,a):f<20?t.formatDistance("lessThanXSeconds",20,a):f<40?t.formatDistance("halfAMinute",0,a):f<60?t.formatDistance("lessThanXMinutes",1,a):t.formatDistance("xMinutes",1,a):c===0?t.formatDistance("lessThanXMinutes",1,a):t.formatDistance("xMinutes",c,a);if(c<45)return t.formatDistance("xMinutes",c,a);if(c<90)return t.formatDistance("aboutXHours",1,a);if(c<y){const m=Math.round(c/60);return t.formatDistance("aboutXHours",m,a)}else{if(c<o)return t.formatDistance("xDays",1,a);if(c<p){const m=Math.round(c/y);return t.formatDistance("xDays",m,a)}else if(c<p*2)return x=Math.round(c/p),t.formatDistance("aboutXMonths",x,a)}if(x=Z(d,u),x<12){const m=Math.round(c/p);return t.formatDistance("xMonths",m,a)}else{const m=x%12,g=Math.trunc(x/12);return m<3?t.formatDistance("aboutXYears",g,a):m<9?t.formatDistance("overXYears",g,a):t.formatDistance("almostXYears",g+1,a)}}function te(n,l){return se(n,U(n),l)}function ae({group:n,members:l}){var o;const{t:s,i18n:i}=k("profileGroup"),t=i.language==="es"?J:_;return e.jsxs("div",{className:"space-y-6",children:[((o=n.genres)==null?void 0:o.length)>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:n.genres.map((r,a)=>e.jsx("span",{className:"px-3 py-1 rounded bg-amber-950 text-sm",children:r},a))}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-3xl font-bold",children:l.length}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Members"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-3xl font-bold",children:"—"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Posts"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-3xl font-bold",children:"—"}),e.jsx("p",{className:"text-gray-400 text-sm",children:"Events"})]})]}),e.jsx("div",{className:"max-h-64 overflow-y-auto border border-amber-700 rounded p-3 bg-amber-900 scrollbar-custom",children:l.length===0?e.jsx("p",{className:"text-gray-400 text-center",children:"No members yet."}):e.jsx("ul",{className:"space-y-3",children:l.map(r=>{var a,u;return e.jsxs("li",{className:"flex items-center justify-between bg-gradient-to-r from-amber-950 rounded-2xl p-2 min-h-22 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-grow min-w-0",children:[e.jsx(S,{avatar_url:((a=r==null?void 0:r.profiles)==null?void 0:a.avatar_url)||"",className:"!w-15 !h-15 rounded-full flex-shrink-0"}),e.jsxs("div",{className:"flex flex-col text-gray-300 truncate",children:[e.jsx("span",{className:"font-semibold truncate",children:((u=r.profiles)==null?void 0:u.username)||"Unknown"}),e.jsx("p",{className:"text-sm truncate",children:s(`groupMembersList.role.${r.role.toLowerCase()}`,r.role)}),r.roles_in_group&&r.roles_in_group.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:r.roles_in_group.map((d,f)=>e.jsx("span",{className:"bg-emerald-800 text-white text-xs px-2 py-0.5 rounded-full",children:d},f))})]})]}),e.jsx("div",{className:"hidden md:flex flex-col items-end text-gray-300 text-xs min-w-[100px]",children:e.jsx("span",{children:r.joined_at?s("groupAbout.joined",{days:te(new Date(r.joined_at),{addSuffix:!0,locale:t})}):s("groupAbout.joinedNA")})})]},r.profile_id)})})})]})}function ne(){return e.jsx("div",{children:"GroupPosts"})}function re(){return e.jsx("div",{children:"GroupCalendar"})}function me(){const{groupId:n}=X(),{user:l}=G(),{fetchProfileGroup:s}=F(),{data:i,isLoading:t,error:o}=s(n),{fetchGroupMembers:r}=A(),{data:a,isLoading:u,error:d}=r(n);if(t||u)return e.jsx(H,{});if(o||d)return e.jsx(R,{error:(o==null?void 0:o.message)||(d==null?void 0:d.message)});if(!i)return e.jsx(D,{to:"/",replace:!0});const f=a==null?void 0:a.find(x=>x.profile_id===l.id),h=(f==null?void 0:f.role)==="admin",c=!!f;return e.jsx("div",{className:"flex flex-col min-h-screen text-white",children:e.jsxs("div",{className:"max-w-5xl mx-auto p-6 space-y-6",children:[e.jsx(q,{groupData:i,isAdmin:h}),e.jsxs(Y,{children:[e.jsx(j,{index:!0,element:e.jsx(ae,{group:i,members:a})}),e.jsx(j,{path:"posts/*",element:e.jsx(ne,{groupId:n,isMember:c})}),h&&e.jsxs(e.Fragment,{children:[e.jsx(j,{path:"calendar",element:e.jsx(re,{groupId:n})}),e.jsx(j,{path:"edit",element:e.jsx($,{group:i,onSave:()=>window.history.back(),onCancel:()=>window.history.back()})})]}),e.jsx(j,{path:"*",element:e.jsx(D,{to:"",replace:!0})})]})]})})}export{me as default};
