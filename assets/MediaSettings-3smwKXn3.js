import{j as e}from"./mui-DntPDMdt.js";import{r as L}from"./calendar-DXWKnWXk.js";import{a as E,M,j as _,u as P,O as R,c as T,k as V,E as A,I as b,S as B,B as x}from"./index-BXZZvcoM.js";import{R as D}from"./reactPlayer-CBmCIXQE.js";import{i as U,g as $}from"./mediaValidation-PPsI62XD.js";import"./icons-DoyJ_9a6.js";import"./lottie-FCmafNqs.js";import"./gsap-CH_iu5NA.js";import"./filepond-DvarZm2e.js";const C=[{value:"youtube",label:"YouTube"},{value:"spotify",label:"Spotify"},{value:"soundcloud",label:"SoundCloud"},{value:"vimeo",label:"Vimeo"},{value:"file",label:"Direct Audio/Video URL"}],K=()=>{const{user:a}=E(),{id:s}=M(),m=_(),{t:i}=P("music"),{getMediaLink:h,insertMediaLink:y,updateMediaLink:j}=R(),t=!!s,{register:n,handleSubmit:v,reset:c,watch:u,control:w,formState:{errors:p},setValue:l}=T(),{data:r,isLoading:N,error:f}=h(s??""),o=u("url"),d=u("media_type");L.useEffect(()=>{t&&r?(l("url",r.url??""),l("title",r.title??""),l("media_type",r.media_type??"")):c()},[s,r,t,l,c]);const S=async g=>{if(a!=null&&a.id)try{t?await j({id:s??"",updatedLink:{...g,profile_id:a.id}}):await y({...g,profile_id:a.id}),m(`/profile/${a.id}/media`)}catch(k){console.error(k.message)}};return!(a!=null&&a.id)||t&&N?e.jsx(V,{}):f?e.jsx(A,{error:f.message}):e.jsxs("section",{className:"bg-gradient-to-l to-gray-900 p-6 rounded-b-lg shadow-lg max-w-4xl mx-auto",children:[e.jsxs("div",{className:"text-center font-semibold mb-6",children:[e.jsx("h2",{className:"text-3xl text-yellow-500 font-bold mb-2",children:i(t?"media.titleEdit":"media.titleAdd")}),e.jsx("p",{className:"text-gray-400 text-sm",children:i(t?"media.form.editDescription":"media.form.addDescription")})]}),e.jsxs("form",{onSubmit:v(S),className:"space-y-4",children:[e.jsx(b,{id:"title",label:i("media.form.title"),placeholder:i("media.form.titlePlaceholder"),maxLength:30,register:n,error:p.title}),e.jsx(B,{id:"media_type",label:i("media.form.type"),options:C,control:w}),e.jsx(b,{id:"url",label:i("media.form.url"),placeholder:i("media.form.urlPlaceholder"),register:n,error:p.url}),U(o,d)&&e.jsx("div",{className:"rounded-lg border border-gray-700 p-3 bg-black/20 mt-2",children:d==="spotify"?e.jsx("div",{className:"rounded-lg bg-[#1db954] p-1 w-full flex flex-col items-center",children:e.jsx("iframe",{src:$(o)||void 0,width:"100%",height:"80",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy"})}):e.jsx("div",{className:"aspect-video bg-black rounded overflow-hidden",children:e.jsx(D,{url:o,controls:!0,width:"100%",height:"100%"})})},`${d}-${o}`),e.jsxs("div",{className:"flex justify-center mt-16 gap-4",children:[e.jsx(x,{type:"submit",className:"!bg-emerald-600 hover:!bg-emerald-700",children:i(t?"media.form.update":"media.form.add")}),t&&e.jsx(x,{type:"button",onClick:()=>m(-1),className:"!bg-gray-600 hover:!bg-gray-700",children:i("media.form.cancel")})]})]})]})};export{K as default};
