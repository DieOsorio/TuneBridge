import{j as e,n as z,t as W,e as de,f as me,g as U,h as ue,i as C,m as K,k as $,l as P,o as xe,p as Q,L as he,q as ge,s as Z}from"./mui-O-_7DbpJ.js";import{u as _,a as E,h as pe,J as le,P as X,L as fe,B as w,K as V,c as be,I as ee,S as ie,T as je,M as oe,b as ye,i as q,E as R,A as ve,O as _e,Q as we,w as te,R as Ne,g as M,U as Me}from"./index-Cf-eeQSk.js";import{K as Se,L as ke,N as Le}from"./icons-D__VgVoR.js";import{c as I,g as De,a as Ce,e as B,C as Pe,b as Ee}from"./ConnectionCard-HIXxKp0g.js";import{P as Te}from"./PlusButton-BGz8RCtX.js";import{r as y,F as Fe,i as Ge,j as Ae,k as $e,l as Ie}from"./calendar-BpW-aEGs.js";import{S as se}from"./index-CpFbDMuT.js";/* empty css                 */import"./reactPlayer-D7fnNHFf.js";import"./lottie-DTlWc_fK.js";import"./gsap-Brfk6Bdo.js";import"./filepond-DcLflJls.js";const Ye=({groupData:t,CanManageGroup:l,isMember:s})=>{const{t:n}=_("profileGroup",{keyPrefix:"groupHeader"}),{user:r}=E(),i=pe(),a=`/group/${t.id}`,o="!bg-amber-950 hover:!bg-gray-900/60 hover:!text-white",{followGroup:c,unfollowGroup:d,checkFollowStatus:g,countFollowers:h}=le(),{data:u,isLoading:p}=g(t.id,r==null?void 0:r.id),{data:x}=h(t.id),f=!!u,b=async()=>{p||!r||(f?await d({profile_group_id:t.id,follower_profile_id:r.id}):await c({profile_group_id:t.id,follower_profile_id:r.id}))},j=f?"bg-neutral-900 hover:bg-amber-950":"bg-amber-950 hover:bg-gray-900/60",v=n(f?"badges.status.following":"badges.status.follow"),S=f?e.jsx(ke,{className:"text-amber-600"}):e.jsx(Le,{className:"text-amber-600"});return e.jsxs("div",{className:"relative bg-gradient-to-r md:min-w-2xl lg:min-w-4xl from-amber-950 to-amber-800 mb-4 p-4 rounded-b-lg",children:[e.jsxs("div",{className:"flex flex-col gap-6 sm:flex-row sm:items-center",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-grow",children:[e.jsx(X,{avatar_url:t.avatar_url,className:"flex-shrink-0 !w-24 !h-24"}),e.jsxs("div",{className:"flex flex-col gap-2 flex-grow",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-white break-words",children:t.name}),e.jsx("p",{className:"text-gray-200 break-words",children:t.bio})]})]}),e.jsx("div",{className:"flex gap-4 ml-auto items-center mb-auto",children:l&&e.jsx(Se,{className:"w-8 h-8 text-white cursor-pointer",onClick:()=>i(`${a}/settings`),title:n("btnTitles.settings")})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-center md:justify-end mt-6 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-3 sm:mr-auto mt-auto",children:[!l&&r&&e.jsxs("button",{onClick:b,disabled:p,title:n(f?"btnTitles.unfollow":"btnTitles.follow"),className:`${j} cursor-pointer inline-flex items-center gap-1 px-3.5 py-1.5 rounded-full text-sm font-semibold whitespace-nowrap transition`,children:[S,v]}),x!==void 0&&typeof x=="number"&&e.jsx(fe,{to:`${a}/followers`,className:"text-sm font-medium text-gray-300 hover:underline",title:n("followersCount",{count:x}),children:n("followersCount",{count:x})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-4",children:e.jsx(w,{className:o,onClick:()=>i(a),children:n("nav.about")})}),e.jsx("div",{className:"sm:mb-4",children:e.jsx(w,{className:o,onClick:()=>i(`${a}/posts`),children:n("nav.posts")})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-4",children:e.jsx(w,{className:o,onClick:()=>i(a),children:n("nav.media")})}),s&&e.jsx("div",{className:"sm:mb-4",children:e.jsx(w,{className:o,onClick:()=>i(`${a}/calendar`),children:n("nav.calendar")})})]})]})]})};function Oe(t,l,s){const[n,r]=z(s==null?void 0:s.in,t,l),i=n.getFullYear()-r.getFullYear(),a=n.getMonth()-r.getMonth();return i*12+a}function Re(t,l){return+W(t)-+W(l)}function He(t,l){const s=W(t,l==null?void 0:l.in);return+de(s,l)==+me(s,l)}function We(t,l,s){const[n,r,i]=z(s==null?void 0:s.in,t,t,l),a=I(r,i),o=Math.abs(Oe(r,i));if(o<1)return 0;r.getMonth()===1&&r.getDate()>27&&r.setDate(30),r.setMonth(r.getMonth()-a*o);let c=I(r,i)===-a;He(n)&&o===1&&I(n,i)===1&&(c=!1);const d=a*(o-+c);return d===0?0:d}function ze(t,l,s){const n=Re(t,l)/1e3;return De(s==null?void 0:s.roundingMethod)(n)}function Xe(t,l,s){const n=ue(),r=(s==null?void 0:s.locale)??n.locale??C,i=2520,a=I(t,l);if(isNaN(a))throw new RangeError("Invalid time value");const o=Object.assign({},s,{addSuffix:s==null?void 0:s.addSuffix,comparison:a}),[c,d]=z(s==null?void 0:s.in,...a>0?[l,t]:[t,l]),g=ze(d,c),h=(U(d)-U(c))/1e3,u=Math.round((g-h)/60);let p;if(u<2)return s!=null&&s.includeSeconds?g<5?r.formatDistance("lessThanXSeconds",5,o):g<10?r.formatDistance("lessThanXSeconds",10,o):g<20?r.formatDistance("lessThanXSeconds",20,o):g<40?r.formatDistance("halfAMinute",0,o):g<60?r.formatDistance("lessThanXMinutes",1,o):r.formatDistance("xMinutes",1,o):u===0?r.formatDistance("lessThanXMinutes",1,o):r.formatDistance("xMinutes",u,o);if(u<45)return r.formatDistance("xMinutes",u,o);if(u<90)return r.formatDistance("aboutXHours",1,o);if(u<K){const x=Math.round(u/60);return r.formatDistance("aboutXHours",x,o)}else{if(u<i)return r.formatDistance("xDays",1,o);if(u<$){const x=Math.round(u/K);return r.formatDistance("xDays",x,o)}else if(u<$*2)return p=Math.round(u/$),r.formatDistance("aboutXMonths",p,o)}if(p=We(d,c),p<12){const x=Math.round(u/$);return r.formatDistance("xMonths",x,o)}else{const x=p%12,f=Math.trunc(p/12);return x<3?r.formatDistance("aboutXYears",f,o):x<9?r.formatDistance("overXYears",f,o):r.formatDistance("almostXYears",f+1,o)}}function Ve(t,l){return Xe(t,Ce(t),l)}function qe({group:t,members:l}){var i;const{t:s,i18n:n}=_("profileGroup"),r=n.language==="es"?B:C;return e.jsxs("div",{className:"space-y-6",children:[((i=t.genres)==null?void 0:i.length)>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:t.genres.map((a,o)=>e.jsx("span",{className:"px-3 py-1 rounded bg-amber-950 text-sm",children:a},o))}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-3xl font-bold",children:l.length}),e.jsx("p",{className:"text-gray-400 text-sm",children:s("groupAbout.stats.members")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-3xl font-bold",children:"—"}),e.jsx("p",{className:"text-gray-400 text-sm",children:s("groupAbout.stats.posts")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-3xl font-bold",children:"—"}),e.jsx("p",{className:"text-gray-400 text-sm",children:s("groupAbout.stats.events")})]})]}),e.jsx("div",{className:"max-h-64 overflow-y-auto border border-amber-700 rounded p-3 bg-amber-900 scrollbar-custom",children:l.length===0?e.jsx("p",{className:"text-gray-400 text-center",children:s("groupAbout.noMembers")}):e.jsx("ul",{className:"space-y-3",children:l.map(a=>{var o,c;return e.jsxs("li",{className:"flex items-center justify-between bg-gradient-to-r from-amber-950 rounded-2xl p-2 min-h-22 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-grow min-w-0",children:[e.jsx(X,{avatar_url:((o=a==null?void 0:a.profiles)==null?void 0:o.avatar_url)||"",className:"!w-15 !h-15 rounded-full flex-shrink-0"}),e.jsxs("div",{className:"flex flex-col text-gray-300 truncate",children:[e.jsx("span",{className:"font-semibold truncate",children:((c=a.profiles)==null?void 0:c.username)||"Unknown"}),e.jsx("p",{className:"text-sm truncate",children:s(`groupMembersList.role.${a.role.toLowerCase()}`,a.role)}),a.roles_in_group&&a.roles_in_group.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:a.roles_in_group.map((d,g)=>e.jsx("span",{className:"bg-emerald-800 text-white text-xs px-2 py-0.5 rounded-full",children:d},g))})]})]}),e.jsx("div",{className:"hidden md:flex flex-col items-end text-gray-300 text-xs min-w-[100px]",children:e.jsx("span",{children:a.joined_at?s("groupAbout.joined",{days:Ve(new Date(a.joined_at),{addSuffix:!0,locale:r})}):s("groupAbout.joinedNA")})})]},a.profile_id)})})})]})}function Be({groupId:t,CanManageGroup:l}){return e.jsx("div",{children:l&&e.jsx(Te,{to:{pathname:"/create-post",state:{groupId:t}},label:"create post",color:"amber"})})}const Je=(t,l)=>{if(t.el.classList.contains("fc-day-other"))return;const s=t.date.toISOString().split("T")[0],n=l.filter(r=>r.start.startsWith(s));if(t.el.classList.remove("event-gig","event-rehearsal","event-meeting","event-other"),n.length>0){const r=new Set(n.map(i=>i.extendedProps.type));r.has("gig")?t.el.classList.add("event-gig"):r.has("rehearsal")?t.el.classList.add("event-rehearsal"):r.has("meeting")?t.el.classList.add("event-meeting"):t.el.classList.add("event-other")}},Ue=t=>{const l=t.el;if(!l||!t.view.type.startsWith("list"))return;l.classList.remove("event-gig","event-rehearsal","event-meeting","event-other");const s=t.event.extendedProps.type;s==="gig"?l.classList.add("event-gig"):s==="rehearsal"?l.classList.add("event-rehearsal"):s==="meeting"?l.classList.add("event-meeting"):l.classList.add("event-other")},Ke=({event:t,onClick:l})=>{const{t:s,i18n:n}=_("groupEvents"),i={en:C,es:B}[n.language]||C,a=P(new Date(t.start_time),"PPPPp",{locale:i}),o=P(new Date(t.start_time),"Pp",{locale:i}),d={gig:"text-sky-600",rehearsal:"text-amber-600",meeting:"text-emerald-600"}[t.type]||"text-gray-400";return e.jsxs("div",{onClick:()=>l==null?void 0:l(t),className:"bg-gray-800 hover:bg-gray-700 transition-colors duration-150 rounded-xl p-4 mb-3 shadow-md cursor-pointer",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:`text-sm ${d} font-semibold uppercase`,children:s(`types.${t.type}`)}),e.jsx("span",{className:"hidden sm:inline text-xs text-gray-400",children:a}),e.jsx("span",{className:"inline sm:hidden text-xs text-gray-400",children:o})]}),e.jsx("h3",{className:"text-lg font-bold text-white mb-1",children:t.title}),t.location&&e.jsx("p",{className:"text-sm text-gray-300",children:t.location})]})};var Y={exports:{}},Qe=Y.exports,ae;function Ze(){return ae||(ae=1,function(t,l){(function(s,n){t.exports=n(xe())})(Qe,function(s){function n(a){return a&&typeof a=="object"&&"default"in a?a:{default:a}}var r=n(s),i={name:"es",monthsShort:"ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),weekdays:"domingo_lunes_martes_miércoles_jueves_viernes_sábado".split("_"),weekdaysShort:"dom._lun._mar._mié._jue._vie._sáb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_sá".split("_"),months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),weekStart:1,formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un día",dd:"%d días",M:"un mes",MM:"%d meses",y:"un año",yy:"%d años"},ordinal:function(a){return a+"º"}};return r.default.locale(i,null,!0),i})}(Y)),Y.exports}Ze();var O={exports:{}},et=O.exports,re;function tt(){return re||(re=1,function(t,l){(function(s,n){t.exports=n()})(et,function(){return{name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(s){var n=["th","st","nd","rd"],r=s%100;return"["+s+(n[(r-20)%10]||n[r]||n[0])+"]"}}})}(O)),O.exports}tt();const ne={title:"",type:"rehearsal",start_time:null,end_time:null,location:"",description:""},ce=({groupId:t,onClose:l,initialEvent:s=null,mode:n="create"})=>{var k,F,G,A,L,D;const{user:r}=E(),i=n==="edit",{t:a,i18n:o}=_("groupEvents",{keyPrefix:"form"}),c=o.language==="es"?"es":"en",{createEvent:d,updateEvent:g}=V(),{register:h,handleSubmit:u,setValue:p,watch:x,reset:f,formState:{errors:b,isSubmitting:j}}=be({defaultValues:ne}),v=x("start_time"),S=x("end_time");y.useEffect(()=>{f(s?{title:s.title||"",type:s.type||"rehearsal",start_time:Q(s.start_time),end_time:Q(s.end_time),location:s.location||"",description:s.description||""}:ne)},[s,f]);const T=async m=>{var N,J;try{const H={...m,start_time:(N=m.start_time)==null?void 0:N.toISOString(),end_time:(J=m.end_time)==null?void 0:J.toISOString(),created_by:r.id};i?await g({id:s.id,...H}):await d({profile_group_id:t,...H}),l()}catch{alert(a("error_saving_event"))}};return e.jsx("div",{className:"fixed inset-0 z-50 bg-black bg-opacity-40 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl w-full max-w-md max-h-full overflow-y-auto p-8 text-gray-900 relative",style:{minHeight:"400px"},children:[e.jsx("button",{onClick:l,className:"absolute top-4 right-4 text-gray-500 hover:text-gray-700 transition","aria-label":a("close"),type:"button",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 cursor-pointer",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h2",{className:"text-3xl text-yellow-600 font-semibold mb-6 text-center",children:a(i?"titles.edit_event":"titles.create_event")}),e.jsxs("form",{onSubmit:u(T),className:"space-y-6",children:[e.jsx(ee,{id:"title",label:a("labels.title"),maxLength:12,placeholder:a("placeholders.title"),register:h,validation:{required:a("validations.title")},error:(k=b.title)==null?void 0:k.message,className:"text-gray-900",classForLabel:"!text-gray-700"}),e.jsx(ie,{id:"type",label:a("labels.type"),defaultOption:a("placeholders.type"),options:[{value:"rehearsal",label:a("types.rehearsal")},{value:"gig",label:a("types.gig")},{value:"meeting",label:a("types.meeting")}],register:h,error:(F=b.type)==null?void 0:F.message,className:"bg-white text-gray-900 placeholder-gray-400 focus:bg-white focus:text-gray-900",classForLabel:"!text-gray-700"}),e.jsx(he,{dateAdapter:ge,adapterLocale:c,children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"custom-datetime",children:[e.jsx("label",{htmlFor:"start_time",className:"block text-sm font-bold mb-2 text-gray-700",children:a("labels.start_time")}),e.jsx(Z,{className:"MuiCustomDateTimePicker",value:v,onChange:m=>p("start_time",m),slotProps:{textField:{id:"start_time",fullWidth:!0,error:!!b.start_time,helperText:(G=b.start_time)==null?void 0:G.message,size:"small",variant:"outlined"}}})]}),e.jsxs("div",{className:"custom-datetime",children:[e.jsx("label",{htmlFor:"end_time",className:"block text-sm font-bold mb-2 text-gray-700",children:a("labels.end_time")}),e.jsx(Z,{className:"MuiCustomDateTimePicker",value:S,onChange:m=>p("end_time",m),slotProps:{textField:{id:"end_time",fullWidth:!0,error:!!b.end_time,helperText:(A=b.end_time)==null?void 0:A.message,size:"small",variant:"outlined"}}})]})]})}),e.jsx(ee,{id:"location",label:a("labels.location"),placeholder:a("placeholders.location"),register:h,error:(L=b.location)==null?void 0:L.message,className:"text-gray-900",classForLabel:"!text-gray-700"}),e.jsx(je,{id:"description",label:a("labels.description"),placeholder:a("placeholders.description"),maxLength:200,register:h,error:(D=b.description)==null?void 0:D.message,watchValue:"",className:"text-gray-900",classForLabel:"!text-gray-700"}),e.jsxs("div",{className:"pt-4 flex justify-end space-x-4",children:[e.jsx(w,{className:"!bg-gray-600 hover:!bg-gray-700 text-white",type:"button",onClick:l,children:a("buttons.cancel")}),e.jsx(w,{type:"submit",disabled:j,className:"!bg-emerald-600 hover:!bg-emerald-700 text-white",children:a(j?"buttons.saving":i?"buttons.save":"buttons.create")})]})]})]})})},st=({eventId:t,userId:l,currentStatus:s})=>{const{t:n}=_("groupEvents"),[r,i]=y.useState(s||"pending"),{upsertRsvp:a}=oe(),o=async d=>{const g=d.target.value;i(g);try{await a({event_id:t,profile_id:l,status:g})}catch{alert(n("error_updating_rsvp")),i(s||"pending")}},c=[{value:"attending",label:n("rsvp.attending")},{value:"not_attending",label:n("rsvp.not_attending")},{value:"pending",label:n("rsvp.pending")}];return e.jsx("div",{className:"mb-4",children:e.jsx(ie,{id:"rsvp",label:n("your_rsvp"),value:r,onChange:o,options:c,classForLabel:"uppercase",className:"sm:!w-1/3"})})};function at({className:t="",list:l=!1,size:s=120}){const n=l?40:s,r="#a1a1aa",i="#e4e4e7";return l?e.jsx(se,{circle:!0,height:n,width:n,className:t,containerClassName:t,baseColor:r,highlightColor:i}):e.jsx("div",{className:`rounded-full shadow-md overflow-hidden ${t}`,style:{width:n,height:n},children:e.jsx(se,{circle:!0,height:"100%",width:"100%",baseColor:r,highlightColor:i})})}const rt=({rsvps:t})=>{const{t:l}=_("groupEvents"),{profilesMap:s}=ye(),n=t.map(c=>c.profile_id),{data:r,isLoading:i}=s(n),a={attending:[],not_attending:[],pending:[]};t.forEach(c=>{c.status==="attending"?a.attending.push(c):c.status==="not_attending"?a.not_attending.push(c):a.pending.push(c)});const o=c=>{const d=r==null?void 0:r[c.profile_id];return e.jsx("div",{className:"flex items-center justify-center space-x-3",children:i||!d?e.jsx(at,{size:45}):e.jsxs(e.Fragment,{children:[e.jsx(X,{avatar_url:d.avatar_url,alt:d.username,gender:d.gender,className:"!w-11 !h-11"}),e.jsx("span",{className:"text-sm text-gray-200",children:d.username})]})},c.profile_id)};return e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mt-6",children:[{label:l("attending"),key:"attending",color:"text-emerald-400"},{label:l("not_attending"),key:"not_attending",color:"text-rose-400"},{label:l("pending"),key:"pending",color:"text-yellow-400"}].map(({label:c,key:d,color:g})=>e.jsxs("div",{className:"bg-gray-800 rounded-lg p-4 shadow-sm space-y-3",children:[e.jsx("h4",{className:`text-sm text-center font-semibold uppercase ${g}`,children:c}),e.jsx("div",{className:"space-y-2",children:a[d].length>0?a[d].map(o):e.jsx("p",{className:"text-xs text-center text-gray-400 italic",children:l("none")})})]},d))})},nt=({event:t,onClose:l,isAdminOrManager:s})=>{var j;const{t:n,i18n:r}=_("groupEvents"),{user:i}=E(),{fetchEventRsvps:a}=oe(),{data:o,isLoading:c,error:d}=a(t.id),{deleteEvent:g}=V(),[h,u]=y.useState(!1);if(console.log(t.id),!t)return null;const p=async()=>{try{await g(t),l()}catch(v){alert(n("error_deleting_event")),console.error(v)}},x=r.language==="es"?B:C,f=P(new Date(t.start_time),"PPPPp",{locale:x}),b=P(new Date(t.end_time),"PPPPp",{locale:x});return e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-50",children:[e.jsxs("div",{className:"bg-gray-900 text-white rounded-lg shadow-xl w-full max-w-3xl max-h-[90vh] overflow-y-auto p-6 relative",children:[e.jsx("button",{onClick:l,className:"absolute top-4 right-4 text-rose-600 cursor-pointer font-bold text-2xl","aria-label":n("close"),children:"×"}),e.jsx("h3",{className:"text-3xl font-bold text-white mb-3 text-center",children:t.title}),e.jsx("div",{className:"text-center text-sm mb-6",children:e.jsx("span",{className:`inline-block px-3 py-1 rounded-full font-medium ${t.type==="gig"?"bg-sky-700 text-sky-200":t.type==="rehearsal"?"bg-amber-700 text-amber-200":t.type==="meeting"?"bg-emerald-700 text-emerald-200":"bg-gray-700 text-gray-200"}`,children:n(`types.${t.type}`)})}),e.jsxs("div",{className:"grid text-center grid-cols-1 md:grid-cols-3 gap-4 text-sm mb-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 underline",children:n("location")}),e.jsx("p",{className:"text-white",children:t.location||n("no_location")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 underline",children:n("start")}),e.jsx("p",{className:"text-white",children:f})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 underline",children:n("end")}),e.jsx("p",{className:"text-white",children:b})]})]}),t.description&&e.jsxs("div",{className:"mt-4 pt-4 border-t text-center border-gray-700",children:[e.jsx("h4",{className:"text-sm font-semibold underline text-gray-400 mb-1",children:n("description")}),e.jsx("p",{className:"text-gray-300 whitespace-pre-wrap",children:t.description})]}),c&&e.jsx(q,{}),d&&e.jsx(R,{error:d.message}),o&&e.jsxs("div",{className:"space-y-6 mt-10",children:[e.jsx(st,{eventId:t.id,userId:i.id,currentStatus:(j=o.find(v=>v.profile_id===i.id))==null?void 0:j.status}),e.jsx(rt,{rsvps:o})]}),s&&e.jsxs("div",{className:"mt-6 flex gap-4 justify-center flex-wrap",children:[e.jsx(w,{className:"bg-yellow-600 hover:bg-yellow-700",onClick:()=>u(!0),children:n("edit")}),e.jsx(w,{className:"!bg-red-600 hover:!bg-red-700",onClick:p,children:n("delete")})]})]}),h&&e.jsx(ce,{groupId:t.group_id,initialEvent:t,mode:"edit",onClose:()=>u(!1),onSave:()=>{u(!1)}})]})},lt=({calendarApi:t,title:l})=>t?e.jsxs("div",{className:"mb-4 select-none",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("button",{onClick:()=>t.prev(),className:"px-3 py-1 cursor-pointer text-slate-400 rounded hover:text-slate-300",type:"button","aria-label":"Previous",children:"Prev"}),e.jsx("div",{className:"font-semibold text-sm sm:text-lg text-white",children:l}),e.jsx("button",{onClick:()=>t.next(),className:"px-3 py-1 cursor-pointer text-slate-400 rounded hover:text-slate-300",type:"button","aria-label":"Next",children:"Next"})]}),e.jsx("div",{className:"flex justify-center",children:e.jsx("button",{onClick:()=>t.today(),className:"px-4 py-1 cursor-pointer w-full text-slate-400 rounded hover:text-slate-300",type:"button","aria-label":"Today",children:"Today"})})]}):null,it=({calendarApi:t,currentView:l,setCurrentView:s})=>{if(!t)return null;const n=r=>{t&&(t.changeView(r),s(r))};return e.jsxs("div",{className:"flex gap-2 justify-center sm:justify-end mt-2",children:[e.jsx("button",{onClick:()=>n("dayGridMonth"),className:`px-3 py-1 rounded cursor-pointer hidden sm:inline-block ${l==="dayGridMonth"?"bg-slate-600 text-white":"!bg-transparent text-gray-300"}`,children:"Month"}),e.jsx("button",{onClick:()=>n("listWeek"),className:`px-3 py-1 rounded cursor-pointer ${l==="listWeek"?"bg-slate-600 text-white":"bg-transparent text-gray-300"}`,children:"List"})]})},ot=({event:t,view:l})=>{const s=t.start,n=t.end,r=a=>P(a,"HH:mm"),i=n?`${r(s)} - ${r(n)}`:r(s);return l.type.startsWith("list")?e.jsxs("div",{className:"text-white hover:!bg-transparent !flex !flex-col",children:[e.jsx("strong",{className:"truncate",children:t.title}),e.jsx("span",{className:"text-xs mt-0.5",children:i})]}):e.jsxs("div",{className:"m-auto text-center hover:!bg-transparent",children:[e.jsx("strong",{children:t.title}),e.jsx("div",{className:"text-xs text-gray-300 mt-0.5",children:i})]})},ct=({groupId:t,isAdminOrManager:l=!1})=>{var L,D;const{t:s,i18n:n}=_("groupEvents"),{fetchGroupEvents:r}=V(),{data:i,isLoading:a,error:o,refetch:c}=r(t),[d,g]=y.useState(!1),[h,u]=y.useState(null),[p,x]=y.useState(null),[f,b]=y.useState("dayGridMonth"),j=y.useRef(null),[v,S]=y.useState(""),T=y.useMemo(()=>i?i.map(m=>({id:m.id,title:m.title,start:m.start_time,end:m.end_time,extendedProps:{description:m.description,location:m.location,type:m.type,fullEvent:m}})):[],[i]),k=y.useMemo(()=>i?[...i].sort((m,N)=>new Date(m.start_time)-new Date(N.start_time)):[],[i]),F=m=>{l&&(u(m.dateStr),x(null),g(!0))},G=m=>{x(m.event.extendedProps.fullEvent),u(null),g(!1)},A=()=>{if(!j.current)return;const m=j.current.getApi();S(m.view.title)};return a?e.jsx(q,{}):o?e.jsx(R,{error:o.message}):e.jsxs("div",{className:"bg-gray-900 text-white p-4 rounded-lg shadow-md w-full space-y-6",children:[e.jsx("h2",{className:"text-2xl rounded-t-md bg-gradient-to-r from-gray-800 py-4 font-bold text-amber-600 text-center",children:s("calendar.title")}),e.jsx(lt,{calendarApi:(L=j.current)==null?void 0:L.getApi(),title:v}),e.jsx(it,{calendarApi:(D=j.current)==null?void 0:D.getApi(),currentView:f,setCurrentView:b}),e.jsx(Fe,{ref:j,plugins:[Ge,Ae,$e,Ie],initialView:"dayGridMonth",headerToolbar:!1,views:{dayGridMonth:{buttonText:"Month"},listWeek:{buttonText:"List"}},height:"auto",events:T,eventClick:G,dateClick:F,eventTimeFormat:{hour:"2-digit",minute:"2-digit",hour12:!1},locale:n.language,windowResize:()=>{const m=j.current.getApi();window.innerWidth<640?(m.changeView("listWeek"),b("listWeek")):(m.changeView("dayGridMonth"),b("dayGridMonth"))},datesSet:A,eventContent:({event:m,view:N})=>e.jsx(ot,{event:m,view:N}),dayCellDidMount:m=>Je(m,T),eventDidMount:m=>{Ue(m)}}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-semibold text-white mt-8 mb-4",children:s("calendar.event_list")}),k.length===0?e.jsx("p",{className:"text-gray-400",children:s("calendar.no_events")}):e.jsx("div",{className:"space-y-3",children:k.map(m=>e.jsx(Ke,{event:m,onClick:()=>x(m)},m.id))})]}),d&&e.jsx(ce,{groupId:t,onClose:()=>{g(!1),x(null),u(null),c()},mode:"create",initialEvent:p??(h?{start_time:`${h}T12:00`,end_time:`${h}T14:00`,type:"rehearsal"}:void 0)}),p&&e.jsx(nt,{event:p,isAdminOrManager:l,onClose:()=>{x(null),c()}})]})},dt=({groupId:t})=>{const{user:l}=E(),{t:s}=_("profileGroup",{keyPrefix:"followersList"}),{followersInfiniteQuery:n}=le(),{data:r,fetchNextPage:i,hasNextPage:a,isFetchingNextPage:o,isLoading:c,isError:d,error:g}=n(t),h=y.useMemo(()=>(r==null?void 0:r.pages.flatMap(u=>u))??[],[r]);return c?e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:Array.from({length:8}).map((u,p)=>e.jsx(Pe,{},p))}):d?e.jsx(R,{error:g.message}):(h==null?void 0:h.length)===0?e.jsx("p",{className:"text-gray-400",children:s("connection.messages.noFollowers")}):e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 md:grid-cols-4 mx-auto sm:mx-0 sm:mr-auto gap-4",children:h.map(u=>e.jsx(Ee,{profileId:u.follower_profile_id,ownProfile:!1},u.follow_id))}),a&&e.jsx("button",{onClick:()=>i(),disabled:o,className:"self-center cursor-pointer mt-4 px-4 py-2 rounded bg-amber-950 text-white hover:bg-amber-800",children:s(o?"connection.loadingMore":"connection.loadMore")})]})};function wt(){const{groupId:t}=ve(),{user:l}=E(),{fetchProfileGroup:s}=_e(),{data:n,isLoading:r,error:i}=s(t),{fetchGroupMembers:a}=we(),{data:o,isLoading:c,error:d}=a(t);if(r||c||!Array.isArray(o))return e.jsx(q,{});if(i||d)return e.jsx(R,{error:(i==null?void 0:i.message)||(d==null?void 0:d.message)});if(!n)return e.jsx(te,{to:"/",replace:!0});const h=o==null?void 0:o.find(f=>f.profile_id===l.id),u=(h==null?void 0:h.role)==="admin",p=u||(h==null?void 0:h.role)==="manager",x=!!h;return e.jsx("div",{className:"flex flex-col min-h-screen text-white",children:e.jsxs("div",{className:"max-w-5xl mx-auto p-6 space-y-6",children:[e.jsx(Ye,{groupData:n,CanManageGroup:p,isMember:x}),e.jsxs(Ne,{children:[e.jsx(M,{index:!0,element:e.jsx(qe,{group:n,members:o})}),e.jsx(M,{path:"posts/*",element:e.jsx(Be,{groupId:t,CanManageGroup:p})}),e.jsx(M,{path:"followers",element:e.jsx(dt,{groupId:t})}),x&&e.jsx(M,{path:"calendar",element:e.jsx(ct,{groupId:t,isAdminOrManager:p,isMember:x})}),u&&e.jsx(e.Fragment,{children:e.jsx(M,{path:"edit",element:e.jsx(Me,{group:n,onSave:()=>window.history.back(),onCancel:()=>window.history.back()})})}),e.jsx(M,{path:"*",element:e.jsx(te,{to:"",replace:!0})})]})]})})}export{wt as default};
