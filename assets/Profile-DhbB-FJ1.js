import{n as Se,h as re,i as Me,k as fe,m as ie,l as le,p as oe,q as H,s as Ie,t as ce,v as ge,j as e}from"./mui-COfzhOQm.js";import{u as k,a as $,b as q,Z as Le,h as he,_ as Pe,Q as $e,y as De,z as Te,$ as pe,x as X,L as ee,P as Fe,B as z,r as Oe,D as Ae,q as Re,l as Ue,m as Be,p as ze,o as Ee,n as Ye,E,G as Ge,a0 as Ze,i as je,s as We,N as de,R as be,g as L,A as He}from"./index-BpP4ZOjQ.js";import{b as qe,X as Je,w as Q,y as xe,z as Qe,C as Ke,Y as Ve,K as Xe,Z as es,_ as ss,$ as ts,a0 as ue,a1 as ns,a2 as as,a3 as ye,a4 as rs,W as is,a5 as ls,a6 as os}from"./icons-Cu9gFVBg.js";import{r as C}from"./filepond-C4Y8_Bzv.js";import{u as cs,h as ds}from"./useCanSendDM-C2odkfZg.js";import{L as xs}from"./LoadingBadge-CQbNElRm.js";import{c as us,g as ms,a as fs,e as gs}from"./es-DV_BEdDN.js";import{S as we}from"./ShinyText-DqIsy4Ek.js";import{R as hs}from"./reactPlayer-DGEX9vCu.js";import{P as se}from"./PlusButton-CwWKXq4U.js";import{S as _}from"./index-cpdcplt_.js";/* empty css                 */import{P as ps}from"./PostsList-tAqjjb-9.js";import js from"./PostForm-CxOmLdrF.js";import{a as bs,A as ys}from"./AdsListSkeleton-BjSYN5XD.js";import"./lottie-Qij33HW6.js";import"./gsap-Brfk6Bdo.js";import"./proxy-BXMBkS9E.js";import"./swiper-Ciezsct5.js";function ws(t,s,n){const a=Me(),r=(n==null?void 0:n.locale)??a.locale??fe,l=us(t,s);if(isNaN(l))throw new RangeError("Invalid time value");const o=Object.assign({},n,{addSuffix:n==null?void 0:n.addSuffix,comparison:l}),[d,x]=Se(n==null?void 0:n.in,...l>0?[s,t]:[t,s]),c=ms((n==null?void 0:n.roundingMethod)??"round"),g=x.getTime()-d.getTime(),h=g/H,y=re(x)-re(d),m=(g-y)/H,w=n==null?void 0:n.unit;let p;if(w?p=w:h<1?p="second":h<60?p="minute":h<ie?p="hour":m<le?p="day":m<oe?p="month":p="year",p==="second"){const b=c(g/1e3);return r.formatDistance("xSeconds",b,o)}else if(p==="minute"){const b=c(h);return r.formatDistance("xMinutes",b,o)}else if(p==="hour"){const b=c(h/60);return r.formatDistance("xHours",b,o)}else if(p==="day"){const b=c(m/ie);return r.formatDistance("xDays",b,o)}else if(p==="month"){const b=c(m/le);return b===12&&w!=="month"?r.formatDistance("xYears",1,o):r.formatDistance("xMonths",b,o)}else{const b=c(m/oe);return r.formatDistance("xYears",b,o)}}function Ns(t,s){return ws(t,fs(t),s)}function vs(t,s){const n=()=>Ie(s==null?void 0:s.in,NaN),r=Ss(t);let l;if(r.date){const c=Ms(r.date,2);l=Is(c.restDateString,c.year)}if(!l||isNaN(+l))return n();const o=+l;let d=0,x;if(r.time&&(d=Ls(r.time),isNaN(d)))return n();if(r.timezone){if(x=Ps(r.timezone),isNaN(x))return n()}else{const c=new Date(o+d),g=ce(0,s==null?void 0:s.in);return g.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),g.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),g}return ce(o+d+x,s==null?void 0:s.in)}const W={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Cs=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,ks=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,_s=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Ss(t){const s={},n=t.split(W.dateTimeDelimiter);let a;if(n.length>2)return s;if(/:/.test(n[0])?a=n[0]:(s.date=n[0],a=n[1],W.timeZoneDelimiter.test(s.date)&&(s.date=t.split(W.timeZoneDelimiter)[0],a=t.substr(s.date.length,t.length))),a){const r=W.timezone.exec(a);r?(s.time=a.replace(r[1],""),s.timezone=r[1]):s.time=a}return s}function Ms(t,s){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+s)+"})|(\\d{2}|[+-]\\d{"+(2+s)+"})$)"),a=t.match(n);if(!a)return{year:NaN,restDateString:""};const r=a[1]?parseInt(a[1]):null,l=a[2]?parseInt(a[2]):null;return{year:l===null?r:l*100,restDateString:t.slice((a[1]||a[2]).length)}}function Is(t,s){if(s===null)return new Date(NaN);const n=t.match(Cs);if(!n)return new Date(NaN);const a=!!n[4],r=B(n[1]),l=B(n[2])-1,o=B(n[3]),d=B(n[4]),x=B(n[5])-1;if(a)return Os(s,d,x)?$s(s,d,x):new Date(NaN);{const c=new Date(0);return!Ts(s,l,o)||!Fs(s,r)?new Date(NaN):(c.setUTCFullYear(s,l,Math.max(r,o)),c)}}function B(t){return t?parseInt(t):1}function Ls(t){const s=t.match(ks);if(!s)return NaN;const n=K(s[1]),a=K(s[2]),r=K(s[3]);return As(n,a,r)?n*ge+a*H+r*1e3:NaN}function K(t){return t&&parseFloat(t.replace(",","."))||0}function Ps(t){if(t==="Z")return 0;const s=t.match(_s);if(!s)return 0;const n=s[1]==="+"?-1:1,a=parseInt(s[2]),r=s[3]&&parseInt(s[3])||0;return Rs(a,r)?n*(a*ge+r*H):NaN}function $s(t,s,n){const a=new Date(0);a.setUTCFullYear(t,0,4);const r=a.getUTCDay()||7,l=(s-1)*7+n+1-r;return a.setUTCDate(a.getUTCDate()+l),a}const Ds=[31,null,31,30,31,30,31,31,30,31,30,31];function Ne(t){return t%400===0||t%4===0&&t%100!==0}function Ts(t,s,n){return s>=0&&s<=11&&n>=1&&n<=(Ds[s]||(Ne(t)?29:28))}function Fs(t,s){return s>=1&&s<=(Ne(t)?366:365)}function Os(t,s,n){return s>=1&&s<=53&&n>=0&&n<=6}function As(t,s,n){return t===24?s===0&&n===0:n>=0&&n<60&&s>=0&&s<60&&t>=0&&t<25}function Rs(t,s){return s>=0&&s<=59}function Us({otherProfile:t,className:s=""}){const{t:n}=k("profile"),{user:a}=$(),{matchScore:r}=q(),[l,o]=C.useState(null);if(C.useEffect(()=>{a!=null&&a.id&&(t!=null&&t.id)&&r({profileAId:a.id,profileBId:t.id}).then(x=>{o(x)}).catch(x=>{console.error("matchScore error",x)})},[a==null?void 0:a.id,t==null?void 0:t.id]),l===null)return e.jsx(xs,{color:"amber"});const d=Math.round(l*100);return e.jsxs("div",{className:`w-full md:w-auto flex items-center justify-center gap-1 cursor-help whitespace-nowrap select-none ${s}`,title:n("matchScore.title"),children:[e.jsx(qe,{className:"text-amber-700 text-xl"}),e.jsxs("span",{className:`inline-block w-full text-center px-3 py-1.5 rounded-full text-sm font-semibold whitespace-nowrap ${d>=70?"bg-amber-800 text-white":d>=40?"bg-sky-700 text-white":d>=10?"bg-gray-300 text-gray-900":"bg-gray-800 text-gray-100"}`,children:["Match: ",d,"%"]})]})}function Bs(t){if(!t)return null;const s=vs(t),n=Le.language.startsWith("es")?gs:fe;return Ns(s,{locale:n,addSuffix:!0})}function zs({isOwnProfile:t,profileData:s}){const{t:n}=k("profile"),{user:a}=$(),r=he(),{data:l}=Pe(s.id),{totalUnreadMessages:o}=$e(),{data:d,isLoading:x}=o(a==null?void 0:a.id),{findConversation:c,createConversation:g}=De(),{addParticipant:h}=Te(),{userNotifications:y,notificationsRealtime:m}=pe();m(a.id);const{data:w,isLoading:p}=y(a.id),{connectionBetweenProfiles:b,addConnection:M,updateConnection:P,deleteConnection:O}=X(),{data:i,isLoading:u}=b(a==null?void 0:a.id,s.id),{canSend:N}=cs(s.id),[D,S]=C.useState(!1),[T,I]=C.useState(!1),[A,Y]=C.useState(null),R=(w==null?void 0:w.filter(j=>!j.is_read).length)||0,G=!!(l!=null&&l.show_last_seen&&s.last_seen),Z=()=>{D||ds({myProfileId:a.id,otherProfile:s,findConversation:c,createConversation:g,addParticipant:h,navigate:r,setLoading:S})},U=async()=>{await M({follower_profile_id:a.id,following_profile_id:s.id,status:"pending"})},f=async()=>{i&&await O(i)},J=async()=>{i?await P({connection:i,updatedConnection:{status:"blocked"}}):await M({follower_profile_id:a.id,following_profile_id:s.id,status:"blocked"})},te=async()=>{i&&await P({connection:i,updatedConnection:{status:"accepted"}})};C.useEffect(()=>{if(!T)return;const j=F=>{F.target.closest(".profile-connection-menu")||I(!1)};return document.addEventListener("mousedown",j),()=>document.removeEventListener("mousedown",j)},[T]);const ve=j=>{const F="text-white text-lg mr-1 drop-shadow-[0_0_2px_rgba(255,255,255,0.5)]",_e="text-gray-300 text-lg mr-1 drop-shadow-[0_0_2px_rgba(255,255,255,0.2)]";return j==="accepted"?e.jsx(ss,{className:F}):j==="pending"?e.jsx(ts,{className:F}):j==="blocked"&&i.follower_profile_id===a.id?e.jsx(ue,{className:F}):j==="blocked"&&i.follower_profile_id===s.id?e.jsx(ue,{className:_e}):e.jsx(ns,{className:F})},Ce=(i==null?void 0:i.status)==="accepted",ke=(i==null?void 0:i.status)==="pending",ne=(i==null?void 0:i.status)==="blocked"&&i.follower_profile_id===a.id,ae=(i==null?void 0:i.status)==="blocked"&&i.follower_profile_id===s.id;return e.jsxs("div",{className:"bg-gradient-to-l md:min-w-2xl lg:min-w-4xl from-gray-900 to-gray-950 mb-4 p-4 rounded-b-lg",children:[e.jsxs("div",{className:"flex flex-col gap-6 sm:flex-row sm:items-center",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-grow",children:[e.jsx(ee,{to:`/profile/${s.id}`,children:e.jsx(Fe,{avatar_url:s.avatar_url,className:"flex-shrink-0 !w-24 !h-24",gender:s.gender})}),e.jsxs("div",{className:"flex flex-col gap-2 flex-grow",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-100 break-words",children:s.username}),e.jsx("p",{className:"text-gray-400 break-words",children:s.bio})]})]}),e.jsxs("div",{className:"flex gap-4 ml-auto sm:mb-auto items-center relative",children:[!t&&e.jsxs(e.Fragment,{children:[N&&e.jsx(as,{className:"w-8 h-8 text-white cursor-pointer",onClick:Z,disabled:D,title:n("profile.titles.startChat")}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{className:"text-white hover:text-sky-400 p-2 rounded-full focus:outline-none",onClick:()=>I(j=>!j),"aria-label":"Connection options",children:e.jsx(Je,{size:24})}),T&&e.jsxs("div",{className:"absolute right-0 top-10 z-20 bg-gray-900 border border-sky-700 rounded shadow-lg py-1 w-44 flex flex-col min-w-[150px] profile-connection-menu",children:[u?e.jsx("span",{className:"px-4 py-2 text-gray-400 text-xs flex items-center gap-2",children:n("connection.loading")}):ne?e.jsxs("button",{onClick:()=>{te(),I(j=>!j)},className:"px-4 py-2 text-left hover:bg-gray-800 text-sm text-yellow-600 flex items-center gap-2",children:[e.jsx(Q,{}),n("connection.unblock")]}):ae?e.jsxs("span",{className:"px-4 py-2 text-red-400 text-xs flex items-center gap-2",children:[e.jsx(xe,{}),n("connection.blockedByOther")]}):Ce?e.jsxs("button",{onClick:()=>{f(),I(j=>!j)},className:"px-4 py-2 text-left hover:bg-gray-800 text-sm text-gray-300 flex items-center gap-2",children:[e.jsx(Q,{}),n("connection.disconnect")]}):ke?e.jsxs("button",{onClick:()=>{f(),I(j=>!j)},className:"px-4 py-2 text-left hover:bg-gray-800 text-sm text-yellow-400 flex items-center gap-2 group",onMouseEnter:()=>Y("disconnect"),onMouseLeave:()=>Y(null),children:[A==="disconnect"?e.jsx(Q,{}):e.jsx(Qe,{}),n(A==="disconnect"?"connection.disconnect":"connection.pending")]}):e.jsxs("button",{onClick:()=>{U(),I(j=>!j)},className:"px-4 py-2 text-left hover:bg-gray-800 text-sm text-green-600 flex items-center gap-2",children:[e.jsx(Ke,{}),n("connection.connect")]}),!ae&&!ne&&e.jsxs("button",{onClick:()=>{J(),I(j=>!j)},className:"px-4 py-2 text-left hover:bg-gray-800 text-sm text-red-400 border-t border-sky-800 flex items-center gap-2",children:[e.jsx(xe,{}),n("connection.block")]})]})]})]}),t&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ve,{className:"w-8 h-8 text-white cursor-pointer",onClick:()=>r("/chat"),title:n("profile.titles.chat")}),!x&&(d==null?void 0:d.total)>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full px-1.5",children:d.total})]}),e.jsx(Xe,{className:"w-8 h-8 text-white cursor-pointer",onClick:()=>{r("/settings")},title:n("profile.titles.settings")}),e.jsxs("div",{className:"relative",children:[e.jsx(es,{className:"w-7 h-7 text-white cursor-pointer",onClick:()=>r(`/profile/${s.id}/notifications`),title:n("profile.titles.notifications")}),!p&&R>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full px-1.5",children:R})]})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center sm:justify-end mt-6",children:[!t&&e.jsxs("div",{className:"w-full mx-auto md:mx-0 md:!mr-auto mb-3 flex flex-col items-start gap-6 mt-3",children:[e.jsxs("div",{className:"flex flex-col items-stretch w-full md:flex-row gap-3 md:gap-6",children:[!u&&e.jsxs("button",{title:i?i.status==="accepted"?n("connection.disconnect"):i.status==="pending"?n("connection.cancelRequest"):i.status==="blocked"?i.follower_profile_id===a.id?n("connection.unblock"):n("connection.blockedByOther"):"":n("connection.connect"),onClick:()=>{if(!i)return U();if(i.status==="pending"||i.status==="accepted")return f();if(i.status==="blocked"&&i.follower_profile_id===a.id)return te()},className:`w-full sm:w-auto inline-flex items-center justify-center gap-1 px-3.5 py-1.5 rounded-full text-sm font-semibold whitespace-nowrap transition
                    ${i?i.status==="accepted"?"bg-emerald-700 text-white hover:bg-emerald-800":i.status==="pending"?"bg-yellow-600 text-white hover:bg-yellow-700":i.status==="blocked"&&i.follower_profile_id===a.id?"bg-red-700 text-white hover:bg-red-800":i.status==="blocked"&&i.follower_profile_id===s.id?"bg-gray-600 text-gray-200 cursor-not-allowed":"bg-gray-700 text-white":"bg-sky-700 text-white hover:bg-sky-800"}
                    ${(i==null?void 0:i.status)==="blocked"&&i.follower_profile_id===s.id?"pointer-events-none":"cursor-pointer"}
                  `,disabled:(i==null?void 0:i.status)==="blocked"&&i.follower_profile_id===s.id,children:[ve(i==null?void 0:i.status),i?i.status==="accepted"?n("connection.accepted"):i.status==="pending"?n("connection.pending"):i.status==="blocked"&&i.follower_profile_id===a.id?n("connection.blocked"):i.status==="blocked"&&i.follower_profile_id===s.id?n("connection.blockedByOther"):"":n("connection.connect")]}),e.jsx("div",{children:e.jsx(Us,{otherProfile:s})})]}),G&&e.jsx("p",{className:"text-xs mx-auto sm:mx-0 sm:mr-auto text-gray-400",children:n("profile.lastSeen",{time:Bs(s.last_seen)})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-4",children:e.jsx(z,{onClick:()=>r(`/profile/${s.id}`),children:n("profile.navigation.about")})}),e.jsx("div",{className:"sm:mb-4",children:e.jsx(z,{onClick:()=>r(`/profile/${s.id}/ads`),children:n("profile.navigation.ads")})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-4",children:e.jsx(z,{onClick:()=>r(`/profile/${s.id}/posts`),children:n("profile.navigation.posts")})}),e.jsx("div",{className:"sm:mb-4",children:e.jsx(z,{starBorder:!0,onClick:()=>r(`/profile/${s.id}/groups`),className:"!bg-amber-800 hover:!bg-amber-900",children:n("profile.navigation.groups")})})]})]})]})}function Es({profileData:t}){const{t:s}=k("profile"),{privacyOthers:n}=Oe(),{data:a={}}=n(t.id);function r(l){const o=new Date(l),d=new Date;let x=d.getFullYear()-o.getFullYear();const c=d.getMonth()-o.getMonth();return(c<0||c===0&&d.getDate()<o.getDate())&&x--,x}return e.jsx("div",{className:"flex flex-col items-center",children:e.jsxs("ul",{className:"grid grid-cols-1 sm:grid-cols-2 gap-x-12 gap-y-4 text-lg text-gray-300",children:[t.firstname&&e.jsxs("li",{className:"flex items-center",children:[e.jsxs("span",{className:"font-semibold w-28 text-gray-500",children:[s("profile.data.firstname"),":"]}),e.jsx("span",{children:t.firstname})]}),t.lastname&&e.jsxs("li",{className:"flex items-center",children:[e.jsxs("span",{className:"font-semibold w-28 text-gray-500",children:[s("profile.data.lastname"),":"]}),e.jsx("span",{children:t.lastname})]}),t.country&&e.jsxs("li",{className:"flex items-center",children:[e.jsxs("span",{className:"font-semibold w-28 text-gray-500",children:[s("profile.data.country"),":"]}),e.jsx("span",{children:t.country})]}),t.state&&e.jsxs("li",{className:"flex items-center",children:[e.jsxs("span",{className:"font-semibold w-28 text-gray-500",children:[s("profile.data.state"),":"]}),e.jsx("span",{children:t.state})]}),t.neighborhood&&e.jsxs("li",{className:"flex items-center",children:[e.jsxs("span",{className:"font-semibold w-28 text-gray-500",children:[s("profile.data.neighborhood"),":"]}),e.jsx("span",{children:t.neighborhood})]}),t.gender&&e.jsxs("li",{className:"flex items-center",children:[e.jsxs("span",{className:"font-semibold w-28 text-gray-500",children:[s("profile.data.gender"),":"]}),e.jsx("span",{children:s(`edit.placeholders.genderOptions.${t.gender.toLowerCase()}`)})]}),t.birthdate&&e.jsxs("li",{className:"flex items-center",children:[e.jsxs("span",{className:"font-semibold w-28 text-gray-500",children:[s("profile.data.age"),":"]}),e.jsxs("span",{children:[r(t.birthdate)," ",s("profile.data.years")]})]}),a.show_email&&t.email&&e.jsxs("li",{className:"flex items-center",children:[e.jsxs("span",{className:"font-semibold w-28 text-gray-500",children:[s("profile.data.email"),":"]}),e.jsx("span",{children:t.email})]})]})})}const Ys=({role:t,data:s})=>{const{t:n}=k("music");return!s||s.length===0?e.jsx("p",{className:"text-gray-400 mt-4 italic text-center",children:n("roles.noData")}):e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"text-xl font-bold mb-4 text-sky-200 text-center",children:n("roles.detailsTitle",{role:n(`roles.${t.role.toLowerCase()}`)})}),e.jsx("ul",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.map(a=>e.jsxs("li",{className:"bg-gray-800 border border-gray-700 rounded-xl p-4 shadow-sm",children:[t.role==="Instrumentalist"&&e.jsxs(e.Fragment,{children:[e.jsx(v,{label:n("fields.instrument"),value:a.instrument}),e.jsx(v,{label:n("fields.yearsOfExperience"),value:a.years_of_experience}),e.jsx(v,{label:n("fields.level"),value:n(`levels.${a.level.toLowerCase()}`)})]}),t.role==="Singer"&&e.jsxs(e.Fragment,{children:[e.jsx(v,{label:n("fields.voiceType"),value:a.voice_type}),e.jsx(v,{label:n("fields.musicGenre"),value:a.music_genre}),e.jsx(v,{label:n("fields.level"),value:n(`levels.${a.level.toLowerCase()}`)})]}),t.role==="DJ"&&e.jsxs(e.Fragment,{children:[e.jsx(v,{label:n("fields.eventsPlayed"),value:a.events_played}),e.jsx(v,{label:n("fields.preferredGenres"),value:a.preferred_genres}),e.jsx(v,{label:n("fields.level"),value:n(`levels.${a.level.toLowerCase()}`)})]}),t.role==="Producer"&&e.jsxs(e.Fragment,{children:[e.jsx(v,{label:n("fields.productionType"),value:a.production_type}),e.jsx(v,{label:n("fields.yearsOfExperience"),value:a.years_of_experience}),e.jsx(v,{label:n("fields.level"),value:n(`levels.${a.level.toLowerCase()}`)})]}),t.role==="Composer"&&e.jsxs(e.Fragment,{children:[e.jsx(v,{label:n("fields.compositionStyle"),value:a.composition_style}),e.jsx(v,{label:n("fields.yearsOfExperience"),value:a.years_of_experience}),e.jsx(v,{label:n("fields.level"),value:n(`levels.${a.level.toLowerCase()}`)})]})]},a.id))})]})},v=({label:t,value:s})=>e.jsxs("p",{className:"text-sm text-gray-300 mb-1",children:[e.jsxs("span",{className:"font-semibold text-gray-200",children:[t,": "]}),"  ",s||"N/A"]});function Gs({role:t,expandedRole:s,handleRoleClick:n}){const{t:a}=k("music"),r=s===t.id;return e.jsxs("div",{className:`p-5 rounded-xl shadow-md border transition-all duration-300 cursor-pointer text-white text-center select-none
        ${r?"border-sky-500 bg-sky-800/30":"border-gray-700 bg-gray-800 hover:border-sky-500 hover:bg-gray-700/60"}
      `,onClick:()=>n(t),children:[e.jsx("span",{className:"text-lg font-semibold tracking-wide",children:a(`roles.${t.role.toLowerCase()}`)}),e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(ye,{className:`text-gray-400 transition-transform duration-200 ${r?"rotate-180":""}`})})]})}function Zs(){const t="#a1a1aa",s="#e4e4e7";return e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx(_,{height:50,className:"rounded-lg",baseColor:t,highlightColor:s}),e.jsx(_,{height:300,className:"rounded-lg",baseColor:t,highlightColor:s})]})}const Ws=({profileId:t})=>{const{user:s}=$(),{t:n}=k("music"),{userMediaLinks:a}=Ae(),{data:r=[],isLoading:l}=a(t),o=he(),d=s.id===t;if(l)return e.jsx(Zs,{});const x=g=>{const h=g.match(/spotify\.com\/(track|playlist|album)\/([a-zA-Z0-9]+)/);if(!h)return null;const[y,m,w]=h;return`https://open.spotify.com/embed/${m}/${w}`},c=r.slice(0,2);return e.jsxs("section",{className:"mb-10",children:[d&&e.jsx(se,{label:n("media.actions.add"),to:"/media/create"}),e.jsx("ul",{className:"space-y-4 text-center",children:c.map(g=>e.jsxs("li",{className:"shadow-sm p-4 rounded-lg bg-gradient-to-l to-gray-800",children:[e.jsx("p",{className:"font-medium mb-2 text-center",children:g.title}),g.media_type==="spotify"?e.jsx("iframe",{src:x(g.url),width:"100%",height:"80",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",className:"rounded w-full max-w-full"}):e.jsx("div",{className:"aspect-video bg-black rounded overflow-hidden",children:e.jsx(hs,{url:g.url,controls:!0,width:"100%",height:"100%",style:{maxWidth:"100%"}})})]},g.id))}),r.length>2&&e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx(z,{onClick:()=>o(`/media/${t}`),className:"!text-emerald-600 !text-2xl hover:!text-emerald-700 !bg-transparent",children:n("media.actions.seeMore")})})]})},Hs=()=>e.jsxs("div",{className:"bg-gray-800 p-5 rounded-xl shadow-md flex flex-col gap-4 items-center",children:[e.jsx(_,{height:24,width:120,baseColor:"#a1a1aa",highlightColor:"#e4e4e7"}),e.jsx(ye,{className:"text-gray-400 mt-2"})]}),qs=()=>{const t="#a1a1aa",s="#e4e4e7";return e.jsxs("div",{className:"mt-6",children:[e.jsx("div",{className:"text-center mb-4",children:e.jsx(_,{width:220,height:28,baseColor:t,highlightColor:s})}),e.jsx("ul",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[...Array(2)].map((n,a)=>e.jsx("li",{className:"bg-gray-800 border border-gray-700 rounded-xl p-4 shadow-sm",children:[...Array(3)].map((r,l)=>e.jsx("div",{className:"mb-2",children:e.jsx(_,{height:14,baseColor:t,highlightColor:s,width:`${80+Math.random()*20}%`})},l))},a))})]})},Js=({profileId:t})=>{var R,G,Z,U;const{t:s}=k("music"),{user:n}=$(),[a,r]=C.useState(),{fetchRoles:l}=Re(),{data:o,isLoading:d,error:x}=l(t),{fetchInstruments:c}=Ue(),{data:g,isLoading:h}=c(a),{fetchSinger:y}=Be(),{data:m,isLoading:w}=y(a),{fetchComposer:p}=ze(),{data:b,isLoading:M}=p(a),{fetchProducer:P}=Ee(),{data:O,isLoading:i}=P(a),{fetchDj:u}=Ye(),{data:N,isLoading:D}=u(a),[S,T]=C.useState(null),I=n.id===t,A=d||h||w||M||i||D,Y=f=>{S===f.id?T(null):(T(f.id),(f.role==="Instrumentalist"||f.role==="Singer"||f.role==="DJ"||f.role==="Producer"||f.role==="Composer")&&r(f.id))};return x?e.jsx(E,{error:x.message||s("errors.fetch")}):e.jsxs("div",{className:"bg-gray-900 p-6 rounded-lg shadow-md w-full",children:[e.jsx("div",{className:"flex items-center justify-center font-semibold gap-3 mb-6",children:e.jsx(we,{text:s("roles.title"),speed:3,className:"text-3xl tracking-wide"})}),e.jsx(Ws,{profileId:t}),I&&e.jsx(se,{label:s("roles.addRole"),to:"/settings/music"}),(o==null?void 0:o.length)===0?e.jsx("p",{className:"text-gray-400 text-center",children:s("roles.none")}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:A&&!(o!=null&&o.length)?[...Array(3)].map((f,J)=>e.jsx(Hs,{},J)):o==null?void 0:o.map(f=>e.jsx(Gs,{role:f,expandedRole:S,handleRoleClick:Y},f.id))}),S&&e.jsxs("div",{className:"mt-6",children:[A?e.jsx(qs,{}):e.jsx(Ys,{role:o.find(f=>f.id===S),data:((R=o.find(f=>f.id===S))==null?void 0:R.role)==="Instrumentalist"?g:((G=o.find(f=>f.id===S))==null?void 0:G.role)==="Singer"?m:((Z=o.find(f=>f.id===S))==null?void 0:Z.role)==="DJ"?N:((U=o.find(f=>f.id===S))==null?void 0:U.role)==="Producer"?O:b}),e.jsxs("div",{className:"flex justify-center mt-4 cursor-pointer",onClick:()=>T(null),children:[e.jsx(rs,{className:"text-gray-500"})," "]})]})]})]})};function Qs(){const t="#a1a1aa",s="#e4e4e7";return e.jsxs("div",{className:"relative flex flex-col w-35 h-65 bg-gray-100 rounded-lg shadow-sm overflow-hidden",children:[e.jsx(_,{height:160,width:"100%",baseColor:t,highlightColor:s}),e.jsxs("div",{className:"absolute top-2 right-2 flex flex-col items-center",children:[e.jsx(_,{circle:!0,width:5,height:5,baseColor:"#71717a",highlightColor:s}),e.jsx(_,{circle:!0,width:5,height:5,className:"-top-4",baseColor:"#71717a",highlightColor:s}),e.jsx(_,{circle:!0,width:5,height:5,className:"-top-8",baseColor:"#71717a",highlightColor:s})]}),e.jsxs("div",{className:"flex flex-col justify-center items-center gap-1 p-2 grow",children:[e.jsx(_,{height:18,width:120,baseColor:t,highlightColor:s}),e.jsx(_,{height:14,width:90,baseColor:t,highlightColor:s})]})]})}const Ks=({profileId:t,connection:s,ownProfile:n})=>{const{t:a}=k("profile"),{user:r}=$(),l=r==null?void 0:r.id,{fetchProfile:o}=q(),{updateConnection:d,deleteConnection:x}=X(),{data:c,isLoading:g,error:h}=o(t),y=s.status==="pending"&&s.following_profile_id===l;s.status==="accepted"&&(s.following_profile_id===l||s.follower_profile_id);const m=l===s.follower_profile_id||l===s.following_profile_id,[w,p]=C.useState(!1);if(g)return e.jsx(Qs,{});if(h)return e.jsx(E,{error:h.message});if(!c)return null;const b=async()=>{if(!s.id)return console.warn("Connection ID is missing");await d({connection:s,updatedConnection:{status:"accepted"}})},M=async()=>{if(!s.id)return console.warn("Connection ID is missing");await x(s)};return e.jsxs("div",{className:"relative flex flex-col w-35 h-65 text-gray-800 bg-gray-100 items-center gap-2 border rounded-lg shadow-sm",children:[s.id&&e.jsxs("div",{className:"absolute top-2 right-2 flex gap-2 z-10",children:[y&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:b,className:"text-green-600 hover:text-green-800",children:e.jsx(is,{})}),e.jsx("button",{onClick:M,className:"text-red-600 hover:text-red-800",children:e.jsx(ls,{})})]}),m&&!y&&n&&e.jsxs("div",{className:"relative",children:[e.jsx("button",{onClick:()=>p(P=>!P),className:"text-gray-950 hover:text-orange-700 cursor-pointer","aria-label":a("connection.connectionCard.options"),children:e.jsx(os,{title:a("connection.connectionCard.options")})}),w&&e.jsx("div",{className:"absolute right-0 mt-2 w-32 bg-gray-900 border rounded shadow-lg z-50",children:e.jsx("button",{onClick:M,className:"block w-full cursor-pointer text-center px-4 py-2 text-red-500 hover:text-red-600",children:s.status==="accepted"?a("connection.connectionCard.disconnect"):a("connection.connectionCard.delete")})})]})]}),e.jsx(ee,{to:`/profile/${t}`,children:e.jsx("img",{src:c.avatar_url||"/default-avatar.png",alt:`${c.username}'s avatar`,className:"w-60 h-40 object-cover rounded-t-lg"})}),e.jsxs("div",{className:"text-center px-2 pb-2",children:[e.jsx("h3",{className:"font-semibold text-lg",children:c.username}),c.state||c.country?e.jsx("p",{className:"text-gray-400 text-sm",children:[c.state,c.country].filter(Boolean).join(", ")}):null]})]})};function V({checkStatus:t,profileId:s,maxVisible:n}){const{user:a}=$(),{t:r}=k("ui",{keyPrefix:"connections"}),{userConnections:l}=X(),{data:o}=l(s),d=s===a.id;if(!["accepted","pending","blocked"].includes(t)||!o)return null;const x=o.filter(m=>t==="accepted"?m.status==="accepted":t==="blocked"?m.status==="blocked":t==="pending"?m.status==="pending"&&m.following_profile_id===s:!1),c=m=>m.following_profile_id===s?m.follower_profile_id:m.following_profile_id,g=t==="accepted"?r("title"):null,h=t==="accepted",y=n?x.slice(0,n):x;return e.jsxs("div",{className:"max-w-4xl mx-auto w-full bg-gradient-to-l from-gray-900 py-4 flex flex-wrap justify-center rounded-lg gap-4",children:[e.jsx("div",{className:"w-full flex items-center justify-between px-4 mb-2",children:e.jsxs("h2",{className:"text-xl font-bold text-white",children:[g,h&&e.jsxs("span",{className:"ml-2 text-sky-400 text-lg font-semibold",children:["(",x.length,")"]})]})}),y.length>0?y.map(m=>e.jsx(Ks,{connection:m,profileId:c(m),ownProfile:d},m.id)):e.jsx("div",{className:"text-gray-400",children:r(t==="pending"?"noPendingConnections":"noConnections")}),n&&x.length>n&&e.jsx(ee,{to:`/profile/${s}/connections`,className:"w-full text-center text-sky-400 hover:underline mt-2 block",children:r("viewAll")})]})}function Vs({profileId:t}){const{t:s}=k("ads"),{user:n}=$(),{fetchInfiniteByUser:a}=Ge(),{data:r,fetchNextPage:l,hasNextPage:o,isFetchingNextPage:d,isLoading:x,error:c}=a(t),g=t===n.id;if(x)return e.jsx(bs,{isProfileView:!0});if(c)return e.jsx(E,{error:c.message});const h=r?r.pages.flat():[];return e.jsxs("div",{className:"mx-auto text-center w-full",children:[e.jsx("h2",{className:"text-center font-semibold mb-4",children:e.jsx(we,{text:s("profileAds.title"),speed:3,className:"text-3xl tracking-wide"})}),g&&e.jsx(se,{label:s("adsPage.buttons.createAd"),to:"/ads/new",showLabelOnMobile:!0}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:h.length>0?h.map(y=>e.jsx(ys,{ad:y,publisherId:t},y.id)):e.jsx("p",{className:"col-span-full text-center text-gray-400",children:s("profileAds.empty")})}),o&&e.jsx(Button,{className:"!w-1/2 md:!w-1/3 !font-bold mt-4 !mx-auto hover:!text-sky-600",onClick:()=>l(),disabled:d,children:s(d?"profileAds.buttons.loading":"profileAds.buttons.loadMore")})]})}const me=t=>typeof t=="string"?JSON.parse(t):t||{};function Xs({profileId:t}){const{t:s}=k("profile",{keyPrefix:"notifications"}),[n,a]=C.useState(!1),{userNotifications:r,notificationsRealtime:l,updateNotification:o}=pe(),{data:d=[],isLoading:x,error:c}=r(t);l(t);const g=C.useMemo(()=>d.map(u=>u.from_user_id).filter(Boolean).sort(),[d]),h=C.useMemo(()=>d.map(u=>me(u.payload).group_id).filter(Boolean).sort(),[d]),{profilesMap:y}=q(),{data:m={}}=y(g),w=u=>{var N,D;return((N=m[u])==null?void 0:N.username)||((D=m[u])==null?void 0:D.firstname)||s("someone")},{data:p=[]}=Ze({queryKey:["notifGroups",h],enabled:h.length>0,queryFn:async()=>{const{data:u,error:N}=await We.schema("users").from("profile_groups").select("id, name").in("id",h);if(N)throw new Error(N.message);return u}}),b=C.useMemo(()=>{const u={};return p.forEach(N=>u[N.id]=N.name),u},[p]),M=u=>b[u]||s("aGroup"),P=async u=>{u.is_read||await o({...u,is_read:!0})};if(x)return e.jsx(je,{});if(c)return e.jsx(E,{error:c.message});if(d.length===0)return e.jsx("div",{className:"p-4 max-w-4xl mx-auto",children:s("noNotifications")});const O=u=>{const N=me(u.payload);switch(u.type){case"group_follow":return s("group_follow",{user:w(N.follower_id),group:M(N.group_id)});default:return s(u.type,{user:w(u.from_user_id)})}},i=n?d:d.slice(0,10);return e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("ul",{className:`divide-y divide-gray-700
                   p-4 bg-gradient-to-l to-gray-900 rounded-lg shadow-md`,children:i.map(u=>e.jsxs("li",{onClick:()=>P(u),className:`py-2 cursor-pointer hover:bg-gray-800 transition
                        ${u.is_read?"text-gray-400":"text-white font-semibold"}`,children:["• ",O(u)]},u.id))}),d.length>10&&e.jsx("button",{onClick:()=>a(u=>!u),className:"mt-4 mx-auto block text-sky-400 hover:underline",children:s(n?"seeLess":"seeAll")})]})}function et({profileId:t}){const{t:s}=k("profile"),n="cursor-pointer px-4 py-2 text-sm sm:text-base font-semibold rounded-lg transition-all",a=`${n} border-b-2 border-sky-600 text-white shadow-lg`,r=`${n} text-gray-300 hover:text-sky-600`;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-gradient-to-b from-gray-800 to-gray-950 rounded-t-lg",children:e.jsxs("nav",{className:"flex justify-center space-x-8 py-3",children:[e.jsx(de,{end:!0,to:`/profile/${t}/notifications`,className:({isActive:l})=>l?a:r,children:s("profile.internNav.notifications")}),e.jsx(de,{to:`/profile/${t}/notifications/pending`,className:({isActive:l})=>l?a:r,children:s("profile.internNav.pending")})]})}),e.jsxs(be,{children:[e.jsx(L,{index:!0,element:e.jsx(Xs,{profileId:t})}),e.jsx(L,{path:"pending",element:e.jsx(V,{profileId:t,checkStatus:"pending"})})]})]})}function yt(){const{t}=k("profileGroup",{keyPrefix:"userGroups"}),{identifier:s}=He(),{user:n,loading:a}=$(),{fetchProfile:r}=q(),{data:l,isLoading:o,error:d}=r(s);if(a||o)return e.jsx(je,{});if(d)return e.jsx(E,{error:d.message});if(!l)return null;const x=n.id===s,c=()=>e.jsxs(e.Fragment,{children:[e.jsx(Es,{profileData:l}),e.jsx(Js,{profileId:l.id}),e.jsx(V,{profileId:l.id,checkStatus:"accepted",maxVisible:4})]}),g=()=>e.jsx(ps,{profileId:l.id,isOwnProfile:x}),h=()=>e.jsx(js,{}),y=()=>e.jsx("p",{className:"text-center text-gray-400",children:t("userGroupsComing")}),m=()=>e.jsx(Vs,{profileId:l.id});return e.jsx("div",{className:"flex flex-col min-h-screen text-white",children:e.jsxs("div",{className:"max-w-4xl mx-auto p-6 space-y-6",children:[e.jsx(zs,{profileData:l,isOwnProfile:x}),e.jsxs(be,{children:[e.jsx(L,{index:!0,element:e.jsx(c,{})}),e.jsx(L,{path:"posts",element:e.jsx(g,{})}),e.jsx(L,{path:"connections",element:e.jsx(V,{profileId:l.id,checkStatus:"accepted"})}),x&&e.jsx(L,{path:"create",element:e.jsx(h,{})}),e.jsx(L,{path:"groups",element:e.jsx(y,{})}),e.jsx(L,{path:"ads",element:e.jsx(m,{})}),x&&e.jsx(L,{path:"notifications/*",element:e.jsx(et,{profileId:l.id})})]})]})})}export{yt as default};
