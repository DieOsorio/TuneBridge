import{j as e,n as v,t as N,f as F,g as T,h as _,i as O,k as C,m as D,l as j}from"./mui-COfzhOQm.js";import{u as y,a as M,h as X,J as A,P as L,L as $,B as w,E as P,A as H,K as R,M as Y,i as B,w as k,R as E,g,O as z}from"./index--knYYYFr.js";import{K,L as U,N as J}from"./icons-Cu9gFVBg.js";import{c as b,g as Q,a as q,e as V,C as W,b as Z}from"./ConnectionCard-Dip7kenv.js";import{P as ee}from"./PlusButton-DZLwBagF.js";import{r as se}from"./filepond-C4Y8_Bzv.js";import"./reactPlayer-DGEX9vCu.js";import"./lottie-Qij33HW6.js";import"./gsap-Brfk6Bdo.js";import"./index-cpdcplt_.js";/* empty css                 */const te=({groupData:a,CanManageGroup:l})=>{const{t:s}=y("profileGroup",{keyPrefix:"groupHeader"}),{user:o}=M(),t=X(),c=`/group/${a.id}`,n="!bg-amber-950 hover:!bg-gray-900/60 hover:!text-white",{followGroup:r,unfollowGroup:u,checkFollowStatus:d,countFollowers:m}=A(),{data:h,isLoading:i}=d(a.id,o==null?void 0:o.id),{data:x}=m(a.id),f=!!h,p=async()=>{i||!o||(f?await u({profile_group_id:a.id,follower_profile_id:o.id}):await r({profile_group_id:a.id,follower_profile_id:o.id}))},S=f?"bg-neutral-900 hover:bg-amber-950":"bg-amber-950 hover:bg-gray-900/60",G=s(f?"badges.status.following":"badges.status.follow"),I=f?e.jsx(U,{className:"text-amber-600"}):e.jsx(J,{className:"text-amber-600"});return e.jsxs("div",{className:"relative bg-gradient-to-r md:min-w-2xl lg:min-w-4xl from-amber-950 to-amber-800 mb-4 p-4 rounded-b-lg",children:[e.jsxs("div",{className:"flex flex-col gap-6 sm:flex-row sm:items-center",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-grow",children:[e.jsx(L,{avatar_url:a.avatar_url,className:"flex-shrink-0 !w-24 !h-24"}),e.jsxs("div",{className:"flex flex-col gap-2 flex-grow",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-white break-words",children:a.name}),e.jsx("p",{className:"text-gray-200 break-words",children:a.bio})]})]}),e.jsx("div",{className:"flex gap-4 ml-auto items-center mb-auto",children:l&&e.jsx(K,{className:"w-8 h-8 text-white cursor-pointer",onClick:()=>t(`${c}/settings`),title:s("btnTitles.settings")})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-center md:justify-end mt-6 flex-wrap",children:[e.jsxs("div",{className:"flex items-center gap-3 sm:mr-auto mt-auto",children:[!l&&o&&e.jsxs("button",{onClick:p,disabled:i,title:s(f?"btnTitles.unfollow":"btnTitles.follow"),className:`${S} cursor-pointer inline-flex items-center gap-1 px-3.5 py-1.5 rounded-full text-sm font-semibold whitespace-nowrap transition`,children:[I,G]}),x!==void 0&&e.jsx($,{to:`${c}/followers`,className:"text-sm font-medium text-gray-300 hover:underline",title:s("followersCount",{count:x}),children:s("followersCount",{count:x})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-4",children:e.jsx(w,{className:n,onClick:()=>t(c),children:s("nav.about")})}),e.jsx("div",{className:"sm:mb-4",children:e.jsx(w,{className:n,onClick:()=>t(`${c}/posts`),children:s("nav.posts")})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-4",children:e.jsx(w,{className:n,onClick:()=>t(c),children:s("nav.media")})}),l&&e.jsx("div",{className:"sm:mb-4",children:e.jsx(w,{className:n,onClick:()=>t(`${c}/calendar`),children:s("nav.calendar")})})]})]})]})};function ae(a,l,s){const[o,t]=v(s==null?void 0:s.in,a,l),c=o.getFullYear()-t.getFullYear(),n=o.getMonth()-t.getMonth();return c*12+n}function re(a,l){return+N(a)-+N(l)}function ne(a,l){const s=N(a,l==null?void 0:l.in);return+F(s,l)==+T(s,l)}function le(a,l,s){const[o,t,c]=v(s==null?void 0:s.in,a,a,l),n=b(t,c),r=Math.abs(ae(t,c));if(r<1)return 0;t.getMonth()===1&&t.getDate()>27&&t.setDate(30),t.setMonth(t.getMonth()-n*r);let u=b(t,c)===-n;ne(o)&&r===1&&b(o,c)===1&&(u=!1);const d=n*(r-+u);return d===0?0:d}function oe(a,l,s){const o=re(a,l)/1e3;return Q(s==null?void 0:s.roundingMethod)(o)}function ie(a,l,s){const o=O(),t=(s==null?void 0:s.locale)??o.locale??C,c=2520,n=b(a,l);if(isNaN(n))throw new RangeError("Invalid time value");const r=Object.assign({},s,{addSuffix:s==null?void 0:s.addSuffix,comparison:n}),[u,d]=v(s==null?void 0:s.in,...n>0?[l,a]:[a,l]),m=oe(d,u),h=(_(d)-_(u))/1e3,i=Math.round((m-h)/60);let x;if(i<2)return s!=null&&s.includeSeconds?m<5?t.formatDistance("lessThanXSeconds",5,r):m<10?t.formatDistance("lessThanXSeconds",10,r):m<20?t.formatDistance("lessThanXSeconds",20,r):m<40?t.formatDistance("halfAMinute",0,r):m<60?t.formatDistance("lessThanXMinutes",1,r):t.formatDistance("xMinutes",1,r):i===0?t.formatDistance("lessThanXMinutes",1,r):t.formatDistance("xMinutes",i,r);if(i<45)return t.formatDistance("xMinutes",i,r);if(i<90)return t.formatDistance("aboutXHours",1,r);if(i<D){const f=Math.round(i/60);return t.formatDistance("aboutXHours",f,r)}else{if(i<c)return t.formatDistance("xDays",1,r);if(i<j){const f=Math.round(i/D);return t.formatDistance("xDays",f,r)}else if(i<j*2)return x=Math.round(i/j),t.formatDistance("aboutXMonths",x,r)}if(x=le(d,u),x<12){const f=Math.round(i/j);return t.formatDistance("xMonths",f,r)}else{const f=x%12,p=Math.trunc(x/12);return f<3?t.formatDistance("aboutXYears",p,r):f<9?t.formatDistance("overXYears",p,r):t.formatDistance("almostXYears",p+1,r)}}function ce(a,l){return ie(a,q(a),l)}function de({group:a,members:l}){var c;const{t:s,i18n:o}=y("profileGroup"),t=o.language==="es"?V:C;return e.jsxs("div",{className:"space-y-6",children:[((c=a.genres)==null?void 0:c.length)>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:a.genres.map((n,r)=>e.jsx("span",{className:"px-3 py-1 rounded bg-amber-950 text-sm",children:n},r))}),e.jsxs("div",{className:"grid grid-cols-2 sm:grid-cols-3 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-3xl font-bold",children:l.length}),e.jsx("p",{className:"text-gray-400 text-sm",children:s("groupAbout.stats.members")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-3xl font-bold",children:"—"}),e.jsx("p",{className:"text-gray-400 text-sm",children:s("groupAbout.stats.posts")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-3xl font-bold",children:"—"}),e.jsx("p",{className:"text-gray-400 text-sm",children:s("groupAbout.stats.events")})]})]}),e.jsx("div",{className:"max-h-64 overflow-y-auto border border-amber-700 rounded p-3 bg-amber-900 scrollbar-custom",children:l.length===0?e.jsx("p",{className:"text-gray-400 text-center",children:s("groupAbout.noMembers")}):e.jsx("ul",{className:"space-y-3",children:l.map(n=>{var r,u;return e.jsxs("li",{className:"flex items-center justify-between bg-gradient-to-r from-amber-950 rounded-2xl p-2 min-h-22 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-grow min-w-0",children:[e.jsx(L,{avatar_url:((r=n==null?void 0:n.profiles)==null?void 0:r.avatar_url)||"",className:"!w-15 !h-15 rounded-full flex-shrink-0"}),e.jsxs("div",{className:"flex flex-col text-gray-300 truncate",children:[e.jsx("span",{className:"font-semibold truncate",children:((u=n.profiles)==null?void 0:u.username)||"Unknown"}),e.jsx("p",{className:"text-sm truncate",children:s(`groupMembersList.role.${n.role.toLowerCase()}`,n.role)}),n.roles_in_group&&n.roles_in_group.length>0&&e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:n.roles_in_group.map((d,m)=>e.jsx("span",{className:"bg-emerald-800 text-white text-xs px-2 py-0.5 rounded-full",children:d},m))})]})]}),e.jsx("div",{className:"hidden md:flex flex-col items-end text-gray-300 text-xs min-w-[100px]",children:e.jsx("span",{children:n.joined_at?s("groupAbout.joined",{days:ce(new Date(n.joined_at),{addSuffix:!0,locale:t})}):s("groupAbout.joinedNA")})})]},n.profile_id)})})})]})}function fe({groupId:a,CanManageGroup:l}){return e.jsx("div",{children:l&&e.jsx(ee,{to:{pathname:"/create-post",state:{groupId:a}},label:"create post",color:"amber"})})}function ue(){return e.jsx("div",{children:"GroupCalendar"})}const xe=({groupId:a})=>{const{user:l}=M(),{t:s}=y("profileGroup",{keyPrefix:"followersList"}),{followersInfiniteQuery:o}=A(),{data:t,fetchNextPage:c,hasNextPage:n,isFetchingNextPage:r,isLoading:u,isError:d,error:m}=o(a),h=se.useMemo(()=>(t==null?void 0:t.pages.flatMap(i=>i))??[],[t]);return u?e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-4",children:Array.from({length:8}).map((i,x)=>e.jsx(W,{},x))}):d?e.jsx(P,{error:m.message}):h.length===0?e.jsx("p",{className:"text-gray-400",children:s("connection.messages.noFollowers")}):e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-3 md:grid-cols-4 mx-auto sm:mx-0 sm:mr-auto gap-4",children:h.map(i=>e.jsx(Z,{profileId:i.follower_profile_id,ownProfile:!1},i.follow_id))}),n&&e.jsx("button",{onClick:()=>c(),disabled:r,className:"self-center cursor-pointer mt-4 px-4 py-2 rounded bg-amber-950 text-white hover:bg-amber-800",children:s(r?"connection.loadingMore":"connection.loadMore")})]})};function _e(){const{groupId:a}=H(),{user:l}=M(),{fetchProfileGroup:s}=R(),{data:o,isLoading:t,error:c}=s(a),{fetchGroupMembers:n}=Y(),{data:r,isLoading:u,error:d}=n(a);if(t||u||!Array.isArray(r))return e.jsx(B,{});if(c||d)return e.jsx(P,{error:(c==null?void 0:c.message)||(d==null?void 0:d.message)});if(!o)return e.jsx(k,{to:"/",replace:!0});const h=r==null?void 0:r.find(f=>f.profile_id===l.id),i=(h==null?void 0:h.role)==="admin",x=i||(h==null?void 0:h.role)==="manager";return e.jsx("div",{className:"flex flex-col min-h-screen text-white",children:e.jsxs("div",{className:"max-w-5xl mx-auto p-6 space-y-6",children:[e.jsx(te,{groupData:o,CanManageGroup:x}),e.jsxs(E,{children:[e.jsx(g,{index:!0,element:e.jsx(de,{group:o,members:r})}),e.jsx(g,{path:"posts/*",element:e.jsx(fe,{groupId:a,CanManageGroup:x})}),e.jsx(g,{path:"followers",element:e.jsx(xe,{groupId:a})}),i&&e.jsxs(e.Fragment,{children:[e.jsx(g,{path:"calendar",element:e.jsx(ue,{groupId:a})}),e.jsx(g,{path:"edit",element:e.jsx(z,{group:o,onSave:()=>window.history.back(),onCancel:()=>window.history.back()})})]}),e.jsx(g,{path:"*",element:e.jsx(k,{to:"",replace:!0})})]})]})})}export{_e as default};
