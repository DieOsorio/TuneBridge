import{j as e,B as me}from"./mui-DntPDMdt.js";import{a as Y,D as Ce,G as Pe,j as xe,L as F,u as R,ai as ue,P as ee,b as he,aj as Le,c as ge,k as _e,h as Se,g as ze,ag as Ee,ak as Me,E as te,aa as $e,af as fe}from"./index-BXZZvcoM.js";import{r,U as Re}from"./calendar-DXWKnWXk.js";import{G as Ae,L as Oe}from"./icons-DoyJ_9a6.js";import{u as Fe,h as Be}from"./useCanSendDM-Bil0jUUT.js";import{S as j}from"./index-BXOMkYts.js";/* empty css                 */import{m as se}from"./proxy-Dy5uTOz-.js";import{F as Ie}from"./EllipsisVerticalIcon-C3aSX2lf.js";import{S as ne,N as He,P as re,a as ie,Z as oe,b as le}from"./swiper-Bk_-ZTox.js";import{P as K}from"./PlusButton--f28TQAD.js";function Ze({title:t,titleId:s,...a},n){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},a),t?r.createElement("title",{id:s},t):null,r.createElement("path",{d:"m11.645 20.91-.007-.003-.022-.012a15.247 15.247 0 0 1-.383-.218 25.18 25.18 0 0 1-4.244-3.17C4.688 15.36 2.25 12.174 2.25 8.25 2.25 5.322 4.714 3 7.688 3A5.5 5.5 0 0 1 12 5.052 5.5 5.5 0 0 1 16.313 3c2.973 0 5.437 2.322 5.437 5.25 0 3.925-2.438 7.111-4.739 9.256a25.175 25.175 0 0 1-4.244 3.17 15.247 15.247 0 0 1-.383.219l-.022.012-.007.004-.003.001a.752.752 0 0 1-.704 0l-.003-.001Z"}))}const ce=r.forwardRef(Ze);function De({title:t,titleId:s,...a},n){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},a),t?r.createElement("title",{id:s},t):null,r.createElement("path",{d:"M21.731 2.269a2.625 2.625 0 0 0-3.712 0l-1.157 1.157 3.712 3.712 1.157-1.157a2.625 2.625 0 0 0 0-3.712ZM19.513 8.199l-3.712-3.712-8.4 8.4a5.25 5.25 0 0 0-1.32 2.214l-.8 2.685a.75.75 0 0 0 .933.933l2.685-.8a5.25 5.25 0 0 0 2.214-1.32l8.4-8.4Z"}),r.createElement("path",{d:"M5.25 5.25a3 3 0 0 0-3 3v10.5a3 3 0 0 0 3 3h10.5a3 3 0 0 0 3-3V13.5a.75.75 0 0 0-1.5 0v5.25a1.5 1.5 0 0 1-1.5 1.5H5.25a1.5 1.5 0 0 1-1.5-1.5V8.25a1.5 1.5 0 0 1 1.5-1.5h5.25a.75.75 0 0 0 0-1.5H5.25Z"}))}const pe=r.forwardRef(De);function Ge({title:t,titleId:s,...a},n){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},a),t?r.createElement("title",{id:s},t):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9 12.75 3 3m0 0 3-3m-3 3v-7.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const Te=r.forwardRef(Ge);function Ve({title:t,titleId:s,...a},n){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},a),t?r.createElement("title",{id:s},t):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m15 11.25-3-3m0 0-3 3m3-3v7.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const Ue=r.forwardRef(Ve);function We({title:t,titleId:s,...a},n){return r.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:n,"aria-labelledby":s},a),t?r.createElement("title",{id:s},t):null,r.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12.76c0 1.6 1.123 2.994 2.707 3.227 1.087.16 2.185.283 3.293.369V21l4.076-4.076a1.526 1.526 0 0 1 1.037-.443 48.282 48.282 0 0 0 5.68-.494c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z"}))}const Qe=r.forwardRef(We),qe=()=>{const t="#a1a1aa",s="#e4e4e7";return e.jsxs(se.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2},className:"absolute z-50 p-4 rounded-lg shadow-md bg-neutral-100 dark:bg-neutral-900 w-64 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(j,{circle:!0,width:40,height:40,baseColor:t,highlightColor:s}),e.jsxs("div",{className:"flex-1 space-y-1",children:[e.jsx(j,{width:80,height:10,baseColor:t,highlightColor:s}),e.jsx(j,{width:100,height:8,baseColor:t,highlightColor:s})]})]}),e.jsxs("div",{className:"space-y-1 mb-3",children:[e.jsx(j,{height:8,width:"100%",baseColor:t,highlightColor:s}),e.jsx(j,{height:8,width:"90%",baseColor:t,highlightColor:s}),e.jsx(j,{height:8,width:"80%",baseColor:t,highlightColor:s}),e.jsx(j,{height:8,width:"70%",baseColor:t,highlightColor:s})]}),e.jsxs("div",{className:"flex justify-end items-center gap-5 pt-2",children:[e.jsx(j,{width:30,height:30,baseColor:t,highlightColor:s}),e.jsx(j,{width:30,height:30,baseColor:t,highlightColor:s}),e.jsx(j,{width:30,height:30,baseColor:t,highlightColor:s})]})]})};function de(t){return t.username!==void 0}const Je=({profile:t,isLoading:s,isGroup:a})=>{const{user:n}=Y(),i=!!n,{findConversation:o,createConversation:d}=Ce(),{addParticipant:x}=Pe(),{canSend:g,loading:b}=Fe(t.id),[P,l]=r.useState(!1),w=s||b,c=xe(),k=i&&(n==null?void 0:n.id)===t.id,z=async({conversation_id:_,profile_id:O})=>x({conversation_id:_,profile_id:O,role:"member"}),f=()=>{if(!P){if(!i||!n){c("/login");return}!a&&"username"in t&&Be({myProfileId:n.id,otherProfile:t,findConversation:o,createConversation:d,addParticipant:z,navigate:c,setLoading:()=>l(!0)})}};if(w)return e.jsx(qe,{});if(!t)return null;const{state:v,country:y,bio:u,avatar_url:M,id:L}=t,A=de(t)?t.username:null,$=de(t)?null:t.name;return e.jsxs(se.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},transition:{duration:.2},className:"absolute z-50 p-4 rounded-lg shadow-md bg-neutral-100 dark:bg-neutral-900 w-64 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx(F,{to:a?`/group/${L}`:`/profile/${L}`,children:e.jsx("img",{src:M??void 0,alt:`Avatar of ${A||$}`,className:"w-10 h-10 rounded-full object-cover"})}),e.jsxs("div",{className:"ml-6",children:[e.jsxs("p",{className:"font-semibold text-center text-neutral-900 dark:text-neutral-100 mb-2",children:["@",A||$]}),(v||y)&&e.jsxs("p",{className:"text-neutral-400 text-xs",children:[v,v&&y?", ":"",y]})]})]}),u&&e.jsx("p",{className:"text-neutral-600 dark:text-neutral-300 line-clamp-4",children:u.length>50?`${u.slice(0,100)}...`:u}),e.jsxs("div",{className:"flex justify-end items-center gap-5 pt-2",children:[k&&e.jsx(F,{title:"Edit Profile",to:"/settings/profile",className:"text-neutral-400 cursor-pointer hover:text-neutral-900 dark:hover:text-neutral-100 transition",children:e.jsx(pe,{className:"w-7 h-7"})}),e.jsx(F,{title:"View Posts",to:a?`/group/${L}/posts`:`/profile/${L}/posts`,className:"text-neutral-400 cursor-pointer hover:text-neutral-900 dark:hover:text-neutral-100 transition",children:e.jsx(Ae,{size:28})}),g&&!a&&e.jsx("button",{title:"Send Message",className:"text-neutral-400 cursor-pointer hover:text-neutral-900 dark:hover:text-neutral-100 transition",onClick:f,children:e.jsx(Qe,{className:"w-7 h-7"})})]})]})};function Ke({onChange:t,onSubmit:s,onCancel:a,value:n}){const{t:i}=R("comments"),o=d=>{t(d.target.value)};return e.jsxs("div",{className:"flex-1 mt-2 w-full place-items-end",children:[e.jsx("textarea",{value:n,onChange:o,className:"bg-gray-100 dark:bg-zinc-700 p-3 rounded-lg shadow-sm w-150",rows:2,placeholder:i("card.placeholder")}),e.jsxs("div",{className:"flex gap-2 mt-2",children:[e.jsx("button",{onClick:s,className:"px-3 py-1 bg-sky-700 hover:bg-sky-800 text-white rounded text-sm",children:i("card.buttons.reply")}),e.jsx("button",{onClick:a,className:"px-3 py-1 bg-gray-600 hover:bg-gray-700 text-white rounded text-sm",children:i("card.buttons.cancel")})]})]})}function Xe({value:t,onChange:s,onSave:a,onCancel:n}){const{t:i}=R("common"),o=d=>{s(d.target.value)};return e.jsxs("div",{className:"flex-1 mt-2 place-items-end",children:[e.jsx("textarea",{value:t,onChange:o,className:"w-100 p-2 rounded-md border border-zinc-300 dark:border-zinc-600 bg-white dark:bg-zinc-900 text-zinc-800 dark:text-zinc-100 resize-none",rows:2}),e.jsxs("div",{className:"flex gap-2 mt-2 justify-center",children:[e.jsx("button",{onClick:a,className:"px-3 py-1 w-18 bg-emerald-600 hover:bg-emerald-700 text-white rounded text-sm",children:i("generic.save")}),e.jsx("button",{onClick:n,className:"px-3 py-1 w-18 bg-gray-600 hover:bg-gray-700 text-white rounded text-sm",children:i("generic.cancel")})]})]})}const Ye=r.memo(Xe);function et({onMenu:t,onEdit:s,onDelete:a,isMenuOpen:n,menuRef:i}){const{t:o}=R("common");return e.jsxs("div",{className:"relative",ref:i,children:[e.jsx("button",{onClick:t,className:"cursor-pointer text-zinc-500 hover:text-zinc-700 dark:hover:text-zinc-300 text-xl px-2",children:e.jsx(Ie,{className:"w-6 h-6"})}),n&&e.jsxs("div",{className:"absolute right-4 top-7 w-32 bg-white dark:bg-zinc-900 border border-zinc-800 dark:border-zinc-700 rounded shadow-lg z-10",children:[e.jsx("button",{onClick:s,className:"block cursor-pointer w-full text-center px-4 py-2 text-sm hover:bg-zinc-100 dark:hover:bg-zinc-800",children:o("generic.edit")}),e.jsx("div",{className:"border-t border-zinc-300 dark:border-zinc-700"}),e.jsx("button",{onClick:a,className:"block cursor-pointer w-full text-center px-4 py-2 text-sm hover:bg-red-100 dark:hover:bg-red-950 text-red-600 dark:text-red-400",children:o("generic.delete")})]})]})}const tt=r.memo(et),je=({comment:t,profile:s,onDelete:a,onSaveEdit:n,replies:i=[],profilesMap:o,onReplySubmit:d,currentUserId:x})=>{const{t:g}=R("comments"),[b,P]=r.useState(!1),[l,w]=r.useState(!1),[c,k]=r.useState(""),[z,f]=r.useState(null),[v,y]=r.useState(!1),[u,M]=r.useState(t.content),{commentLikesQuery:L,insertLike:A,deleteLike:$}=ue(),{data:_=[],isLoading:O}=L(t.id),m=z===t.id,B=x===t.profile_id,h=r.useRef(null);r.useEffect(()=>{function p(Z){m&&h.current&&!h.current.contains(Z.target)&&f(null)}return document.addEventListener("mousedown",p),()=>{document.removeEventListener("mousedown",p)}},[m]);const C=()=>(_==null?void 0:_.filter(p=>p.comment_id===t.id))||[],E=()=>C().some(p=>p.profile_id===x),I=()=>C().find(p=>p.profile_id===x),T=async()=>{if(!x)return;const p=I();p?await $(p):await A({comment_id:t.id,profile_id:x})},V=r.useCallback(()=>{c.trim()!==""&&(d({content:c,parent_id:t.id}),k(""),w(!1))},[c,t.id,d]),U=r.useCallback(()=>{k(""),w(!1)},[]),H=r.useCallback(()=>{n(t.id,t.post_id,u),y(!1)},[t.id,t.post_id,u,n]),W=r.useCallback(()=>{y(!1),M(t.content)},[t.content]),Q=r.useCallback(()=>{f(m?null:t.id)},[t.id,m]),q=b?i.slice(-10):[];return e.jsxs("div",{className:"flex mb-4",children:[e.jsx(F,{to:`/profile/${s==null?void 0:s.id}`,children:e.jsx(ee,{avatar_url:s==null?void 0:s.avatar_url,className:"!w-8 !h-8 mr-3 flex-shrink-0",alt:`${s==null?void 0:s.username}'s avatar`,gender:s==null?void 0:s.gender})}),e.jsxs("div",{className:"flex flex-col w-full",children:[e.jsxs("div",{className:"bg-zinc-900 p-3 rounded-lg shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("div",{className:"font-semibold text-zinc-700 dark:text-zinc-300",children:(s==null?void 0:s.username)||g("card.anonymous")}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"text-xs text-zinc-500",children:new Date(t.updated_at||t.created_at).toLocaleString()}),B&&e.jsx(tt,{menuRef:h,onDelete:()=>a(t),onEdit:()=>y(!0),onMenu:Q,isMenuOpen:m})]})]}),e.jsx("div",{className:"text-zinc-600 dark:text-zinc-300 mt-1",children:t.content}),e.jsxs("div",{className:"flex gap-4 mt-2 text-xs text-sky-700 dark:text-sky-500",children:[e.jsxs("button",{className:"flex items-center gap-1 hover:underline disabled:opacity-50",onClick:T,disabled:O,children:[e.jsx("span",{children:E()?g("card.liked"):g("card.like")}),e.jsx("span",{children:C().length})]}),e.jsx("button",{className:"hover:underline",onClick:()=>w(!l),children:g("card.reply")})]})]}),v&&e.jsx(Ye,{value:u,onChange:M,onSave:H,onCancel:W}),l&&e.jsx(Ke,{value:c,onChange:k,onSubmit:V,onCancel:U}),i.length>0&&e.jsxs("div",{className:"mt-4 border-zinc-300 dark:border-zinc-700",children:[e.jsx("button",{onClick:()=>P(!b),className:"flex items-center gap-1 text-sm font-bold text-sky-600 mb-1.5 hover:underline",children:e.jsxs(e.Fragment,{children:[b?e.jsx(Ue,{className:"w-5 h-5 text-sky-500"}):e.jsx(Te,{className:"w-5 h-5 text-sky-500"}),i.length===1?g("card.replies",{count:i.length}):g("card.repliesPlural",{count:i.length})]})}),b&&q.map(p=>e.jsx(je,{comment:p,profile:o[p.profile_id],onDelete:a,onSaveEdit:n,replies:p.replies||[],profilesMap:o,onReplySubmit:d,currentUserId:x},p.id))]})]})]})},st=r.memo(je);function at({postId:t}){var B;const{t:s}=R("comments"),{user:a}=Y(),{fetchProfile:n,profilesMap:i}=he(),{data:o,isLoading:d}=n((a==null?void 0:a.id)??null),{fetchComments:x,insertComment:g,updateComment:b,deleteComment:P}=Le(),{data:l,isLoading:w}=x(t),[c,k]=r.useState(!1),z=nt(l??[]),{data:f,isLoading:v}=i(z),{register:y,handleSubmit:u,reset:M,formState:{errors:L}}=ge();if(v||w||d)return e.jsx(_e,{});const $=async h=>{if(!(a!=null&&a.id))return;const C={post_id:t,profile_id:a.id,content:h.comment};try{await g(C),M()}catch(E){console.error("Couldn't insert comment",E)}},_=async h=>{try{await P(h)}catch(C){console.error("Error trying to delete comment",C)}},O=async(h,C,E)=>{try{await b({id:h,post_id:C,updatedComment:{content:E,updated_at:new Date().toISOString()}})}catch(I){console.error("Error updating comment",I)}},m=async h=>{if(!(a!=null&&a.id))return;const C={post_id:t,profile_id:a.id,content:h.content,parent_id:h.parent_id??null};try{await g(C)}catch(E){console.error("Could not insert reply",E)}};return e.jsxs("div",{className:"w-full mt-4 border-t pt-4 text-sm text-zinc-800 dark:text-zinc-100",children:[e.jsxs("div",{className:"mb-4",children:[(l==null?void 0:l.length)&&l.length>2&&!c&&e.jsx("button",{onClick:()=>k(!0),className:"mb-4 text-sky-700 dark:text-sky-400 text-sm hover:underline",children:s("box.loadMore")}),(B=c?l:l==null?void 0:l.slice(-2))==null?void 0:B.map(h=>e.jsx(st,{comment:h,profile:f==null?void 0:f[h.profile_id],onDelete:_,onSaveEdit:O,replies:h.replies,profilesMap:f??{},onReplySubmit:m,currentUserId:(a==null?void 0:a.id)??null},h.id)),(l==null?void 0:l.length)===0&&e.jsx("p",{className:"italic text-zinc-600",children:s("box.noComments")})]}),e.jsxs("form",{onSubmit:u($),className:"flex items-start gap-3 mt-4",children:[e.jsx(F,{to:`/profile/${o==null?void 0:o.id}`,children:e.jsx(ee,{avatar_url:o==null?void 0:o.avatar_url,className:"!w-10 !h-10",gender:o==null?void 0:o.gender,alt:`${o==null?void 0:o.username}'s avatar`})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("textarea",{...y("comment",{required:!0}),placeholder:s("box.placeholder"),className:"w-full p-2 rounded-md border border-zinc-300 dark:border-zinc-600 bg-white dark:bg-zinc-950 text-zinc-800 dark:text-zinc-100 resize-none",rows:2}),e.jsx("button",{type:"submit",className:"mt-2 px-4 py-1 bg-sky-700 hover:bg-sky-800 text-white rounded-md text-sm",children:s("box.send")}),L.comment&&e.jsx("span",{className:"text-red-500 text-xs",children:s("box.error")})]})]})]})}function nt(t=[]){const s=new Set;function a(n){for(const i of n)i.profile_id&&s.add(i.profile_id),Array.isArray(i.replies)&&i.replies.length>0&&a(i.replies)}return a(t),Array.from(s)}const rt=({children:t})=>e.jsxs("div",{className:`pointer-events-none absolute left-1/2 top-full mt-2 -translate-x-1/2
               whitespace-nowrap rounded-md bg-gray-900/90 py-1 px-2 text-xs
               font-semibold text-sky-200 shadow-lg backdrop-blur`,children:[t,e.jsx("div",{className:"absolute -top-1 left-1/2 -translate-x-1/2 h-2 w-2 rotate-45 bg-gray-900/90"})]});function G({post:t}){const{t:s}=R("posts"),{user:a}=Y(),n=!!a,i=xe(),[o,d]=r.useState(!1),[x,g]=r.useState(!1),[b,P]=r.useState(!1),[l,w]=r.useState(!1),[c,k]=r.useState(null),{fetchProfile:z}=he(),{data:f,error:v,isLoading:y}=z(t.profile_id),u=!!t.group_id,{fetchProfileGroup:M}=Se(),{data:L,isLoading:A}=M(t.group_id??""),{userGroupRole:$}=ze(),{data:_,isLoading:O}=$({profileId:(a==null?void 0:a.id)??"",groupId:t.group_id??""}),m=u?L:f,{insertLike:B,deleteLike:h,userLikedPostQuery:C,postLikesQuery:E}=ue(),{data:I}=n?C(t.id,a.id):{data:void 0},{data:T=[]}=E(t.id),V=T.length,{getHashtagsByPostId:U}=Ee(),{data:H}=U(t.id),W=s("likes.count",{count:V}),Q=A||O||y,q=Me(),p=()=>{q(t.profile_id),g(!0)},Z=n?{profile_id:a==null?void 0:a.id,post_id:t.id}:null,D=!!I,be=()=>{if(!n){i("/login");return}D?h({...I,post_id:t.id,profile_id:(a==null?void 0:a.id)||""}):Z&&B(Z)},we=()=>{i(`/edit-post/${t.id}`)},J=N=>{k(N),w(!0)},ae=()=>{w(!1),k(null)},ve=()=>{if(!n){i("/login");return}P(N=>!N)};if(v)return e.jsx(te,{error:v.message});const Ne=t.profile_id===(a==null?void 0:a.id),ke=n&&(!u&&Ne||u&&(_==="admin"||_==="manager"));return e.jsxs("div",{className:"bg-gradient-to-l to-gray-800 p-4 rounded-lg shadow-md mb-4 mx-auto max-w-3xl w-full",children:[e.jsx("h3",{className:`text-xl mb-4 font-semibold rounded-lg bg-gradient-to-l ${u?"to-amber-700":"to-sky-600"} p-4 text-gray-100`,children:t.title}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex sm:flex-col flex-row items-center",children:[m&&e.jsxs("div",{onMouseEnter:p,onMouseLeave:()=>g(!1),className:"relative mb-auto",children:[e.jsxs(F,{to:u?`/group/${m.id??""}`:`/profile/${m.id??""}`,children:[e.jsx("h2",{className:"font-bold text-lg text-gray-200",children:"username"in m?m.username:m.name}),e.jsx(ee,{avatar_url:m.avatar_url,className:"!w-15 !h-15 mx-auto",gender:"gender"in m?m.gender:void 0,alt:`${"username"in m?m.username:m.name}'s avatar`})]}),x&&e.jsx(Je,{profile:m,isLoading:Q,isGroup:u})]}),e.jsxs("div",{className:"flex sm:h-full sm:justify-end sm:flex-col items-end ml-auto sm:ml-0 gap-3 sm:gap-8 mt-6",children:[e.jsx("div",{className:"w-8 h-8 sm:w-10 sm:h-10 flex items-center justify-center",children:ke&&e.jsx(pe,{title:s("titles.updatePost"),className:"text-yellow-600 w-8 h-8 hover:text-yellow-700 cursor-pointer",onClick:we})}),e.jsx("div",{onMouseEnter:()=>d(!0),onMouseLeave:()=>d(!1),onClick:be,className:"relative cursor-pointer transition-transform duration-200 hover:scale-110",children:e.jsxs(se.div,{initial:{scale:1},animate:{scale:D?[1,1.4,1]:1},transition:{duration:.4},children:[D||o?e.jsx(ce,{className:"w-8 h-8 sm:w-10 sm:h-10 text-rose-600 transition-all"}):e.jsx(ce,{className:"w-8 h-8 sm:w-10 sm:h-10 text-rose-300"}),o&&e.jsx(rt,{children:W})]},D?"liked":"not-liked")}),e.jsx(Oe,{title:s("titles.comments"),onClick:ve,className:`text-gray-400 cursor-pointer w-8 h-8 transition-all ${u?"hover:text-amber-700":"hover:text-sky-600"} ${b&&!u?"text-sky-600":"text-amber-700"} sm:!w-10 sm:!h-10`})]})]}),e.jsx("div",{className:"w-full max-w-[600px] flex-1 mx-auto bg-gradient-to-l from-gray-900 rounded-md hidden sm:flex",children:t.images_urls&&t.images_urls.length>0?e.jsx(ne,{modules:[He,re,ie,oe],slidesPerView:1,navigation:!0,pagination:{clickable:!0},scrollbar:{draggable:!0},style:{width:"100%",height:"100%"},children:t.images_urls.map((N,S)=>e.jsx(le,{children:e.jsx("img",{src:N,alt:`Post image ${S}`,className:"w-full max-h-[500px] object-contain rounded cursor-pointer",style:{maxWidth:"100%",height:"auto",display:"block",margin:"0 auto"},onClick:()=>J(N)})},S))}):e.jsx("p",{className:"font-semibold m-auto text-center text-gray-400",children:s("messages.noImages")})}),e.jsx("div",{className:"w-full mx-auto p-0 bg-gradient-to-l from-gray-900 rounded-md block sm:hidden",children:t.images_urls&&t.images_urls.length>0?t.images_urls.length===1?e.jsx("img",{src:t.images_urls[0],alt:"Post image",className:"w-full h-[60vw] min-h-[180px] max-h-[70vh] object-contain rounded cursor-pointer",onClick:()=>t.images_urls&&J(t.images_urls[0])}):e.jsx(ne,{modules:[re,ie,oe],slidesPerView:1,pagination:{clickable:!0},scrollbar:{draggable:!0},style:{minHeight:"60vw",maxHeight:"70vh"},children:t.images_urls.map((N,S)=>e.jsx(le,{children:e.jsx("img",{src:N,alt:`Post image ${S}`,className:"w-full h-full min-h-[180px] max-h-[70vh] object-contain rounded cursor-pointer",onClick:()=>J(N)})},S))}):e.jsx("p",{className:"font-semibold text-center text-white",children:s("messages.noImages")})})]}),l&&e.jsx("div",{className:"fixed inset-0 bg-black/80 flex items-center justify-center z-50",onClick:ae,children:e.jsxs("div",{className:"relative max-w-full max-h-full p-4",onClick:N=>N.stopPropagation(),children:[e.jsx("button",{className:"absolute top-1 right-1 text-white hover:text-red-100 cursor-pointer z-10",onClick:ae,children:e.jsx($e,{className:"w-7 h-7"})}),e.jsx("img",{src:c??void 0,alt:"Full-size post image",className:"max-w-[90vw] max-h-[80vh] object-contain rounded-md shadow-lg"})]})}),H&&H.length>0&&H.filter(N=>N.hashtags!==void 0).map(N=>{const S=N.hashtags.name,ye=S.startsWith("#")?S.slice(1):S;return e.jsx(F,{to:`/hashtag/${ye}`,className:"text-sm mx-1 text-sky-500 hover:underline",children:S},N.hashtag_id)}),e.jsx("p",{className:`text-gray-300 mx-auto rounded-md bg-gray-900 font-semibold border-1 sm:ml-auto sm:w-140 p-4 my-4 ${u?"border-amber-700":"border-sky-700"}`,children:t.content}),b&&e.jsx(at,{postId:t.id})]})}function X(){const t="#a1a1aa",s="#e4e4e7";return e.jsxs("div",{className:"bg-gradient-to-l to-gray-800 p-4 rounded-lg shadow-md mb-4 mx-auto max-w-3xl w-full",children:[e.jsx(j,{height:60,baseColor:t,highlightColor:s,className:"mb-4 rounded-lg"}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex sm:flex-col flex-row items-center sm:items-start gap-4 sm:gap-6 w-full sm:w-auto",children:[e.jsxs("div",{className:"flex flex-col items-center gap-2 sm:mb-auto",children:[e.jsx(j,{width:80,height:14,baseColor:t,highlightColor:s}),e.jsx(j,{circle:!0,width:60,height:60,baseColor:t,highlightColor:s})]}),e.jsx("div",{className:"flex sm:flex-col items-center justify-center gap-4 sm:gap-6 ml-auto sm:ml-5 sm:mt-6",children:[...Array(3)].map((a,n)=>e.jsx(j,{circle:!0,width:40,height:40,baseColor:t,highlightColor:s},n))})]}),e.jsx("div",{className:"w-full max-w-[600px] mx-auto p-4 bg-gradient-to-l from-gray-900 rounded-md",children:e.jsx(j,{height:300,className:"w-full rounded-md",baseColor:t,highlightColor:s})})]}),e.jsx("div",{className:"flex justify-center gap-3 mt-4 flex-wrap",children:[...Array(3)].map((a,n)=>e.jsx(j,{width:80,height:20,baseColor:t,highlightColor:s,className:"rounded"},n))}),e.jsx("div",{className:"max-w-[600px] mx-auto",children:e.jsx(j,{height:80,className:"rounded-md mt-6",baseColor:t,highlightColor:s})})]})}const it=()=>{const{t}=R(["posts","common"]),{searchPosts:s,infinitePosts:a}=fe(),{register:n,handleSubmit:i,watch:o}=ge({defaultValues:{searchTerm:""}}),d=o("searchTerm"),{data:x,fetchNextPage:g,hasNextPage:b,isFetchingNextPage:P,isLoading:l,error:w}=a(),{data:c,isLoading:k}=s(d||""),z=()=>{};return l?e.jsx("div",{className:"flex flex-col gap-4 items-center",children:[...Array(7)].map((f,v)=>e.jsx(X,{},v))}):w?e.jsx(te,{error:w.message}):e.jsxs("div",{className:"flex flex-col mx-auto text-center",children:[e.jsxs("form",{onSubmit:i(z),className:"mb-5 relative flex items-center justify-center",children:[e.jsx("input",{type:"text",...n("searchTerm"),placeholder:t("posts:placeholders.searchPosts"),className:"border rounded-lg p-2 focus:outline-none focus:ring w-full max-w-md"}),e.jsx("div",{className:"absolute right-0 top-9 -translate-y-1/2 hidden lg:flex items-center group",children:e.jsx(K,{label:t("posts:buttons.createPost"),to:"/create-post",iconSize:28,showLabelOnMobile:!1})})]}),e.jsx("div",{className:"flex justify-center items-center lg:hidden mb-4 mr-6",children:e.jsx(K,{label:t("posts:buttons.createPost"),to:"/create-post",iconSize:32,showLabelOnMobile:!0})}),k?e.jsx("div",{className:"flex flex-col gap-4 items-center",children:[...Array(2)].map((f,v)=>e.jsx(X,{},v))}):d&&c&&c.length>0?c.map(f=>e.jsx(G,{post:f},f.id)):d?e.jsx("p",{className:"col-span-full text-center text-gray-500",children:t("posts:messages.noMatch")}):Array.isArray(x==null?void 0:x.pages)&&x.pages.length>0?x.pages.map((f,v)=>e.jsx(Re.Fragment,{children:f.map(y=>e.jsx(G,{post:y},y.id))},v)):e.jsx("p",{className:"col-span-full text-center text-gray-500",children:t("posts:messages.empty")}),b&&e.jsx(me,{className:"!w-1/2 md:!w-1/3 !font-bold mt-4 !mx-auto hover:!text-sky-600",onClick:()=>g(),disabled:P,children:t(P?"common:loading":"common:loadMore")})]})},bt=({profileId:t,posts:s,disableSearch:a=!1,isOwnProfile:n=!1})=>{const{t:i}=R(["posts","common"]),{infiniteUserPosts:o}=fe(),{data:d,fetchNextPage:x,hasNextPage:g,isFetchingNextPage:b,isLoading:P,error:l}=o(t??"",10);if(!t&&!a)return e.jsx(it,{});if(P)return e.jsx("div",{className:"flex flex-col gap-4 items-center",children:[...Array(3)].map((c,k)=>e.jsx(X,{},k))});if(l)return e.jsx(te,{error:l.message});const w=d?d.pages.flat():[];return s?e.jsx("div",{className:"mx-auto text-center w-full",children:e.jsx("div",{className:"grid grid-cols-1 gap-4",children:s.length>0?s.map(c=>e.jsx(G,{post:c},c.id)):e.jsx("p",{className:"col-span-full text-center text-gray-400",children:i("posts:messages.empty")})})}):e.jsxs("div",{className:"mx-auto text-center w-full",children:[n&&e.jsx("div",{className:"w-full flex justify-end mb-4 relative",children:e.jsx("div",{className:"group flex items-center",children:e.jsx(K,{label:i("posts:buttons.createPost"),to:"/create-post",iconSize:28,showLabelOnMobile:!0})})}),e.jsx("div",{className:"grid grid-cols-1 gap-4",children:w.length>0?w.map(c=>e.jsx(G,{post:c},c.id)):e.jsx("p",{className:"col-span-full text-center text-gray-500",children:i("posts:messages.empty")})}),g&&e.jsx(me,{className:"!w-1/2 md:!w-1/3 !font-bold mt-4 !mx-auto hover:!text-sky-600",onClick:()=>x(),disabled:b,children:i(b?"common:loading":"common:loadMore")})]})};export{bt as P};
