import{a as _,r as f,x as w}from"./index-C9aPbYQh.js";const h=async({myProfileId:i,otherProfile:e,findConversation:d,createConversation:s,addParticipant:l,navigate:r,setLoading:c=()=>{}})=>{try{c(!0);const n=await d({myProfileId:i,otherProfileId:e.id,all:!0});let t=null,a=null;if(Array.isArray(n)?(t=n.find(u=>!u.is_group),a=n.find(u=>u.is_group)):n&&typeof n=="object"&&(n.is_group?a=n:t=n),t){r(`/chat/${t.id}`);return}if(a){r(`/chat/${a.id}`);return}const o=await s({created_by:i,avatar_url:e.avatar_url,title:e.username});await l({conversation_id:o.id,profile_id:i}),await l({conversation_id:o.id,profile_id:e.id}),r(`/chat/${o.id}`)}catch(n){console.error("Error iniciando conversaci√≥n:",n)}finally{c(!1)}};function y(i){const{user:e}=_(),{privacyOthers:d}=f(),{data:s,isLoading:l}=d(i),{connectionBetweenProfiles:r}=w(),{data:c,isLoading:n}=r(e==null?void 0:e.id,i,{enabled:(s==null?void 0:s.allow_messages)==="connections_only"}),t=l||n;let a=!1,o="blocked";if(!t)switch(s==null?void 0:s.allow_messages){case"all":a=!0,o="ok";break;case"connections_only":a=(c==null?void 0:c.status)==="accepted",o=a?"ok":"not-connected";break;case"none":default:a=!1,o="blocked"}return{canSend:a,loading:t,reason:o}}export{h,y as u};
