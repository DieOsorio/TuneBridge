import{j as e}from"./mui-DM0ppf3M.js";import{u as C,a as I,c as P,K as T,S as B,I as b,T as z,L as R,B as A,G as J,J as K,j as O,k as W}from"./index-BXNurRLk.js";import{r as S}from"./calendar-BpW-aEGs.js";import{k as G}from"./icons-A8qOaPVA.js";import"./reactPlayer-CjHFj7G4.js";import"./lottie-DTlWc_fK.js";import"./gsap-Brfk6Bdo.js";import"./filepond-DcLflJls.js";const q=({defaultValues:a={},onSubmit:g,publisherId:d})=>{var N,_;const{t}=C("ads"),{user:x}=I(),{register:l,control:c,watch:p,handleSubmit:u,setValue:y,formState:{errors:o}}=P({defaultValues:{ad_type:a.ad_type,title:a.title??"",looking_for:a.looking_for??[],genres:a.genres??[],location:a.location??"",description:a.description??"",profile_id:d?null:(x==null?void 0:x.id)??null,group_id:d??null}}),i=T({control:c,name:"ad_type"}),[r,F]=S.useState(Array.isArray(a.looking_for)?a.looking_for:[]),[m,j]=S.useState(Array.isArray(a.genres)?a.genres:[]),v=((N=p("newLookingFor"))==null?void 0:N.trim())??"",k=((_=p("newGenre"))==null?void 0:_.trim())??"",L=(s,n,f,h)=>{s&&!n.includes(s)&&n.length<3&&(f([...n,s]),y(h,""))},w=(s,n,f)=>{f(n.filter(h=>h!==s))},E=s=>{const{newLookingFor:n,newGenre:f,...h}=s;g({...h,looking_for:r,genres:m})};return e.jsxs("form",{onSubmit:u(E),className:"space-y-4",children:[e.jsx(B,{id:"ad_type",label:t("adForm.labels.typeOfAd"),options:[{value:"looking",label:t("adForm.labels.looking")},{value:"offering",label:t("adForm.labels.offering")}],control:c,classForLabel:"text-gray-400",error:o.ad_type,search:!1}),e.jsx(b,{id:"title",label:t("adForm.labels.title"),placeholder:t("adForm.placeholders.title"),type:"text",register:l,maxLength:30,validation:{maxLength:{value:30,message:t("adForm.validations.title")}},error:o.title,classForLabel:"!text-gray-400"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{id:"newLookingFor",label:t(i==="offering"?"adForm.labels.offering":"adForm.labels.looking"),placeholder:t(i==="offering"?"adForm.placeholders.offering":"adForm.placeholders.looking"),type:"text",maxLength:12,register:l,validation:{maxLength:{value:12,message:t("adForm.validations.looking")}},classForLabel:"!text-gray-400",className:"!flex-1",error:o.looking_for}),e.jsx("button",{type:"button",onClick:()=>L(v,r,F,"newLookingFor"),disabled:!v||r.length>=3,className:"text-emerald-500 mt-6 cursor-pointer hover:text-emerald-700 p-2 rounded-full focus:outline-none focus:ring-2 focus:ring-green-400 transition-colors disabled:opacity-40 disabled:cursor-not-allowed",children:e.jsx(G,{size:22})})]}),r.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:r.map((s,n)=>e.jsxs("span",{className:"px-2 py-1 text-sm rounded bg-emerald-800 text-white flex items-center gap-2",children:[s,e.jsx("button",{type:"button",onClick:()=>w(s,r,F),className:"text-red-400 hover:text-red-600 font-bold",children:"×"})]},n))})]}),e.jsxs("div",{className:"flex flex-col gap-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{id:"newGenre",label:t("adForm.labels.genres"),placeholder:t("adForm.placeholders.genres"),type:"text",register:l,maxLength:12,validation:{maxLength:{value:12,message:t("adForm.validations.genre")}},classForLabel:"!text-gray-400",className:"!flex-1",error:o.genres}),e.jsx("button",{type:"button",onClick:()=>L(k,m,j,"newGenre"),disabled:!k||m.length>=3,className:"text-emerald-500 mt-6 cursor-pointer hover:text-emerald-700 p-2 rounded-full focus:outline-none focus:ring-2 focus:ring-green-400 transition-colors disabled:opacity-40 disabled:cursor-not-allowed",children:e.jsx(G,{size:22})})]}),m.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:m.map((s,n)=>e.jsxs("span",{className:"px-2 py-1 text-sm rounded bg-emerald-800 text-white flex items-center gap-2",children:[s,e.jsx("button",{type:"button",onClick:()=>w(s,m,j),className:"text-red-400 hover:text-red-600 font-bold",children:"×"})]},n))})]}),e.jsx(b,{id:"location",label:t("adForm.labels.location"),placeholder:t("adForm.placeholders.location"),type:"text",register:l,classForLabel:"!text-gray-400",error:o.location}),e.jsx(z,{id:"description",label:t("adForm.labels.description"),placeholder:t("adForm.placeholders.description"),register:l,validation:{maxLength:{value:200,message:t("adForm.validations.description")}},error:o.description,maxLength:200,watchValue:p("description"),classForLabel:"text-gray-400"}),e.jsxs("div",{className:"flex justify-center gap-4",children:[e.jsx(R,{to:"/ads",children:e.jsx(A,{className:"!bg-gray-600 hover:!bg-gray-700",children:t("adForm.buttons.cancel")})}),e.jsx(A,{className:"!bg-emerald-600 hover:!bg-emerald-700",type:"submit",children:t("adForm.buttons.save")})]})]})};function D(){const{t:a}=C("ads"),{id:g}=J(),d=!!g,{fetchAd:t,createAd:x,updateAd:l}=K(),{data:c,isLoading:p}=g?t(g):{data:void 0,isLoading:!1},u=O(),y=async o=>{try{const i={...o,genres:typeof o.genres=="string"?o.genres.split(",").map(r=>r.trim()):o.genres,looking_for:typeof o.looking_for=="string"?o.looking_for.split(",").map(r=>r.trim()):o.looking_for};d&&c?await l({ad:c,updates:i}):await x(i),u("/ads")}catch(i){console.error("Error saving ad:",i)}};return d&&p?e.jsx(W,{}):e.jsxs("div",{className:"max-w-3xl mx-auto p-6",children:[e.jsx("h1",{className:"text-2xl text-yellow-600 font-semibold text-center mb-4",children:a(d?"adCreateEditPage.title.edit":"adCreateEditPage.title.create")}),e.jsx(q,{defaultValues:c??void 0,onSubmit:y})]})}export{D as default};
