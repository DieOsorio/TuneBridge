import{n as Se,h as ne,i as Le,k as xe,m as ae,l as re,p as ie,q as W,s as Me,t as le,v as me,j as e}from"./mui-COfzhOQm.js";import{u as C,a as P,b as X,Z as Ie,h as fe,_ as Pe,Q as $e,y as De,z as Te,$ as ge,x as he,L as pe,P as Fe,B,r as Oe,D as Ae,q as Re,l as Ue,m as Be,p as Ee,o as ze,n as Ye,E as H,G as Ge,a0 as Ze,i as je,s as We,N as oe,R as be,g as L,A as He}from"./index--knYYYFr.js";import{b as qe,X as Je,w as J,y as ce,z as Qe,C as Ke,Y as Xe,K as Ve,Z as es,_ as ss,$ as ts,a0 as de,a1 as ns,a2 as as,a3 as ye,a4 as rs}from"./icons-Cu9gFVBg.js";import{r as k}from"./filepond-C4Y8_Bzv.js";import{u as is,h as ls}from"./useCanSendDM-DNspkOZS.js";import{L as os}from"./LoadingBadge-Iar71BDO.js";import{c as cs,g as ds,a as us,e as xs,b as ms}from"./ConnectionCard-Dip7kenv.js";import{S as we}from"./ShinyText-DqIsy4Ek.js";import{R as fs}from"./reactPlayer-DGEX9vCu.js";import{P as V}from"./PlusButton-DZLwBagF.js";import{S as E}from"./index-cpdcplt_.js";/* empty css                 */import{P as gs}from"./PostsList-zIiy_K-I.js";import hs from"./PostForm-CYpho7UB.js";import{a as ps,A as js}from"./AdsListSkeleton-tw-adV7x.js";import"./lottie-Qij33HW6.js";import"./gsap-Brfk6Bdo.js";import"./proxy-BXMBkS9E.js";import"./swiper-Ciezsct5.js";function bs(n,s,t){const a=Le(),r=(t==null?void 0:t.locale)??a.locale??xe,l=cs(n,s);if(isNaN(l))throw new RangeError("Invalid time value");const o=Object.assign({},t,{addSuffix:t==null?void 0:t.addSuffix,comparison:l}),[c,u]=Se(t==null?void 0:t.in,...l>0?[s,n]:[n,s]),d=ds((t==null?void 0:t.roundingMethod)??"round"),g=u.getTime()-c.getTime(),h=g/W,y=ne(u)-ne(c),f=(g-y)/W,w=t==null?void 0:t.unit;let j;if(w?j=w:h<1?j="second":h<60?j="minute":h<ae?j="hour":f<re?j="day":f<ie?j="month":j="year",j==="second"){const b=d(g/1e3);return r.formatDistance("xSeconds",b,o)}else if(j==="minute"){const b=d(h);return r.formatDistance("xMinutes",b,o)}else if(j==="hour"){const b=d(h/60);return r.formatDistance("xHours",b,o)}else if(j==="day"){const b=d(f/ae);return r.formatDistance("xDays",b,o)}else if(j==="month"){const b=d(f/re);return b===12&&w!=="month"?r.formatDistance("xYears",1,o):r.formatDistance("xMonths",b,o)}else{const b=d(f/ie);return r.formatDistance("xYears",b,o)}}function ys(n,s){return bs(n,us(n),s)}function ws(n,s){const t=()=>Me(s==null?void 0:s.in,NaN),r=Cs(n);let l;if(r.date){const d=_s(r.date,2);l=Ss(d.restDateString,d.year)}if(!l||isNaN(+l))return t();const o=+l;let c=0,u;if(r.time&&(c=Ls(r.time),isNaN(c)))return t();if(r.timezone){if(u=Ms(r.timezone),isNaN(u))return t()}else{const d=new Date(o+c),g=le(0,s==null?void 0:s.in);return g.setFullYear(d.getUTCFullYear(),d.getUTCMonth(),d.getUTCDate()),g.setHours(d.getUTCHours(),d.getUTCMinutes(),d.getUTCSeconds(),d.getUTCMilliseconds()),g}return le(o+c+u,s==null?void 0:s.in)}const Z={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Ns=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,vs=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,ks=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Cs(n){const s={},t=n.split(Z.dateTimeDelimiter);let a;if(t.length>2)return s;if(/:/.test(t[0])?a=t[0]:(s.date=t[0],a=t[1],Z.timeZoneDelimiter.test(s.date)&&(s.date=n.split(Z.timeZoneDelimiter)[0],a=n.substr(s.date.length,n.length))),a){const r=Z.timezone.exec(a);r?(s.time=a.replace(r[1],""),s.timezone=r[1]):s.time=a}return s}function _s(n,s){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+s)+"})|(\\d{2}|[+-]\\d{"+(2+s)+"})$)"),a=n.match(t);if(!a)return{year:NaN,restDateString:""};const r=a[1]?parseInt(a[1]):null,l=a[2]?parseInt(a[2]):null;return{year:l===null?r:l*100,restDateString:n.slice((a[1]||a[2]).length)}}function Ss(n,s){if(s===null)return new Date(NaN);const t=n.match(Ns);if(!t)return new Date(NaN);const a=!!t[4],r=U(t[1]),l=U(t[2])-1,o=U(t[3]),c=U(t[4]),u=U(t[5])-1;if(a)return Ts(s,c,u)?Is(s,c,u):new Date(NaN);{const d=new Date(0);return!$s(s,l,o)||!Ds(s,r)?new Date(NaN):(d.setUTCFullYear(s,l,Math.max(r,o)),d)}}function U(n){return n?parseInt(n):1}function Ls(n){const s=n.match(vs);if(!s)return NaN;const t=Q(s[1]),a=Q(s[2]),r=Q(s[3]);return Fs(t,a,r)?t*me+a*W+r*1e3:NaN}function Q(n){return n&&parseFloat(n.replace(",","."))||0}function Ms(n){if(n==="Z")return 0;const s=n.match(ks);if(!s)return 0;const t=s[1]==="+"?-1:1,a=parseInt(s[2]),r=s[3]&&parseInt(s[3])||0;return Os(a,r)?t*(a*me+r*W):NaN}function Is(n,s,t){const a=new Date(0);a.setUTCFullYear(n,0,4);const r=a.getUTCDay()||7,l=(s-1)*7+t+1-r;return a.setUTCDate(a.getUTCDate()+l),a}const Ps=[31,null,31,30,31,30,31,31,30,31,30,31];function Ne(n){return n%400===0||n%4===0&&n%100!==0}function $s(n,s,t){return s>=0&&s<=11&&t>=1&&t<=(Ps[s]||(Ne(n)?29:28))}function Ds(n,s){return s>=1&&s<=(Ne(n)?366:365)}function Ts(n,s,t){return s>=1&&s<=53&&t>=0&&t<=6}function Fs(n,s,t){return n===24?s===0&&t===0:t>=0&&t<60&&s>=0&&s<60&&n>=0&&n<25}function Os(n,s){return s>=0&&s<=59}function As({otherProfile:n,className:s=""}){const{t}=C("profile"),{user:a}=P(),{matchScore:r}=X(),[l,o]=k.useState(null);if(k.useEffect(()=>{a!=null&&a.id&&(n!=null&&n.id)&&r({profileAId:a.id,profileBId:n.id}).then(u=>{o(u)}).catch(u=>{console.error("matchScore error",u)})},[a==null?void 0:a.id,n==null?void 0:n.id]),l===null)return e.jsx(os,{color:"amber"});const c=Math.round(l*100);return e.jsxs("div",{className:`w-full md:w-auto flex items-center justify-center gap-1 cursor-help whitespace-nowrap select-none ${s}`,title:t("matchScore.title"),children:[e.jsx(qe,{className:"text-amber-700 text-xl"}),e.jsxs("span",{className:`inline-block w-full text-center px-3 py-1.5 rounded-full text-sm font-semibold whitespace-nowrap ${c>=70?"bg-amber-800 text-white":c>=40?"bg-sky-700 text-white":c>=10?"bg-gray-300 text-gray-900":"bg-gray-800 text-gray-100"}`,children:["Match: ",c,"%"]})]})}function Rs(n){if(!n)return null;const s=ws(n),t=Ie.language.startsWith("es")?xs:xe;return ys(s,{locale:t,addSuffix:!0})}function Us({isOwnProfile:n,profileData:s}){const{t}=C("profile"),{user:a}=P(),r=fe(),{data:l}=Pe(s.id),{totalUnreadMessages:o}=$e(),{data:c,isLoading:u}=o(a==null?void 0:a.id),{findConversation:d,createConversation:g}=De(),{addParticipant:h}=Te(),{userNotifications:y,notificationsRealtime:f}=ge();f(a.id);const{data:w,isLoading:j}=y(a.id),{connectionBetweenProfiles:b,addConnection:$,updateConnection:D,deleteConnection:F}=he(),{data:i,isLoading:x}=b(a==null?void 0:a.id,s.id),{canSend:N}=is(s.id),[M,_]=k.useState(!1),[I,S]=k.useState(!1),[O,z]=k.useState(null),A=(w==null?void 0:w.filter(p=>!p.is_read).length)||0,Y=!!(l!=null&&l.show_last_seen&&s.last_seen),G=()=>{M||ls({myProfileId:a.id,otherProfile:s,findConversation:d,createConversation:g,addParticipant:h,navigate:r,setLoading:_})},R=async()=>{await $({follower_profile_id:a.id,following_profile_id:s.id,status:"pending"})},m=async()=>{i&&await F(i)},q=async()=>{i?await D({connection:i,updatedConnection:{status:"blocked"}}):await $({follower_profile_id:a.id,following_profile_id:s.id,status:"blocked"})},ee=async()=>{i&&await D({connection:i,updatedConnection:{status:"accepted"}})};k.useEffect(()=>{if(!I)return;const p=T=>{T.target.closest(".profile-connection-menu")||S(!1)};return document.addEventListener("mousedown",p),()=>document.removeEventListener("mousedown",p)},[I]);const ve=p=>{const T="text-white text-lg mr-1 drop-shadow-[0_0_2px_rgba(255,255,255,0.5)]",_e="text-gray-300 text-lg mr-1 drop-shadow-[0_0_2px_rgba(255,255,255,0.2)]";return p==="accepted"?e.jsx(ss,{className:T}):p==="pending"?e.jsx(ts,{className:T}):p==="blocked"&&i.follower_profile_id===a.id?e.jsx(de,{className:T}):p==="blocked"&&i.follower_profile_id===s.id?e.jsx(de,{className:_e}):e.jsx(ns,{className:T})},ke=(i==null?void 0:i.status)==="accepted",Ce=(i==null?void 0:i.status)==="pending",se=(i==null?void 0:i.status)==="blocked"&&i.follower_profile_id===a.id,te=(i==null?void 0:i.status)==="blocked"&&i.follower_profile_id===s.id;return e.jsxs("div",{className:"bg-gradient-to-l md:min-w-2xl lg:min-w-4xl from-gray-900 to-gray-950 mb-4 p-4 rounded-b-lg",children:[e.jsxs("div",{className:"flex flex-col gap-6 sm:flex-row sm:items-center",children:[e.jsxs("div",{className:"flex items-center gap-4 flex-grow",children:[e.jsx(pe,{to:`/profile/${s.id}`,children:e.jsx(Fe,{avatar_url:s.avatar_url,className:"flex-shrink-0 !w-24 !h-24",gender:s.gender})}),e.jsxs("div",{className:"flex flex-col gap-2 flex-grow",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-gray-100 break-words",children:s.username}),e.jsx("p",{className:"text-gray-400 break-words",children:s.bio})]})]}),e.jsxs("div",{className:"flex gap-4 ml-auto sm:mb-auto items-center relative",children:[!n&&e.jsxs(e.Fragment,{children:[N&&e.jsx(as,{className:"w-8 h-8 text-white cursor-pointer",onClick:G,disabled:M,title:t("profile.titles.startChat")}),e.jsxs("div",{className:"relative",children:[e.jsx("button",{className:"text-white hover:text-sky-400 p-2 rounded-full focus:outline-none",onClick:()=>S(p=>!p),"aria-label":"Connection options",children:e.jsx(Je,{size:24})}),I&&e.jsxs("div",{className:"absolute right-0 top-10 z-20 bg-gray-900 border border-sky-700 rounded shadow-lg py-1 w-44 flex flex-col min-w-[150px] profile-connection-menu",children:[x?e.jsx("span",{className:"px-4 py-2 text-gray-400 text-xs flex items-center gap-2",children:t("connection.loading")}):se?e.jsxs("button",{onClick:()=>{ee(),S(p=>!p)},className:"px-4 py-2 text-left hover:bg-gray-800 text-sm text-yellow-600 flex items-center gap-2",children:[e.jsx(J,{}),t("connection.unblock")]}):te?e.jsxs("span",{className:"px-4 py-2 text-red-400 text-xs flex items-center gap-2",children:[e.jsx(ce,{}),t("connection.blockedByOther")]}):ke?e.jsxs("button",{onClick:()=>{m(),S(p=>!p)},className:"px-4 py-2 text-left hover:bg-gray-800 text-sm text-gray-300 flex items-center gap-2",children:[e.jsx(J,{}),t("connection.disconnect")]}):Ce?e.jsxs("button",{onClick:()=>{m(),S(p=>!p)},className:"px-4 py-2 text-left hover:bg-gray-800 text-sm text-yellow-400 flex items-center gap-2 group",onMouseEnter:()=>z("disconnect"),onMouseLeave:()=>z(null),children:[O==="disconnect"?e.jsx(J,{}):e.jsx(Qe,{}),t(O==="disconnect"?"connection.disconnect":"connection.pending")]}):e.jsxs("button",{onClick:()=>{R(),S(p=>!p)},className:"px-4 py-2 text-left hover:bg-gray-800 text-sm text-green-600 flex items-center gap-2",children:[e.jsx(Ke,{}),t("connection.connect")]}),!te&&!se&&e.jsxs("button",{onClick:()=>{q(),S(p=>!p)},className:"px-4 py-2 text-left hover:bg-gray-800 text-sm text-red-400 border-t border-sky-800 flex items-center gap-2",children:[e.jsx(ce,{}),t("connection.block")]})]})]})]}),n&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"relative",children:[e.jsx(Xe,{className:"w-8 h-8 text-white cursor-pointer",onClick:()=>r("/chat"),title:t("profile.titles.chat")}),!u&&(c==null?void 0:c.total)>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full px-1.5",children:c.total})]}),e.jsx(Ve,{className:"w-8 h-8 text-white cursor-pointer",onClick:()=>{r("/settings")},title:t("profile.titles.settings")}),e.jsxs("div",{className:"relative",children:[e.jsx(es,{className:"w-7 h-7 text-white cursor-pointer",onClick:()=>r(`/profile/${s.id}/notifications`),title:t("profile.titles.notifications")}),!j&&A>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full px-1.5",children:A})]})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-center sm:justify-end mt-6",children:[!n&&e.jsxs("div",{className:"w-full mx-auto md:mx-0 md:!mr-auto mb-3 flex flex-col items-start gap-6 mt-3",children:[e.jsxs("div",{className:"flex flex-col items-stretch w-full md:flex-row gap-3 md:gap-6",children:[!x&&e.jsxs("button",{title:i?i.status==="accepted"?t("connection.disconnect"):i.status==="pending"?t("connection.cancelRequest"):i.status==="blocked"?i.follower_profile_id===a.id?t("connection.unblock"):t("connection.blockedByOther"):"":t("connection.connect"),onClick:()=>{if(!i)return R();if(i.status==="pending"||i.status==="accepted")return m();if(i.status==="blocked"&&i.follower_profile_id===a.id)return ee()},className:`w-full sm:w-auto inline-flex items-center justify-center gap-1 px-3.5 py-1.5 rounded-full text-sm font-semibold whitespace-nowrap transition
                    ${i?i.status==="accepted"?"bg-emerald-700 text-white hover:bg-emerald-800":i.status==="pending"?"bg-yellow-600 text-white hover:bg-yellow-700":i.status==="blocked"&&i.follower_profile_id===a.id?"bg-red-700 text-white hover:bg-red-800":i.status==="blocked"&&i.follower_profile_id===s.id?"bg-gray-600 text-gray-200 cursor-not-allowed":"bg-gray-700 text-white":"bg-sky-700 text-white hover:bg-sky-800"}
                    ${(i==null?void 0:i.status)==="blocked"&&i.follower_profile_id===s.id?"pointer-events-none":"cursor-pointer"}
                  `,disabled:(i==null?void 0:i.status)==="blocked"&&i.follower_profile_id===s.id,children:[ve(i==null?void 0:i.status),i?i.status==="accepted"?t("connection.accepted"):i.status==="pending"?t("connection.pending"):i.status==="blocked"&&i.follower_profile_id===a.id?t("connection.blocked"):i.status==="blocked"&&i.follower_profile_id===s.id?t("connection.blockedByOther"):"":t("connection.connect")]}),e.jsx("div",{children:e.jsx(As,{otherProfile:s})})]}),Y&&e.jsx("p",{className:"text-xs mx-auto sm:mx-0 sm:mr-auto text-gray-400",children:t("profile.lastSeen",{time:Rs(s.last_seen)})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-4",children:e.jsx(B,{onClick:()=>r(`/profile/${s.id}`),children:t("profile.navigation.about")})}),e.jsx("div",{className:"sm:mb-4",children:e.jsx(B,{onClick:()=>r(`/profile/${s.id}/ads`),children:t("profile.navigation.ads")})})]}),e.jsxs("div",{children:[e.jsx("div",{className:"mb-4",children:e.jsx(B,{onClick:()=>r(`/profile/${s.id}/posts`),children:t("profile.navigation.posts")})}),e.jsx("div",{className:"sm:mb-4",children:e.jsx(B,{starBorder:!0,onClick:()=>r(`/profile/${s.id}/groups`),className:"!bg-amber-800 hover:!bg-amber-900",children:t("profile.navigation.groups")})})]})]})]})}function Bs({profileData:n}){const{t:s}=C("profile"),{privacyOthers:t}=Oe(),{data:a={}}=t(n.id);function r(l){const o=new Date(l),c=new Date;let u=c.getFullYear()-o.getFullYear();const d=c.getMonth()-o.getMonth();return(d<0||d===0&&c.getDate()<o.getDate())&&u--,u}return e.jsx("div",{className:"flex flex-col items-center",children:e.jsxs("ul",{className:"grid grid-cols-1 sm:grid-cols-2 gap-x-12 gap-y-4 text-lg text-gray-300",children:[n.firstname&&e.jsxs("li",{className:"flex items-center",children:[e.jsxs("span",{className:"font-semibold w-28 text-gray-500",children:[s("profile.data.firstname"),":"]}),e.jsx("span",{children:n.firstname})]}),n.lastname&&e.jsxs("li",{className:"flex items-center",children:[e.jsxs("span",{className:"font-semibold w-28 text-gray-500",children:[s("profile.data.lastname"),":"]}),e.jsx("span",{children:n.lastname})]}),n.country&&e.jsxs("li",{className:"flex items-center",children:[e.jsxs("span",{className:"font-semibold w-28 text-gray-500",children:[s("profile.data.country"),":"]}),e.jsx("span",{children:n.country})]}),n.state&&e.jsxs("li",{className:"flex items-center",children:[e.jsxs("span",{className:"font-semibold w-28 text-gray-500",children:[s("profile.data.state"),":"]}),e.jsx("span",{children:n.state})]}),n.neighborhood&&e.jsxs("li",{className:"flex items-center",children:[e.jsxs("span",{className:"font-semibold w-28 text-gray-500",children:[s("profile.data.neighborhood"),":"]}),e.jsx("span",{children:n.neighborhood})]}),n.gender&&e.jsxs("li",{className:"flex items-center",children:[e.jsxs("span",{className:"font-semibold w-28 text-gray-500",children:[s("profile.data.gender"),":"]}),e.jsx("span",{children:s(`edit.placeholders.genderOptions.${n.gender.toLowerCase()}`)})]}),n.birthdate&&e.jsxs("li",{className:"flex items-center",children:[e.jsxs("span",{className:"font-semibold w-28 text-gray-500",children:[s("profile.data.age"),":"]}),e.jsxs("span",{children:[r(n.birthdate)," ",s("profile.data.years")]})]}),a.show_email&&n.email&&e.jsxs("li",{className:"flex items-center",children:[e.jsxs("span",{className:"font-semibold w-28 text-gray-500",children:[s("profile.data.email"),":"]}),e.jsx("span",{children:n.email})]})]})})}const Es=({role:n,data:s})=>{const{t}=C("music");return!s||s.length===0?e.jsx("p",{className:"text-gray-400 mt-4 italic text-center",children:t("roles.noData")}):e.jsxs("div",{className:"mt-6",children:[e.jsx("h4",{className:"text-xl font-bold mb-4 text-sky-200 text-center",children:t("roles.detailsTitle",{role:t(`roles.${n.role.toLowerCase()}`)})}),e.jsx("ul",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:s.map(a=>e.jsxs("li",{className:"bg-gray-800 border border-gray-700 rounded-xl p-4 shadow-sm",children:[n.role==="Instrumentalist"&&e.jsxs(e.Fragment,{children:[e.jsx(v,{label:t("fields.instrument"),value:a.instrument}),e.jsx(v,{label:t("fields.yearsOfExperience"),value:a.years_of_experience}),e.jsx(v,{label:t("fields.level"),value:t(`levels.${a.level.toLowerCase()}`)})]}),n.role==="Singer"&&e.jsxs(e.Fragment,{children:[e.jsx(v,{label:t("fields.voiceType"),value:a.voice_type}),e.jsx(v,{label:t("fields.musicGenre"),value:a.music_genre}),e.jsx(v,{label:t("fields.level"),value:t(`levels.${a.level.toLowerCase()}`)})]}),n.role==="DJ"&&e.jsxs(e.Fragment,{children:[e.jsx(v,{label:t("fields.eventsPlayed"),value:a.events_played}),e.jsx(v,{label:t("fields.preferredGenres"),value:a.preferred_genres}),e.jsx(v,{label:t("fields.level"),value:t(`levels.${a.level.toLowerCase()}`)})]}),n.role==="Producer"&&e.jsxs(e.Fragment,{children:[e.jsx(v,{label:t("fields.productionType"),value:a.production_type}),e.jsx(v,{label:t("fields.yearsOfExperience"),value:a.years_of_experience}),e.jsx(v,{label:t("fields.level"),value:t(`levels.${a.level.toLowerCase()}`)})]}),n.role==="Composer"&&e.jsxs(e.Fragment,{children:[e.jsx(v,{label:t("fields.compositionStyle"),value:a.composition_style}),e.jsx(v,{label:t("fields.yearsOfExperience"),value:a.years_of_experience}),e.jsx(v,{label:t("fields.level"),value:t(`levels.${a.level.toLowerCase()}`)})]})]},a.id))})]})},v=({label:n,value:s})=>e.jsxs("p",{className:"text-sm text-gray-300 mb-1",children:[e.jsxs("span",{className:"font-semibold text-gray-200",children:[n,": "]}),"  ",s||"N/A"]});function zs({role:n,expandedRole:s,handleRoleClick:t}){const{t:a}=C("music"),r=s===n.id;return e.jsxs("div",{className:`p-5 rounded-xl shadow-md border transition-all duration-300 cursor-pointer text-white text-center select-none
        ${r?"border-sky-500 bg-sky-800/30":"border-gray-700 bg-gray-800 hover:border-sky-500 hover:bg-gray-700/60"}
      `,onClick:()=>t(n),children:[e.jsx("span",{className:"text-lg font-semibold tracking-wide",children:a(`roles.${n.role.toLowerCase()}`)}),e.jsx("div",{className:"mt-2 flex justify-center",children:e.jsx(ye,{className:`text-gray-400 transition-transform duration-200 ${r?"rotate-180":""}`})})]})}function Ys(){const n="#a1a1aa",s="#e4e4e7";return e.jsxs("div",{className:"flex flex-col gap-6",children:[e.jsx(E,{height:50,className:"rounded-lg",baseColor:n,highlightColor:s}),e.jsx(E,{height:300,className:"rounded-lg",baseColor:n,highlightColor:s})]})}const Gs=({profileId:n})=>{const{user:s}=P(),{t}=C("music"),{userMediaLinks:a}=Ae(),{data:r=[],isLoading:l}=a(n),o=fe(),c=s.id===n;if(l)return e.jsx(Ys,{});const u=g=>{const h=g.match(/spotify\.com\/(track|playlist|album)\/([a-zA-Z0-9]+)/);if(!h)return null;const[y,f,w]=h;return`https://open.spotify.com/embed/${f}/${w}`},d=r.slice(0,2);return e.jsxs("section",{className:"mb-10",children:[c&&e.jsx(V,{label:t("media.actions.add"),to:"/media/create"}),e.jsx("ul",{className:"space-y-4 text-center",children:d.map(g=>e.jsxs("li",{className:"shadow-sm p-4 rounded-lg bg-gradient-to-l to-gray-800",children:[e.jsx("p",{className:"font-medium mb-2 text-center",children:g.title}),g.media_type==="spotify"?e.jsx("iframe",{src:u(g.url),width:"100%",height:"80",allow:"autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture",loading:"lazy",className:"rounded w-full max-w-full"}):e.jsx("div",{className:"aspect-video bg-black rounded overflow-hidden",children:e.jsx(fs,{url:g.url,controls:!0,width:"100%",height:"100%",style:{maxWidth:"100%"}})})]},g.id))}),r.length>2&&e.jsx("div",{className:"flex justify-center mt-6",children:e.jsx(B,{onClick:()=>o(`/media/${n}`),className:"!text-emerald-600 !text-2xl hover:!text-emerald-700 !bg-transparent",children:t("media.actions.seeMore")})})]})},Zs=()=>e.jsxs("div",{className:"bg-gray-800 p-5 rounded-xl shadow-md flex flex-col gap-4 items-center",children:[e.jsx(E,{height:24,width:120,baseColor:"#a1a1aa",highlightColor:"#e4e4e7"}),e.jsx(ye,{className:"text-gray-400 mt-2"})]}),Ws=()=>{const n="#a1a1aa",s="#e4e4e7";return e.jsxs("div",{className:"mt-6",children:[e.jsx("div",{className:"text-center mb-4",children:e.jsx(E,{width:220,height:28,baseColor:n,highlightColor:s})}),e.jsx("ul",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[...Array(2)].map((t,a)=>e.jsx("li",{className:"bg-gray-800 border border-gray-700 rounded-xl p-4 shadow-sm",children:[...Array(3)].map((r,l)=>e.jsx("div",{className:"mb-2",children:e.jsx(E,{height:14,baseColor:n,highlightColor:s,width:`${80+Math.random()*20}%`})},l))},a))})]})},Hs=({profileId:n})=>{var A,Y,G,R;const{t:s}=C("music"),{user:t}=P(),[a,r]=k.useState(),{fetchRoles:l}=Re(),{data:o,isLoading:c,error:u}=l(n),{fetchInstruments:d}=Ue(),{data:g,isLoading:h}=d(a),{fetchSinger:y}=Be(),{data:f,isLoading:w}=y(a),{fetchComposer:j}=Ee(),{data:b,isLoading:$}=j(a),{fetchProducer:D}=ze(),{data:F,isLoading:i}=D(a),{fetchDj:x}=Ye(),{data:N,isLoading:M}=x(a),[_,I]=k.useState(null),S=t.id===n,O=c||h||w||$||i||M,z=m=>{_===m.id?I(null):(I(m.id),(m.role==="Instrumentalist"||m.role==="Singer"||m.role==="DJ"||m.role==="Producer"||m.role==="Composer")&&r(m.id))};return u?e.jsx(H,{error:u.message||s("errors.fetch")}):e.jsxs("div",{className:"bg-gray-900 p-6 rounded-lg shadow-md w-full",children:[e.jsx("div",{className:"flex items-center justify-center font-semibold gap-3 mb-6",children:e.jsx(we,{text:s("roles.title"),speed:3,className:"text-3xl tracking-wide"})}),e.jsx(Gs,{profileId:n}),S&&e.jsx(V,{label:s("roles.addRole"),to:"/settings/music"}),(o==null?void 0:o.length)===0?e.jsx("p",{className:"text-gray-400 text-center",children:s("roles.none")}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:O&&!(o!=null&&o.length)?[...Array(3)].map((m,q)=>e.jsx(Zs,{},q)):o==null?void 0:o.map(m=>e.jsx(zs,{role:m,expandedRole:_,handleRoleClick:z},m.id))}),_&&e.jsxs("div",{className:"mt-6",children:[O?e.jsx(Ws,{}):e.jsx(Es,{role:o.find(m=>m.id===_),data:((A=o.find(m=>m.id===_))==null?void 0:A.role)==="Instrumentalist"?g:((Y=o.find(m=>m.id===_))==null?void 0:Y.role)==="Singer"?f:((G=o.find(m=>m.id===_))==null?void 0:G.role)==="DJ"?N:((R=o.find(m=>m.id===_))==null?void 0:R.role)==="Producer"?F:b}),e.jsxs("div",{className:"flex justify-center mt-4 cursor-pointer",onClick:()=>I(null),children:[e.jsx(rs,{className:"text-gray-500"})," "]})]})]})]})};function K({checkStatus:n,profileId:s,maxVisible:t}){const{user:a}=P(),{t:r}=C("ui",{keyPrefix:"connections"}),{userConnections:l}=he(),{data:o}=l(s),c=s===a.id;if(!["accepted","pending","blocked"].includes(n)||!o)return null;const u=o.filter(f=>n==="accepted"?f.status==="accepted":n==="blocked"?f.status==="blocked":n==="pending"?f.status==="pending"&&f.following_profile_id===s:!1),d=f=>f.following_profile_id===s?f.follower_profile_id:f.following_profile_id,g=n==="accepted"?r("title"):null,h=n==="accepted",y=t?u.slice(0,t):u;return e.jsxs("div",{className:"max-w-4xl mx-auto w-full bg-gradient-to-l from-gray-900 py-4 flex flex-wrap justify-center rounded-lg gap-4",children:[e.jsx("div",{className:"w-full flex items-center justify-between px-4 mb-2",children:e.jsxs("h2",{className:"text-xl font-bold text-white",children:[g,h&&e.jsxs("span",{className:"ml-2 text-sky-400 text-lg font-semibold",children:["(",u.length,")"]})]})}),y.length>0?y.map(f=>e.jsx(ms,{connection:f,profileId:d(f),ownProfile:c},f.id)):e.jsx("div",{className:"text-gray-400",children:r(n==="pending"?"noPendingConnections":"noConnections")}),t&&u.length>t&&e.jsx(pe,{to:`/profile/${s}/connections`,className:"w-full text-center text-sky-400 hover:underline mt-2 block",children:r("viewAll")})]})}function qs({profileId:n}){const{t:s}=C("ads"),{user:t}=P(),{fetchInfiniteByUser:a}=Ge(),{data:r,fetchNextPage:l,hasNextPage:o,isFetchingNextPage:c,isLoading:u,error:d}=a(n),g=n===t.id;if(u)return e.jsx(ps,{isProfileView:!0});if(d)return e.jsx(H,{error:d.message});const h=r?r.pages.flat():[];return e.jsxs("div",{className:"mx-auto text-center w-full",children:[e.jsx("h2",{className:"text-center font-semibold mb-4",children:e.jsx(we,{text:s("profileAds.title"),speed:3,className:"text-3xl tracking-wide"})}),g&&e.jsx(V,{label:s("adsPage.buttons.createAd"),to:"/ads/new",showLabelOnMobile:!0}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:h.length>0?h.map(y=>e.jsx(js,{ad:y,publisherId:n},y.id)):e.jsx("p",{className:"col-span-full text-center text-gray-400",children:s("profileAds.empty")})}),o&&e.jsx(Button,{className:"!w-1/2 md:!w-1/3 !font-bold mt-4 !mx-auto hover:!text-sky-600",onClick:()=>l(),disabled:c,children:s(c?"profileAds.buttons.loading":"profileAds.buttons.loadMore")})]})}const ue=n=>typeof n=="string"?JSON.parse(n):n||{};function Js({profileId:n}){const{t:s}=C("profile",{keyPrefix:"notifications"}),[t,a]=k.useState(!1),{userNotifications:r,notificationsRealtime:l,updateNotification:o}=ge(),{data:c=[],isLoading:u,error:d}=r(n);l(n);const g=k.useMemo(()=>c.map(x=>x.from_user_id).filter(Boolean).sort(),[c]),h=k.useMemo(()=>c.map(x=>ue(x.payload).group_id).filter(Boolean).sort(),[c]),{profilesMap:y}=X(),{data:f={}}=y(g),w=x=>{var N,M;return((N=f[x])==null?void 0:N.username)||((M=f[x])==null?void 0:M.firstname)||s("someone")},{data:j=[]}=Ze({queryKey:["notifGroups",h],enabled:h.length>0,queryFn:async()=>{const{data:x,error:N}=await We.schema("users").from("profile_groups").select("id, name").in("id",h);if(N)throw new Error(N.message);return x}}),b=k.useMemo(()=>{const x={};return j.forEach(N=>x[N.id]=N.name),x},[j]),$=x=>b[x]||s("aGroup"),D=async x=>{x.is_read||await o({...x,is_read:!0})};if(u)return e.jsx(je,{});if(d)return e.jsx(H,{error:d.message});if(c.length===0)return e.jsx("div",{className:"p-4 max-w-4xl mx-auto",children:s("noNotifications")});const F=x=>{const N=ue(x.payload);switch(x.type){case"group_follow":return s("group_follow",{user:w(N.follower_id),group:$(N.group_id)});default:return s(x.type,{user:w(x.from_user_id)})}},i=t?c:c.slice(0,10);return e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsx("ul",{className:`divide-y divide-gray-700
                   p-4 bg-gradient-to-l to-gray-900 rounded-lg shadow-md`,children:i.map(x=>e.jsxs("li",{onClick:()=>D(x),className:`py-2 cursor-pointer hover:bg-gray-800 transition
                        ${x.is_read?"text-gray-400":"text-white font-semibold"}`,children:["• ",F(x)]},x.id))}),c.length>10&&e.jsx("button",{onClick:()=>a(x=>!x),className:"mt-4 mx-auto block text-sky-400 hover:underline",children:s(t?"seeLess":"seeAll")})]})}function Qs({profileId:n}){const{t:s}=C("profile"),t="cursor-pointer px-4 py-2 text-sm sm:text-base font-semibold rounded-lg transition-all",a=`${t} border-b-2 border-sky-600 text-white shadow-lg`,r=`${t} text-gray-300 hover:text-sky-600`;return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-gradient-to-b from-gray-800 to-gray-950 rounded-t-lg",children:e.jsxs("nav",{className:"flex justify-center space-x-8 py-3",children:[e.jsx(oe,{end:!0,to:`/profile/${n}/notifications`,className:({isActive:l})=>l?a:r,children:s("profile.internNav.notifications")}),e.jsx(oe,{to:`/profile/${n}/notifications/pending`,className:({isActive:l})=>l?a:r,children:s("profile.internNav.pending")})]})}),e.jsxs(be,{children:[e.jsx(L,{index:!0,element:e.jsx(Js,{profileId:n})}),e.jsx(L,{path:"pending",element:e.jsx(K,{profileId:n,checkStatus:"pending"})})]})]})}function ht(){const{t:n}=C("profileGroup",{keyPrefix:"userGroups"}),{identifier:s}=He(),{user:t,loading:a}=P(),{fetchProfile:r}=X(),{data:l,isLoading:o,error:c}=r(s);if(a||o)return e.jsx(je,{});if(c)return e.jsx(H,{error:c.message});if(!l)return null;const d=t.id===s,g=()=>e.jsxs(e.Fragment,{children:[e.jsx(Bs,{profileData:l}),e.jsx(Hs,{profileId:l.id}),e.jsx(K,{profileId:l.id,checkStatus:"accepted",maxVisible:4})]}),h=()=>e.jsx(gs,{profileId:l.id,isOwnProfile:d}),y=()=>e.jsx(hs,{}),f=()=>e.jsx("p",{className:"text-center text-gray-400",children:n("userGroupsComing")}),w=()=>e.jsx(qs,{profileId:l.id});return e.jsx("div",{className:"flex flex-col min-h-screen text-white",children:e.jsxs("div",{className:"max-w-4xl mx-auto p-6 space-y-6",children:[e.jsx(Us,{profileData:l,isOwnProfile:d}),e.jsxs(be,{children:[e.jsx(L,{index:!0,element:e.jsx(g,{})}),e.jsx(L,{path:"posts",element:e.jsx(h,{})}),e.jsx(L,{path:"connections",element:e.jsx(K,{profileId:l.id,checkStatus:"accepted"})}),d&&e.jsx(L,{path:"create",element:e.jsx(y,{})}),e.jsx(L,{path:"groups",element:e.jsx(f,{})}),e.jsx(L,{path:"ads",element:e.jsx(w,{})}),d&&e.jsx(L,{path:"notifications/*",element:e.jsx(Qs,{profileId:l.id})})]})]})})}export{ht as default};
